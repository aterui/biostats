<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Probabilistic View | BIOSTATS</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Probabilistic View | BIOSTATS" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Probabilistic View | BIOSTATS" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Akira Terui" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sampling.html"/>
<link rel="next" href="two-group-comparison.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BIOSTATS</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> url: your book url like https://bookdown.org/yihui/bookdown</a></li>
<li class="chapter" data-level="2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html"><i class="fa fa-check"></i><b>2</b> Descriptive Statistics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#central-tendency"><i class="fa fa-check"></i><b>2.1</b> Central Tendency</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>2.1.1</b> Measures of Central Tendency</a></li>
<li class="chapter" data-level="2.1.2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#r-exercise"><i class="fa fa-check"></i><b>2.1.2</b> R Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#variation"><i class="fa fa-check"></i><b>2.2</b> Variation</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#measures-of-variation"><i class="fa fa-check"></i><b>2.2.1</b> Measures of Variation</a></li>
<li class="chapter" data-level="2.2.2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#r-exercise-1"><i class="fa fa-check"></i><b>2.2.2</b> R Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#laboratory"><i class="fa fa-check"></i><b>2.3</b> Laboratory</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#comparing-central-tendency-measures"><i class="fa fa-check"></i><b>2.3.1</b> Comparing Central Tendency Measures</a></li>
<li class="chapter" data-level="2.3.2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#comparing-variation-measures"><i class="fa fa-check"></i><b>2.3.2</b> Comparing Variation Measures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sampling.html"><a href="sampling.html"><i class="fa fa-check"></i><b>3</b> Sampling</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sampling.html"><a href="sampling.html#the-unknown-garden-plant-example"><i class="fa fa-check"></i><b>3.1</b> The Unknown: Garden Plant Example</a></li>
<li class="chapter" data-level="3.2" data-path="sampling.html"><a href="sampling.html#linking-part-to-the-whole"><i class="fa fa-check"></i><b>3.2</b> Linking Part to the Whole</a></li>
<li class="chapter" data-level="3.3" data-path="sampling.html"><a href="sampling.html#laboratory-1"><i class="fa fa-check"></i><b>3.3</b> Laboratory</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="probabilistic-view.html"><a href="probabilistic-view.html"><i class="fa fa-check"></i><b>4</b> Probabilistic View</a>
<ul>
<li class="chapter" data-level="4.1" data-path="probabilistic-view.html"><a href="probabilistic-view.html#distribution-of-plant-height"><i class="fa fa-check"></i><b>4.1</b> Distribution of Plant Height</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="probabilistic-view.html"><a href="probabilistic-view.html#probability-density-function"><i class="fa fa-check"></i><b>4.1.1</b> Probability Density Function</a></li>
<li class="chapter" data-level="4.1.2" data-path="probabilistic-view.html"><a href="probabilistic-view.html#pdf-to-frequency-distribution"><i class="fa fa-check"></i><b>4.1.2</b> PDF to frequency distribution</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="probabilistic-view.html"><a href="probabilistic-view.html#distribution-of-emails-per-day"><i class="fa fa-check"></i><b>4.2</b> Distribution of emails per day</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="two-group-comparison.html"><a href="two-group-comparison.html"><i class="fa fa-check"></i><b>5</b> Two-Group Comparison</a>
<ul>
<li class="chapter" data-level="5.1" data-path="two-group-comparison.html"><a href="two-group-comparison.html#explore-data-structure"><i class="fa fa-check"></i><b>5.1</b> Explore Data Structure</a></li>
<li class="chapter" data-level="5.2" data-path="two-group-comparison.html"><a href="two-group-comparison.html#statistical-quantity"><i class="fa fa-check"></i><b>5.2</b> Statistical Quantity</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="two-group-comparison.html"><a href="two-group-comparison.html#t-value"><i class="fa fa-check"></i><b>5.2.1</b> t-value</a></li>
<li class="chapter" data-level="5.2.2" data-path="two-group-comparison.html"><a href="two-group-comparison.html#null-hypothesis"><i class="fa fa-check"></i><b>5.2.2</b> Null Hypothesis</a></li>
<li class="chapter" data-level="5.2.3" data-path="two-group-comparison.html"><a href="two-group-comparison.html#interpretation"><i class="fa fa-check"></i><b>5.2.3</b> Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="two-group-comparison.html"><a href="two-group-comparison.html#t-test-in-r"><i class="fa fa-check"></i><b>5.3</b> t-test in R</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="two-group-comparison.html"><a href="two-group-comparison.html#t-test-with-equal-variance"><i class="fa fa-check"></i><b>5.3.1</b> t-test with equal variance</a></li>
<li class="chapter" data-level="5.3.2" data-path="two-group-comparison.html"><a href="two-group-comparison.html#t-test-with-unequal-variance"><i class="fa fa-check"></i><b>5.3.2</b> t-test with unequal variance</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="appendix-project-management.html"><a href="appendix-project-management.html"><i class="fa fa-check"></i><b>6</b> Appendix: Project Management</a>
<ul>
<li class="chapter" data-level="6.1" data-path="appendix-project-management.html"><a href="appendix-project-management.html#r-project"><i class="fa fa-check"></i><b>6.1</b> R Project</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="appendix-project-management.html"><a href="appendix-project-management.html#script-editor"><i class="fa fa-check"></i><b>6.1.1</b> Script Editor</a></li>
<li class="chapter" data-level="6.1.2" data-path="appendix-project-management.html"><a href="appendix-project-management.html#file-name"><i class="fa fa-check"></i><b>6.1.2</b> File Name</a></li>
<li class="chapter" data-level="6.1.3" data-path="appendix-project-management.html"><a href="appendix-project-management.html#structure-your-project"><i class="fa fa-check"></i><b>6.1.3</b> Structure Your Project</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="appendix-project-management.html"><a href="appendix-project-management.html#robust-coding"><i class="fa fa-check"></i><b>6.2</b> Robust coding</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BIOSTATS</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="probabilistic-view" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Probabilistic View<a href="probabilistic-view.html#probabilistic-view" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>While Chapter <a href="sampling.html#sampling">3</a> highlighted the concept of sampling, it introduced another important aspect of statistics – i.e., randomness. While mean provides a central tendency of the data, it does not represent all the data points. Inevitable deviations exist. How do we express such “randomness”? The concept of probability distributions helps fully grasp the stochastic nature of observation data.</p>
<div id="distribution-of-plant-height" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Distribution of Plant Height<a href="probabilistic-view.html#distribution-of-plant-height" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="probability-density-function" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Probability Density Function<a href="probabilistic-view.html#probability-density-function" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let me use the plant height example in Chapter <a href="sampling.html#sampling">3</a>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="probabilistic-view.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load csv data on R</span></span>
<span id="cb1-2"><a href="probabilistic-view.html#cb1-2" aria-hidden="true" tabindex="-1"></a>df_h0 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data_raw/data_plant_height.csv&quot;</span>)</span></code></pre></div>
<p>While our focus was on examining mean and variance in Chapter <a href="sampling.html#sampling">3</a>, let’s expand the focus to grasp the overall distribution of the height:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="probabilistic-view.html#cb2-1" aria-hidden="true" tabindex="-1"></a>df_h0 <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="probabilistic-view.html#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span> </span>
<span id="cb2-3"><a href="probabilistic-view.html#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="co"># specify binwidth</span></span>
<span id="cb2-4"><a href="probabilistic-view.html#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> <span class="fu">mean</span>(height))) <span class="co"># draw vertical line at the mean</span></span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:histogram-height"></span>
<img src="_main_files/figure-html/histogram-height-1.png" alt="Distribution of plant height" width="672" />
<p class="caption">
Figure 4.1: Distribution of plant height
</p>
</div>
<p>This distribution consists of a thousand of height measures. However, there are some rules. Data are centered around the mean and symmetrically distributed. This fact suggests that this distribution could be approximated by a simple formula that requires only a few <em>characteristic numbers</em>.</p>
<p>In statistics, the symmetric bell-shaped form is often approximated by a Normal distribution, and we denote “<em>variable</em> <span class="math inline">\(x\)</span> <em>is assumed to follow a Normal distribution.</em>” We use the following mathematical expression:</p>
<p><span class="math display">\[
x \sim Normal(\mu, \sigma^2)
\]</span></p>
<p>Unlike “equation,” we do not use “<span class="math inline">\(=\)</span>” sign because variable <span class="math inline">\(x\)</span> is not identical to the Normal distribution. Instead, it describes a “stochastic” relationship that denotes the probability of <span class="math inline">\(x\)</span> taking a certain range of values.</p>
<p>A Normal distribution has two parameters – mean and variance. Once these parameters are determined, the formula defining the Normal distribution will provide probability density for a range values. This formula, appearing below as <span class="math inline">\(f(x)\)</span>, is referred to as a <strong>probability density function (PDF)</strong>.</p>
<p><span class="math display">\[
f(x) = \frac{1}{\sqrt{2 \pi} \sigma} \exp\left(-\frac{(x-\mu)^2}{2\sigma^2}\right)
\]</span></p>
</div>
<div id="pdf-to-frequency-distribution" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> PDF to frequency distribution<a href="probabilistic-view.html#pdf-to-frequency-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In R, function <code>dnorm()</code> calculates probability density for a given value. The first argument <code>x</code> is a vector of values that you’d like to calculate its probability density. In the second <code>mean</code> and third arguments <code>sd</code>, you will provide the mean and SD of the distribution. For <span class="math inline">\(x\)</span> (plant height), let’s use <span class="math inline">\(\text{min}(x)\)</span> to <span class="math inline">\(\text{max}(x)\)</span> to cover the full range of observed height:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="probabilistic-view.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vector of x values</span></span>
<span id="cb3-2"><a href="probabilistic-view.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># seq() generate min to max values with specified numbers of elements or interval</span></span>
<span id="cb3-3"><a href="probabilistic-view.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the following produce 100 elements</span></span>
<span id="cb3-4"><a href="probabilistic-view.html#cb3-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(df_h0<span class="sc">$</span>height), <span class="fu">max</span>(df_h0<span class="sc">$</span>height), <span class="at">length =</span> <span class="dv">100</span>)</span>
<span id="cb3-5"><a href="probabilistic-view.html#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="probabilistic-view.html#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate probability density</span></span>
<span id="cb3-7"><a href="probabilistic-view.html#cb3-7" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">mean</span>(df_h0<span class="sc">$</span>height)</span>
<span id="cb3-8"><a href="probabilistic-view.html#cb3-8" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">sd</span>(df_h0<span class="sc">$</span>height)</span>
<span id="cb3-9"><a href="probabilistic-view.html#cb3-9" aria-hidden="true" tabindex="-1"></a>pd <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)</span>
<span id="cb3-10"><a href="probabilistic-view.html#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="probabilistic-view.html#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># figure</span></span>
<span id="cb3-12"><a href="probabilistic-view.html#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">y =</span> pd, <span class="at">x =</span> x) <span class="sc">%&gt;%</span> <span class="co"># data frame</span></span>
<span id="cb3-13"><a href="probabilistic-view.html#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb3-14"><a href="probabilistic-view.html#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="co"># draw lines</span></span>
<span id="cb3-15"><a href="probabilistic-view.html#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Probability density&quot;</span>) <span class="co"># re-label</span></span></code></pre></div>
<p><img src="_main_files/figure-html/dnorm-1.png" width="672" /></p>
<p>That looks pretty similar to what we observed, but the scale of y-axis is quite different. Since this figure shows a “probability density,” we need to calculate the area under the curve to make it probability. R provides <code>pnorm()</code> function for this purpose. It calculates the probability less than the value provided in the first argument <code>q</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="probabilistic-view.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># probability of x &lt; 10</span></span>
<span id="cb4-2"><a href="probabilistic-view.html#cb4-2" aria-hidden="true" tabindex="-1"></a>p10 <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)</span>
<span id="cb4-3"><a href="probabilistic-view.html#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p10)</span></code></pre></div>
<pre><code>## [1] 0.02731905</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="probabilistic-view.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># probability of x &lt; 20</span></span>
<span id="cb6-2"><a href="probabilistic-view.html#cb6-2" aria-hidden="true" tabindex="-1"></a>p20 <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="dv">20</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)</span>
<span id="cb6-3"><a href="probabilistic-view.html#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p20)</span></code></pre></div>
<pre><code>## [1] 0.504426</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="probabilistic-view.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># probability of 10 &lt; x &lt; 20</span></span>
<span id="cb8-2"><a href="probabilistic-view.html#cb8-2" aria-hidden="true" tabindex="-1"></a>p20_10 <span class="ot">&lt;-</span> p20 <span class="sc">-</span> p10</span>
<span id="cb8-3"><a href="probabilistic-view.html#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p20_10)</span></code></pre></div>
<pre><code>## [1] 0.4771069</code></pre>
<p>To make estimates comparable to the frequency data, calculate the probability for each 1 cm bin. Expected frequency can be calculated as a product of probability and sample size (1000):</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="probabilistic-view.html#cb10-1" aria-hidden="true" tabindex="-1"></a>x_min <span class="ot">&lt;-</span> <span class="fu">floor</span>(<span class="fu">min</span>(df_h0<span class="sc">$</span>height)) <span class="co"># floor takes the integer part of the value</span></span>
<span id="cb10-2"><a href="probabilistic-view.html#cb10-2" aria-hidden="true" tabindex="-1"></a>x_max <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(<span class="fu">max</span>(df_h0<span class="sc">$</span>height)) <span class="co"># ceiling takes the next closest integer</span></span>
<span id="cb10-3"><a href="probabilistic-view.html#cb10-3" aria-hidden="true" tabindex="-1"></a>bin <span class="ot">&lt;-</span> <span class="fu">seq</span>(x_min, x_max, <span class="at">by =</span> <span class="dv">1</span>) <span class="co"># each bin has 1cm</span></span>
<span id="cb10-4"><a href="probabilistic-view.html#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="probabilistic-view.html#cb10-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># empty object for probability</span></span>
<span id="cb10-6"><a href="probabilistic-view.html#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(bin) <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb10-7"><a href="probabilistic-view.html#cb10-7" aria-hidden="true" tabindex="-1"></a>  p[i] <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(bin[i<span class="sc">+</span><span class="dv">1</span>], <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma) <span class="sc">-</span> <span class="fu">pnorm</span>(bin[i], <span class="at">mean =</span> mu, <span class="at">sd =</span> sigma)</span>
<span id="cb10-8"><a href="probabilistic-view.html#cb10-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-9"><a href="probabilistic-view.html#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="probabilistic-view.html#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="do">## data frame for probability</span></span>
<span id="cb10-11"><a href="probabilistic-view.html#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="do">## bin: last element [-length(bin)] was removed to match length</span></span>
<span id="cb10-12"><a href="probabilistic-view.html#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="do">## expected frequency in each bin is &quot;prob times sample size&quot;</span></span>
<span id="cb10-13"><a href="probabilistic-view.html#cb10-13" aria-hidden="true" tabindex="-1"></a>df_prob <span class="ot">&lt;-</span> <span class="fu">tibble</span>(p, <span class="at">bin =</span> bin[<span class="sc">-</span><span class="fu">length</span>(bin)]) <span class="sc">%&gt;%</span> </span>
<span id="cb10-14"><a href="probabilistic-view.html#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">freq =</span> p <span class="sc">*</span> <span class="fu">nrow</span>(df_h0))</span></code></pre></div>
<p>Let me overlay:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="probabilistic-view.html#cb11-1" aria-hidden="true" tabindex="-1"></a>df_h0 <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="probabilistic-view.html#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> height)) <span class="sc">+</span> </span>
<span id="cb11-3"><a href="probabilistic-view.html#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb11-4"><a href="probabilistic-view.html#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df_prob,</span>
<span id="cb11-5"><a href="probabilistic-view.html#cb11-5" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">y =</span> freq,</span>
<span id="cb11-6"><a href="probabilistic-view.html#cb11-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">x =</span> bin),</span>
<span id="cb11-7"><a href="probabilistic-view.html#cb11-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;salmon&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-8"><a href="probabilistic-view.html#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df_prob,</span>
<span id="cb11-9"><a href="probabilistic-view.html#cb11-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> freq,</span>
<span id="cb11-10"><a href="probabilistic-view.html#cb11-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">x =</span> bin),</span>
<span id="cb11-11"><a href="probabilistic-view.html#cb11-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;salmon&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/histogram-overlaid-1.png" width="672" /></p>
<p>While the original data set had 1000 data points, the probability distribution could reproduce the overall shape with just two parameters (mean and variance)! This is a good news – once we know the key parameters, we can infer the overall pattern of the data.</p>
</div>
</div>
<div id="distribution-of-emails-per-day" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Distribution of emails per day<a href="probabilistic-view.html#distribution-of-emails-per-day" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sampling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="two-group-comparison.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/chapters/03-probability.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
