<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 22 Piecewise SEM | BIOSTATS</title>
<meta name="author" content="Akira Terui">
<meta name="description" content="Path analysis and Structural Equation Modeling (SEM) provide a powerful framework for addressing mediating interactions among more than two variables. Traditional SEM is implemented using...">
<meta name="generator" content="bookdown 0.43 with bs4_book()">
<meta property="og:title" content="Chapter 22 Piecewise SEM | BIOSTATS">
<meta property="og:type" content="book">
<meta property="og:description" content="Path analysis and Structural Equation Modeling (SEM) provide a powerful framework for addressing mediating interactions among more than two variables. Traditional SEM is implemented using...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 22 Piecewise SEM | BIOSTATS">
<meta name="twitter:description" content="Path analysis and Structural Equation Modeling (SEM) provide a powerful framework for addressing mediating interactions among more than two variables. Traditional SEM is implemented using...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.9.0/transition.js"></script><script src="libs/bs3compat-0.9.0/tabs.js"></script><script src="libs/bs3compat-0.9.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.11/grViz.js"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-QZSNHVQQNV"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-QZSNHVQQNV');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">BIOSTATS</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Introduction</a></li>
<li class="book-part">Getting Started</li>
<li><a class="" href="what-is-r-and-r-studio.html"><span class="header-section-number">1</span> What is R and R studio?</a></li>
<li><a class="" href="installing-r-and-rstudio.html"><span class="header-section-number">2</span> Installing R and RStudio</a></li>
<li><a class="" href="r-project.html"><span class="header-section-number">3</span> R Project</a></li>
<li class="book-part">R Basics</li>
<li><a class="" href="data-structure.html"><span class="header-section-number">4</span> Data Structure</a></li>
<li><a class="" href="data-manipulation.html"><span class="header-section-number">5</span> Data Manipulation</a></li>
<li><a class="" href="visualization.html"><span class="header-section-number">6</span> Visualization</a></li>
<li class="book-part">Basic Statistics</li>
<li><a class="" href="descriptive-statistics.html"><span class="header-section-number">7</span> Descriptive Statistics</a></li>
<li><a class="" href="sampling.html"><span class="header-section-number">8</span> Sampling</a></li>
<li><a class="" href="probabilistic-view.html"><span class="header-section-number">9</span> Probabilistic View</a></li>
<li><a class="" href="two-group-comparison.html"><span class="header-section-number">10</span> Two-Group Comparison</a></li>
<li><a class="" href="multiple-group-comparison.html"><span class="header-section-number">11</span> Multiple-Group Comparison</a></li>
<li><a class="" href="regression.html"><span class="header-section-number">12</span> Regression</a></li>
<li><a class="" href="linear-model.html"><span class="header-section-number">13</span> Linear Model</a></li>
<li><a class="" href="generalized-linear-model.html"><span class="header-section-number">14</span> Generalized Linear Model</a></li>
<li><a class="" href="likelihood.html"><span class="header-section-number">15</span> Likelihood</a></li>
<li><a class="" href="model-comparison.html"><span class="header-section-number">16</span> Model Comparison</a></li>
<li class="book-part">Applied Statistics</li>
<li><a class="" href="generalized-linear-mixed-effect-model.html"><span class="header-section-number">17</span> Generalized Linear Mixed Effect Model</a></li>
<li><a class="" href="generalized-additive-model.html"><span class="header-section-number">18</span> Generalized Additive Model</a></li>
<li><a class="" href="unconstrained-ordination.html"><span class="header-section-number">19</span> Unconstrained Ordination</a></li>
<li><a class="" href="constrained-ordination.html"><span class="header-section-number">20</span> Constrained Ordination</a></li>
<li><a class="" href="structural-equation-modeling.html"><span class="header-section-number">21</span> Structural Equation Modeling</a></li>
<li><a class="active" href="piecewise-sem.html"><span class="header-section-number">22</span> Piecewise SEM</a></li>
<li><a class="" href="time-series-analysis.html"><span class="header-section-number">23</span> Time-Series Analysis</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="basic-terminology.html">Basic Terminology</a></li>
<li><a class="" href="git-github.html">Git &amp; GitHub</a></li>
<li><a class="" href="base-plot.html">Base Plot</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/aterui/biostats">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="piecewise-sem" class="section level1" number="22">
<h1>
<span class="header-section-number">22</span> Piecewise SEM<a class="anchor" aria-label="anchor" href="#piecewise-sem"><i class="fas fa-link"></i></a>
</h1>
<p>Path analysis and Structural Equation Modeling (SEM) provide a powerful framework for addressing mediating interactions among more than two variables. Traditional SEM is implemented using covariance-based approaches and assumes multivariate normality and large sample sizes. In contrast, <strong>piecewise SEM</strong> extends this framework by fitting individual component models (e.g., linear models, generalized linear models, mixed-effects models) and evaluating the overall network structure using tests of conditional independence. This makes piecewise SEM especially well suited for biological data, which often violate assumptions of normality, independence, or simple experimental design.</p>
<p>In this chapter, we will focus on how piecewise SEM can be used to link biological processes, quantify direct and indirect effects, and evaluate competing hypotheses using real biological data.</p>
<p>Learning Objectives:</p>
<ul>
<li><p>Understand the conceptual differences between traditional and piecewise SEM.</p></li>
<li><p>Specify and fit piecewise SEM models using biological data.</p></li>
<li><p>Interpret model outputs, including path coefficients, residual variances, and overall model fit statistics.</p></li>
</ul>
<div class="sourceCode" id="cb570"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">tidyverse</span>,</span>
<span>               <span class="va">GGally</span>,</span>
<span>               <span class="va">mgcv</span>,</span>
<span>               <span class="va">piecewiseSEM</span><span class="op">)</span></span></code></pre></div>
<div id="non-normal-distributions" class="section level2" number="22.1">
<h2>
<span class="header-section-number">22.1</span> Non-normal Distributions<a class="anchor" aria-label="anchor" href="#non-normal-distributions"><i class="fas fa-link"></i></a>
</h2>
<div id="post-fire-plant-diversity-the-original-model" class="section level3" number="22.1.1">
<h3>
<span class="header-section-number">22.1.1</span> Post-fire plant diversity: the original model<a class="anchor" aria-label="anchor" href="#post-fire-plant-diversity-the-original-model"><i class="fas fa-link"></i></a>
</h3>
<p>One of the major limitations of the <code>lavaan</code> package is its reliance on multivariate normality; it cannot easily accommodate non-normal distributions in response (endogeneous) variables. In biological datasets, variables often deviate from normality, and treating them as normally distributed can increase the risk of inappropriate statistical inference.</p>
<p><strong>Piecewise SEM</strong> addresses this limitation by allowing component models to follow a variety of distributions, such as Poisson, binomial, or negative binomial, making it much more flexible for real-world biological data. It is important to note, however, that piecewise SEM is not a full SEM in the traditional sense; it does not support latent variables within the directed acyclic graph (DAG). In practice, piecewise SEM should be understood as an extension of <strong>path analysis</strong> that combines generalized and/or mixed-effect models while retaining the network structure of relationships among variables.</p>
<p>To illustrate the utility of piecewise SEM, we will use the dataset from <a href="https://esajournals.onlinelibrary.wiley.com/doi/full/10.1890/1051-0761%282006%29016%5B0503%3AASEMAO%5D2.0.CO%3B2">Grace and Keeley (2006)</a>. In their study, the authors examined the relationships among landscape position, abiotic conditions, fire severity, and plant diversity. This dataset is conveniently included in the <code>piecewiseSEM</code> package, allowing us to replicate and explore these ecological relationships using modern piecewise SEM methods.</p>
<div class="sourceCode" id="cb571"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"keeley"</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">df_keeley</span> <span class="op">&lt;-</span> <span class="va">keeley</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 90 × 8
##    distance  elev abiotic   age hetero firesev cover  rich
##       &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
##  1     53.4  1225    60.7    40  0.757    3.5  1.04     51
##  2     37.0    60    40.9    25  0.491    4.05 0.478    31
##  3     53.7   200    51.0    15  0.844    2.6  0.949    71
##  4     53.7   200    61.2    15  0.691    2.9  1.19     64
##  5     52.0   970    46.7    23  0.546    4.3  1.30     68
##  6     52.0   970    39.8    24  0.653    4    1.17     34
##  7     52.0   950    56.4    35  0.742    4.8  0.862    39
##  8     51.4   740    47.0    14  0.822    4.8  0.419    66
##  9     37.0   170    42.1    45  0.603    7.25 0.129    25
## 10     37.9   190    32.6    35  0.805    6.2  0.306    31
## # ℹ 80 more rows</code></pre>
<p>The Keeley dataset contains nine ecological variables measured across 90 post-fire shrubland sites in California: distance from the fire source in meters (<code>distance</code>), elevation above sea level in meters (<code>elev</code>), an abiotic conditions index that represents a composite score of multiple non-biological environmental factors such as soil properties (<code>abiotic</code>), within-plot heterogeneity measuring spatial variability in species composition (<code>hetero</code>), stand age in years since the previous fire event (<code>age</code>), fire severity (<code>firesev</code>), fractional vegetation cover (<code>cover</code>), and species richness of plants (<code>rich</code>).</p>
<p>The proposed DAG in Grace and Keeley (2006) is as follows – landscape position (represented by distance to the coast) affects both abiotic conditions and habitat heterogeneity, as topography, soil, and microclimate vary across the landscape. Stand age influences fire severity, since older vegetation tends to accumulate more fuel and burn differently. Fire severity, in turn, affects vegetation cover, altering plant species richness via both the direct effects of cover, abiotic conditions, and habitat heterogeneity, integrating the cumulative influence of these upstream environmental and disturbance factors.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:adv-06-keeley-dag"></span>
<img src="biostats_files/figure-html/adv-06-keeley-dag-1.png" alt="Conceptual path diagram illustrating the hypothesized relationships among landscape position, environmental conditions, disturbance, and plant diversity based on Grace and Keeley (2006). Arrows indicate directional (causal) paths specified in the piecewise structural equation model. Distance represents landscape position, which influences abiotic conditions, heterogeneity, and stand age. Fire severity and vegetation cover act as intermediate variables affecting plant species richness. The diagram represents the directed acyclic graph (DAG) used to define the component models in the piecewise SEM analysis." width="672"><p class="caption">
Figure 22.1: Conceptual path diagram illustrating the hypothesized relationships among landscape position, environmental conditions, disturbance, and plant diversity based on Grace and Keeley (2006). Arrows indicate directional (causal) paths specified in the piecewise structural equation model. Distance represents landscape position, which influences abiotic conditions, heterogeneity, and stand age. Fire severity and vegetation cover act as intermediate variables affecting plant species richness. The diagram represents the directed acyclic graph (DAG) used to define the component models in the piecewise SEM analysis.
</p>
</div>
<p>The <code>psem()</code> function takes multiple “piecewise” model objects as input and combines them into a single causal network. From these component models, it constructs a path diagram and evaluates the implied conditional independence claims that define the structural equation model.</p>
<p>The conditional independence claims correspond to the missing paths in the proposed DAG. If any of these implied independence relationships are statistically violated —- meaning a missing path is in fact significant – this suggests that the proposed model structure is incomplete and may be omitting important biological relationships.</p>
<p>For this example, we begin by fitting a piecewise SEM in which all response variables are assumed to follow normal distributions. This reflects the original approach used by Grace and Keeley (2006) and provides a useful baseline for understanding how the method operates before extending it to more complex, non-normal models.</p>
<div class="sourceCode" id="cb573"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define individual models</span></span>
<span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">abiotic</span> <span class="op">~</span> <span class="va">distance</span>, data <span class="op">=</span> <span class="va">df_keeley</span><span class="op">)</span></span>
<span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">hetero</span> <span class="op">~</span> <span class="va">distance</span>, data <span class="op">=</span> <span class="va">df_keeley</span><span class="op">)</span></span>
<span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">firesev</span> <span class="op">~</span> <span class="va">age</span>, data <span class="op">=</span> <span class="va">df_keeley</span><span class="op">)</span></span>
<span><span class="va">m4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">cover</span> <span class="op">~</span> <span class="va">firesev</span>, data <span class="op">=</span> <span class="va">df_keeley</span><span class="op">)</span></span>
<span><span class="va">m5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">rich</span> <span class="op">~</span> <span class="va">cover</span> <span class="op">+</span> <span class="va">abiotic</span> <span class="op">+</span> <span class="va">hetero</span>, data <span class="op">=</span> <span class="va">df_keeley</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine into piecewise SEM</span></span>
<span><span class="va">sem_model</span> <span class="op">&lt;-</span> <span class="fu">psem</span><span class="op">(</span><span class="va">m1</span>, <span class="va">m2</span>, <span class="va">m3</span>, <span class="va">m4</span>, <span class="va">m5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Evaluate</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sem_model</span>, .progressBar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Structural Equation Model of sem_model 
## 
## Call:
##   abiotic ~ distance
##   hetero ~ distance
##   firesev ~ age
##   cover ~ firesev
##   rich ~ cover + abiotic + hetero
## 
##     AIC
##  1523.060
## 
## ---
## Tests of directed separation:
## 
##             Independ.Claim Test.Type DF Crit.Value P.Value   
##   firesev ~ distance + ...      coef 87    -1.6793  0.0967   
##     cover ~ distance + ...      coef 87     1.3302  0.1869   
##      rich ~ distance + ...      coef 85     3.1710  0.0021 **
##        abiotic ~ age + ...      coef 87    -0.0652  0.9481   
##         hetero ~ age + ...      coef 87     0.0043  0.9966   
##          cover ~ age + ...      coef 87    -1.8018  0.0750   
##           rich ~ age + ...      coef 85    -1.2670  0.2086   
##     hetero ~ abiotic + ...      coef 87     1.3296  0.1871   
##    firesev ~ abiotic + ...      coef 86    -0.9713  0.3341   
##      cover ~ abiotic + ...      coef 86    -0.2678  0.7895   
##     firesev ~ hetero + ...      coef 86     0.4923  0.6237   
##       cover ~ hetero + ...      coef 86    -2.7229  0.0078 **
##       rich ~ firesev + ...      coef 84    -1.3692  0.1746   
## 
## --
## Global goodness-of-fit:
## 
## Chi-Squared = 30.929 with P-value = 0.003 and on 13 degrees of freedom
## Fisher's C = 48.924 with P-value = 0.004 and on 26 degrees of freedom
## 
## ---
## Coefficients:
## 
##   Response Predictor Estimate Std.Error DF Crit.Value P.Value Std.Estimate    
##    abiotic  distance   0.3998    0.0823 88     4.8562   0e+00       0.4597 ***
##     hetero  distance   0.0045    0.0013 88     3.4593   8e-04       0.3460 ***
##    firesev       age   0.0597    0.0125 88     4.7781   0e+00       0.4539 ***
##      cover   firesev  -0.0839    0.0184 88    -4.5594   0e+00      -0.4371 ***
##       rich     cover  17.0138    3.7923 86     4.4864   0e+00       0.3573 ***
##       rich   abiotic   0.6847    0.1607 86     4.2609   1e-04       0.3481 ***
##       rich    hetero  55.3686   10.8212 86     5.1167   0e+00       0.4209 ***
## 
##   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05
## 
## ---
## Individual R-squared:
## 
##   Response method R.squared
##    abiotic   none      0.21
##     hetero   none      0.12
##    firesev   none      0.21
##      cover   none      0.19
##       rich   none      0.49</code></pre>
<p><code>Tests of directed separation:</code> report which missing paths in the DAG are statistically significant. If any of these independence claims are rejected, it suggests that the proposed model structure may be incomplete. In this example, the relationships <code>rich ~ distance + ...</code> and <code>cover ~ hetero + ...</code> are identified as significant, indicating that these pathways may need to be explicitly included in the final model.</p>
<p><code>Global goodness-of-fit:</code> reports both the chi-squared statistic and Fisher’s C. Unlike covariance-based SEM (e.g., <code>lavaan</code>), the chi-squared statistic in piecewise SEM is not derived from a variance–covariance matrix. Instead, it is computed by comparing the summed log-likelihoods of the component models under the saturated and unsaturated model structures, allowing the framework to accommodate non-normal response distributions.</p>
<p>Fisher’s C provides an alternative measure of overall model fit and is calculated as <span class="math inline">\(C = -2 \sum_i \ln(p_i)\)</span>, where <span class="math inline">\(i\)</span> indexes each conditional independence claim and <span class="math inline">\(p_i\)</span> is the corresponding p-value. Large values of Fisher’s C (i.e., small p-values) indicate that one or more independence assumptions are violated, suggesting that the proposed model may be missing important pathways.</p>
<p><code>Coefficients:</code> summarizes the estimated effects for each component model. As in the <code>lavaan</code> framework, both raw parameter estimates (<code>Estimate</code>) and standardized coefficients (<code>Std.Estimate</code>) are reported. The raw estimates depend on the scale of the predictors and are therefore not directly comparable, whereas standardized estimates allow comparison of effect sizes across variables. Because this table clearly identifies the response and predictor variables for each path, it provides a concise and interpretable summary of the overall model output.</p>
</div>
<div id="post-fire-plant-diversity-the-revised-model" class="section level3" number="22.1.2">
<h3>
<span class="header-section-number">22.1.2</span> Post-fire plant diversity: the revised model<a class="anchor" aria-label="anchor" href="#post-fire-plant-diversity-the-revised-model"><i class="fas fa-link"></i></a>
</h3>
<p>Because some of the response variables may be better described by non-normal distributions, we can extend the piecewise SEM framework by fitting generalized linear models. In particular, species richness is a count variable and is more appropriately modeled using a negative binomial distribution.</p>
<p>In addition, the analysis above highlighted potentially important pathways that were not included in the original DAG – specifically, the direct effects of landscape position (<code>distance</code>) on richness (<code>rich</code>) and heterogeneity (<code>hetero</code>) on vegetation cover (<code>cover</code>). These paths represent direct influences of each factor that may not be fully captured by the mediating variables in the original model.</p>
<!-- ```{r} -->
<!-- # Pairwise plots of key variables in the Keeley dataset -->
<!-- df_keeley %>%  -->
<!--   ggpairs( -->
<!--     progress = FALSE, -->
<!--     columns = c("distance", -->
<!--                 "abiotic",  -->
<!--                 "hetero",  -->
<!--                 "age",  -->
<!--                 "firesev",  -->
<!--                 "cover",  -->
<!--                 "rich") -->
<!--   ) + -->
<!--   theme_bw()  # Clean, white background theme -->
<!-- ``` -->
<p>Below, we revise the previous model by fitting species richness with a negative binomial GLM and adding missing paths.</p>
<div class="sourceCode" id="cb575"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define individual models</span></span>
<span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">abiotic</span> <span class="op">~</span> <span class="va">distance</span>, data <span class="op">=</span> <span class="va">df_keeley</span><span class="op">)</span>      <span class="co"># unchanged</span></span>
<span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">hetero</span> <span class="op">~</span> <span class="va">distance</span>, data <span class="op">=</span> <span class="va">df_keeley</span><span class="op">)</span>       <span class="co"># unchanged</span></span>
<span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">firesev</span> <span class="op">~</span> <span class="va">age</span>, data <span class="op">=</span> <span class="va">df_keeley</span><span class="op">)</span>           <span class="co"># unchanged</span></span>
<span></span>
<span><span class="co"># m4 now includes a direct effect of hetero on cover (added path)</span></span>
<span><span class="va">m4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">cover</span> <span class="op">~</span> <span class="va">firesev</span> <span class="op">+</span> <span class="va">hetero</span>, data <span class="op">=</span> <span class="va">df_keeley</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># m5 now models richness as negative binomial (MASS::glm.nb) </span></span>
<span><span class="co"># and includes direct effect of distance on richness (added path)</span></span>
<span><span class="va">m5</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/glm.nb.html">glm.nb</a></span><span class="op">(</span><span class="va">rich</span> <span class="op">~</span> <span class="va">cover</span> <span class="op">+</span> <span class="va">abiotic</span> <span class="op">+</span> <span class="va">hetero</span> <span class="op">+</span> <span class="va">distance</span>, </span>
<span>                   data <span class="op">=</span> <span class="va">df_keeley</span><span class="op">)</span>  </span>
<span></span>
<span><span class="co"># Combine into piecewise SEM</span></span>
<span><span class="va">sem_model</span> <span class="op">&lt;-</span> <span class="fu">psem</span><span class="op">(</span><span class="va">m1</span>, <span class="va">m2</span>, <span class="va">m3</span>, <span class="va">m4</span>, <span class="va">m5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Evaluate model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sem_model</span>, .progressBar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Structural Equation Model of sem_model 
## 
## Call:
##   abiotic ~ distance
##   hetero ~ distance
##   firesev ~ age
##   cover ~ firesev + hetero
##   rich ~ cover + abiotic + hetero + distance
## 
##     AIC
##  1514.731
## 
## ---
## Tests of directed separation:
## 
##             Independ.Claim Test.Type DF Crit.Value P.Value  
##   firesev ~ distance + ...      coef 87    -1.6793  0.0967  
##     cover ~ distance + ...      coef 86     2.2342  0.0281 *
##        abiotic ~ age + ...      coef 87    -0.0652  0.9481  
##         hetero ~ age + ...      coef 87     0.0043  0.9966  
##           rich ~ age + ...      coef 84    -0.8843  0.3765  
##          cover ~ age + ...      coef 86    -2.0164  0.0469 *
##     hetero ~ abiotic + ...      coef 87     1.3296  0.1871  
##    firesev ~ abiotic + ...      coef 86    -0.9713  0.3341  
##      cover ~ abiotic + ...      coef 85     0.1213  0.9038  
##     firesev ~ hetero + ...      coef 86     0.4923  0.6237  
##       rich ~ firesev + ...      coef 83    -1.5271  0.1267  
## 
## --
## Global goodness-of-fit:
## 
## Chi-Squared = 17.339 with P-value = 0.098 and on 11 degrees of freedom
## Fisher's C = 30.829 with P-value = 0.1 and on 22 degrees of freedom
## 
## ---
## Coefficients:
## 
##   Response Predictor Estimate Std.Error DF Crit.Value P.Value Std.Estimate    
##    abiotic  distance   0.3998    0.0823 88     4.8562  0.0000       0.4597 ***
##     hetero  distance   0.0045    0.0013 88     3.4593  0.0008       0.3460 ***
##    firesev       age   0.0597    0.0125 88     4.7781  0.0000       0.4539 ***
##      cover   firesev  -0.0859    0.0181 87    -4.7399  0.0000      -0.4472 ***
##      cover    hetero  -0.5299    0.2607 87    -2.0329  0.0451      -0.1918   *
##       rich     cover   0.3277    0.0777 85     4.2200  0.0000       0.3102 ***
##       rich   abiotic   0.0096    0.0033 85     2.8888  0.0039       0.2206  **
##       rich    hetero   0.9762    0.2285 85     4.2718  0.0000       0.3344 ***
##       rich  distance   0.0103    0.0032 85     3.2787  0.0010       0.2725  **
## 
##   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05
## 
## ---
## Individual R-squared:
## 
##   Response     method R.squared
##    abiotic       none      0.21
##     hetero       none      0.12
##    firesev       none      0.21
##      cover       none      0.23
##       rich nagelkerke      0.78</code></pre>
<p>After including the previously missing paths, the Fisher’s C statistic became non-significant, indicating that the revised model fits the data reasonably well. The results can be visualized using the <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> function, where solid arrows indicate statistically significant pathways and dashed arrows indicate non-significant pathways.</p>
<div class="sourceCode" id="cb577"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sem_model</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-186"></span>
<div class="grViz html-widget html-fill-item" id="htmlwidget-a5ae78d371de1b993a76" style="width:672px;height:480px;"></div>
<script type="application/json" data-for="htmlwidget-a5ae78d371de1b993a76">{"x":{"diagram":"digraph {\n\ngraph [layout = \"neato\",\n       outputorder = \"edgesfirst\",\n       bgcolor = \"white\"]\n\nnode [fontname = \"Helvetica\",\n      fontsize = \"10\",\n      shape = \"circle\",\n      fixedsize = \"true\",\n      width = \"0.5\",\n      style = \"filled\",\n      fillcolor = \"aliceblue\",\n      color = \"gray70\",\n      fontcolor = \"gray50\"]\n\nedge [fontname = \"Helvetica\",\n     fontsize = \"8\",\n     len = \"1.5\",\n     color = \"gray80\",\n     arrowsize = \"0.5\"]\n\n  \"1\" [label = \"abiotic\", shape = \"rectangle\", color = \"black\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"2\" [label = \"hetero\", shape = \"rectangle\", color = \"black\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"3\" [label = \"firesev\", shape = \"rectangle\", color = \"black\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"4\" [label = \"cover\", shape = \"rectangle\", color = \"black\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"5\" [label = \"rich\", shape = \"rectangle\", color = \"black\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"6\" [label = \"distance\", shape = \"rectangle\", color = \"black\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n  \"7\" [label = \"age\", shape = \"rectangle\", color = \"black\", fillcolor = \"#FFFFFF\", fontcolor = \"#000000\"] \n\"6\"->\"1\" [style = \"solid\", color = \"black\", label = \" 0.46 \"] \n\"6\"->\"2\" [style = \"solid\", color = \"black\", label = \" 0.346 \"] \n\"7\"->\"3\" [style = \"solid\", color = \"black\", label = \" 0.454 \"] \n\"3\"->\"4\" [style = \"solid\", color = \"black\", label = \" -0.447 \"] \n\"2\"->\"4\" [style = \"solid\", color = \"black\", label = \" -0.192 \"] \n\"4\"->\"5\" [style = \"solid\", color = \"black\", label = \" 0.31 \"] \n\"1\"->\"5\" [style = \"solid\", color = \"black\", label = \" 0.221 \"] \n\"2\"->\"5\" [style = \"solid\", color = \"black\", label = \" 0.334 \"] \n\"6\"->\"5\" [style = \"solid\", color = \"black\", label = \" 0.272 \"] \n}","config":{"engine":"dot","options":null}},"evals":[],"jsHooks":[]}</script><p class="caption">
Figure 22.2: Visualization of the piecewise structural equation model for the Keeley dataset. Solid arrows indicate statistically significant pathways, while dashed arrows represent non-significant pathways. Node labels correspond to variables in the DAG: <code>distance</code> (distance to the coast), <code>abiotic</code> (abiotic conditions), <code>hetero</code> (habitat heterogeneity), <code>age</code> (stand age), <code>firesev</code> (fire severity), <code>cover</code> (vegetation cover), and <code>rich</code> (plant species richness).
</p>
</div>
</div>
</div>
<div id="random-effects" class="section level2" number="22.2">
<h2>
<span class="header-section-number">22.2</span> Random Effects<a class="anchor" aria-label="anchor" href="#random-effects"><i class="fas fa-link"></i></a>
</h2>
<div id="tree-growth-data-structure" class="section level3" number="22.2.1">
<h3>
<span class="header-section-number">22.2.1</span> Tree growth: data structure<a class="anchor" aria-label="anchor" href="#tree-growth-data-structure"><i class="fas fa-link"></i></a>
</h3>
<p>Another simplifying assumption in traditional SEMs is that all data points are independent. This assumption is often violated, particularly when there are repeated measurements of the same individuals over time or when sampling is spatially clustered within a confined locality. Such hierarchical structures in the data-generating process should be properly accounted for. Piecewise SEM can accommodate this by incorporating random effects, allowing the model to account for non-independence among observations. We will use <code>shipley</code> data from <a href="https://esajournals.onlinelibrary.wiley.com/doi/10.1890/08-1034.1">Shipley 2009</a> to illustrate this case.</p>
<p>This dataset contains information on tree growth (<code>Growth</code>) and survival (<code>Live</code>) for a given observation year, along with environmental variables that may influence these demographic responses. These include cumulative degree days until first bud burst (<code>DD</code>) and the date of the first bud burst (<code>Date</code>).</p>
<p>Before proceeding with the analysis, we first perform data cleaning to ensure accuracy and consistency.</p>
<div class="sourceCode" id="cb578"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"shipley"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_shipley</span> <span class="op">&lt;-</span> <span class="va">shipley</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">growth</span><span class="op">)</span></span></code></pre></div>
<p>Importantly, this dataset contains temporally and spatially repeated measurements – the same individuals are tracked for growth over time until they die (<code>tree</code> indexes individuals), and five individuals are sampled at each site (<code>site</code> indexes locations). Clearly, these observations are not independent, and this hierarchical structure must be accounted for in the analysis.</p>
<div class="sourceCode" id="cb579"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_shipley</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">site</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>n_tree <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html">n_distinct</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 20 × 2
##     site n_tree
##    &lt;int&gt;  &lt;int&gt;
##  1     1      5
##  2     2      5
##  3     3      5
##  4     4      5
##  5     5      5
##  6     6      5
##  7     7      5
##  8     8      5
##  9     9      5
## 10    10      5
## 11    11      5
## 12    12      5
## 13    13      5
## 14    14      5
## 15    15      5
## 16    16      5
## 17    17      5
## 18    18      5
## 19    19      5
## 20    20      5</code></pre>
<p>To begin developing hypotheses, we first explore pairwise relationships among the variables.</p>
<div class="sourceCode" id="cb581"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pairwise plots of key variables</span></span>
<span><span class="va">df_shipley</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">ggpairs</span><span class="op">(</span></span>
<span>    columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dd"</span>, </span>
<span>                <span class="st">"date"</span>,</span>
<span>                <span class="st">"growth"</span>,</span>
<span>                <span class="st">"live"</span><span class="op">)</span>,  <span class="co"># select variables to plot</span></span>
<span>    progress <span class="op">=</span> <span class="cn">FALSE</span>                               <span class="co"># disable progress bar</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span>                                      <span class="co"># clean theme for the plot</span></span></code></pre></div>
<p><img src="biostats_files/figure-html/unnamed-chunk-189-1.png" width="672" style="display: block; margin: auto;">
The relationships appear clear. Increasing cumulative degree days (<code>dd</code>) promotes earlier bud burst in trees (<code>date</code>; julian date of the year), which in turn may enhance both growth (<code>growth</code>) and survival (<code>live</code>).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:adv-06-shipley-dag"></span>
<img src="biostats_files/figure-html/adv-06-shipley-dag-1.png" alt="Directed acyclic graph (DAG) illustrating hypothesized  relationships among the key variables in the shipley dataset. Arrows indicate the direction of hypothesized influence: cumulative degree days (`DD`) affects the date of first bud burst (`Date of first bud`), which influences `Growth`, and in turn affects `Survival`." width="672"><p class="caption">
Figure 22.3: Directed acyclic graph (DAG) illustrating hypothesized relationships among the key variables in the shipley dataset. Arrows indicate the direction of hypothesized influence: cumulative degree days (<code>DD</code>) affects the date of first bud burst (<code>Date of first bud</code>), which influences <code>Growth</code>, and in turn affects <code>Survival</code>.
</p>
</div>
</div>
<div id="tree-growth-implementation" class="section level3" number="22.2.2">
<h3>
<span class="header-section-number">22.2.2</span> Tree growth: implementation<a class="anchor" aria-label="anchor" href="#tree-growth-implementation"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>psem()</code> function accepts GLMMs of class <code>glmmTMB</code> or <code>lmerMod</code> (from the <code>lme4</code> package), making it straightforward to include random effects in a piecewise SEM. In this example, we include site and tree as random effects. Since these are independent, unnested random effects, specifying them as separate terms in the model formula is appropriate.</p>
<div class="sourceCode" id="cb582"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Model 1: date depends on dd, with random intercepts for site and tree</span></span>
<span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu">glmmTMB</span><span class="op">(</span><span class="va">date</span> <span class="op">~</span> <span class="va">dd</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">site</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">tree</span><span class="op">)</span>, </span>
<span>              data <span class="op">=</span> <span class="va">df_shipley</span>,</span>
<span>              family <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Model 2: growth depends on date, same random effects</span></span>
<span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu">glmmTMB</span><span class="op">(</span><span class="va">growth</span> <span class="op">~</span> <span class="va">date</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">site</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">tree</span><span class="op">)</span>, </span>
<span>              data <span class="op">=</span> <span class="va">df_shipley</span>,</span>
<span>              family <span class="op">=</span> <span class="st">"gaussian"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Model 3: live (binary) depends on growth, logistic mixed model</span></span>
<span><span class="va">m3</span> <span class="op">&lt;-</span> <span class="fu">glmmTMB</span><span class="op">(</span><span class="va">live</span> <span class="op">~</span> <span class="va">growth</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">site</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">tree</span><span class="op">)</span>, </span>
<span>              data <span class="op">=</span> <span class="va">df_shipley</span>, </span>
<span>              family <span class="op">=</span> <span class="st">"binomial"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine models into a piecewise SEM</span></span>
<span><span class="va">sem_glmm</span> <span class="op">&lt;-</span> <span class="fu">psem</span><span class="op">(</span><span class="va">m1</span>, <span class="va">m2</span>, <span class="va">m3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summarize SEM (paths, significance, and Shipley's test)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">sem_glmm</span>, .progressBar <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Structural Equation Model of sem_glmm 
## 
## Call:
##   date ~ dd
##   growth ~ date
##   live ~ growth
## 
##     AIC
##  12567.398
## 
## ---
## Tests of directed separation:
## 
##      Independ.Claim Test.Type   DF Crit.Value P.Value 
##   growth ~ dd + ...      coef 1431    -0.2368  0.8128 
##     live ~ dd + ...      coef 1431    -0.2234  0.8232 
##   live ~ date + ...      coef 1431    -1.3764  0.1687 
## 
## --
## Global goodness-of-fit:
## 
## Chi-Squared = 2.14 with P-value = 0.544 and on 3 degrees of freedom
## Fisher's C = 4.363 with P-value = 0.628 and on 6 degrees of freedom
## 
## ---
## Coefficients:
## 
##   Response Predictor Estimate Std.Error   DF Crit.Value P.Value Std.Estimate    
##       date        dd  -0.4976    0.0049 1431  -100.9187       0      -0.6281 ***
##     growth      date   0.3005    0.0268 1431    11.2202       0       0.3822 ***
##       live    growth   0.3479    0.0584 1431     5.9598       0       0.7866 ***
## 
##   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05
## 
## ---
## Individual R-squared:
## 
##   Response method Marginal Conditional
##       date   none     0.42        0.98
##     growth   none     0.11        0.83
##       live   none     0.56        0.63</code></pre>
<p>The model specification and interpretation are largely the same as before. In this case, both the chi-squared test and Fisher’s C were non-significant, indicating that the model fits the data well.</p>
<p>One key difference is the <code>Individual R-squared:</code> section, which now reports <code>Marginal</code> and <code>Conditional</code> values. These represent the model’s ability to explain variation using fixed effects only (marginal) or using both fixed and random effects (conditional). Because random effects often explain a substantial portion of the variation—particularly in the growth model—the conditional R-squared values are typically much higher. Note that these R-squared values are defined following <a href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/j.2041-210x.2012.00261.x">Nakagawa and Schielzeth (2012)</a> and differ from traditional R-squared.</p>
</div>
</div>
<div id="limitations" class="section level2" number="22.3">
<h2>
<span class="header-section-number">22.3</span> Limitations<a class="anchor" aria-label="anchor" href="#limitations"><i class="fas fa-link"></i></a>
</h2>
<p>While piecewise SEM greatly expands the scope of data analysis, a notable limitation is the inability to incorporate latent variables—this feature is not implemented in the current package. However, the inclusion of latent variables is not a mathematical limitation, only a limitation of the implementation. Incorporating latent variables is possible within more generalized SEM frameworks, although the fitting process becomes more challenging. For those interested in this approach, Bayesian modeling offers a flexible alternative, and emerging packages (e.g., the <code>brms</code> package) increasingly allow such analyses without directly writing Stan or BUGS code. Nevertheless, these extensions require a solid understanding of the underlying statistical principles.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="structural-equation-modeling.html"><span class="header-section-number">21</span> Structural Equation Modeling</a></div>
<div class="next"><a href="time-series-analysis.html"><span class="header-section-number">23</span> Time-Series Analysis</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#piecewise-sem"><span class="header-section-number">22</span> Piecewise SEM</a></li>
<li>
<a class="nav-link" href="#non-normal-distributions"><span class="header-section-number">22.1</span> Non-normal Distributions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#post-fire-plant-diversity-the-original-model"><span class="header-section-number">22.1.1</span> Post-fire plant diversity: the original model</a></li>
<li><a class="nav-link" href="#post-fire-plant-diversity-the-revised-model"><span class="header-section-number">22.1.2</span> Post-fire plant diversity: the revised model</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#random-effects"><span class="header-section-number">22.2</span> Random Effects</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#tree-growth-data-structure"><span class="header-section-number">22.2.1</span> Tree growth: data structure</a></li>
<li><a class="nav-link" href="#tree-growth-implementation"><span class="header-section-number">22.2.2</span> Tree growth: implementation</a></li>
</ul>
</li>
<li><a class="nav-link" href="#limitations"><span class="header-section-number">22.3</span> Limitations</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/aterui/biostats/blob/master/chapters/adv-06-psem.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/aterui/biostats/edit/master/chapters/adv-06-psem.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>BIOSTATS</strong>" was written by Akira Terui. It was last built on 2025-12-31.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
