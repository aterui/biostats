<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 12 Regression | BIOSTATS</title>
<meta name="author" content="Akira Terui">
<meta name="description" content="Our previous examples focused on cases that involved a distinct group structure. However, it is not always the case that such a structure exists. Instead, we might examine the relationship between...">
<meta name="generator" content="bookdown 0.43 with bs4_book()">
<meta property="og:title" content="Chapter 12 Regression | BIOSTATS">
<meta property="og:type" content="book">
<meta property="og:description" content="Our previous examples focused on cases that involved a distinct group structure. However, it is not always the case that such a structure exists. Instead, we might examine the relationship between...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 12 Regression | BIOSTATS">
<meta name="twitter:description" content="Our previous examples focused on cases that involved a distinct group structure. However, it is not always the case that such a structure exists. Instead, we might examine the relationship between...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.9.0/transition.js"></script><script src="libs/bs3compat-0.9.0/tabs.js"></script><script src="libs/bs3compat-0.9.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-QZSNHVQQNV"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-QZSNHVQQNV');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">BIOSTATS</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Introduction</a></li>
<li class="book-part">Getting Started</li>
<li><a class="" href="what-is-r-and-r-studio.html"><span class="header-section-number">1</span> What is R and R studio?</a></li>
<li><a class="" href="installing-r-and-rstudio.html"><span class="header-section-number">2</span> Installing R and RStudio</a></li>
<li><a class="" href="r-project.html"><span class="header-section-number">3</span> R Project</a></li>
<li class="book-part">R Basics</li>
<li><a class="" href="data-structure.html"><span class="header-section-number">4</span> Data Structure</a></li>
<li><a class="" href="data-manipulation.html"><span class="header-section-number">5</span> Data Manipulation</a></li>
<li><a class="" href="visualization.html"><span class="header-section-number">6</span> Visualization</a></li>
<li class="book-part">Basic Statistics</li>
<li><a class="" href="descriptive-statistics.html"><span class="header-section-number">7</span> Descriptive Statistics</a></li>
<li><a class="" href="sampling.html"><span class="header-section-number">8</span> Sampling</a></li>
<li><a class="" href="probabilistic-view.html"><span class="header-section-number">9</span> Probabilistic View</a></li>
<li><a class="" href="two-group-comparison.html"><span class="header-section-number">10</span> Two-Group Comparison</a></li>
<li><a class="" href="multiple-group-comparison.html"><span class="header-section-number">11</span> Multiple-Group Comparison</a></li>
<li><a class="active" href="regression.html"><span class="header-section-number">12</span> Regression</a></li>
<li><a class="" href="linear-model.html"><span class="header-section-number">13</span> Linear Model</a></li>
<li><a class="" href="generalized-linear-model.html"><span class="header-section-number">14</span> Generalized Linear Model</a></li>
<li><a class="" href="likelihood.html"><span class="header-section-number">15</span> Likelihood</a></li>
<li><a class="" href="model-comparison.html"><span class="header-section-number">16</span> Model Comparison</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="git-github.html">Git &amp; GitHub</a></li>
<li><a class="" href="base-plot.html">Base Plot</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/aterui/biostats">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="regression" class="section level1" number="12">
<h1>
<span class="header-section-number">12</span> Regression<a class="anchor" aria-label="anchor" href="#regression"><i class="fas fa-link"></i></a>
</h1>
<p>Our previous examples focused on cases that involved a distinct group structure. However, it is not always the case that such a structure exists. Instead, we might examine the relationship between continuous variables. In this chapter, I will introduce a technique called linear regression.</p>
<p><strong>Key words:</strong> intercept, slope (coefficient), least squares, residual, coefficient of determination (<span class="math inline">\(\mbox{R}^2\)</span>)</p>
<div id="explore-data-structure-1" class="section level2" number="12.1">
<h2>
<span class="header-section-number">12.1</span> Explore Data Structure<a class="anchor" aria-label="anchor" href="#explore-data-structure-1"><i class="fas fa-link"></i></a>
</h2>
<p>For this exercise, we will use algae biomass data from streams. Download the data <a href="https://github.com/aterui/biostats/blob/master/data_raw/data_algae.csv">here</a> and locate it in <code>data_raw/</code>.</p>
<div class="sourceCode" id="cb353"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">df_algae</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data_raw/data_algae.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">df_algae</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 50 × 4
##    biomass unit_biomass conductivity unit_cond
##      &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt; &lt;chr&gt;    
##  1   19.8  mg_per_m2            30.2 ms       
##  2   24.4  mg_per_m2            40.4 ms       
##  3   27.4  mg_per_m2            59.4 ms       
##  4   48.2  mg_per_m2            91.3 ms       
##  5   19.2  mg_per_m2            24.2 ms       
##  6   57.0  mg_per_m2            90.4 ms       
##  7   51.9  mg_per_m2            94.7 ms       
##  8   40.8  mg_per_m2            67.8 ms       
##  9   37.1  mg_per_m2            64.8 ms       
## 10    3.55 mg_per_m2            10.9 ms       
## # ℹ 40 more rows</code></pre>
<p>This dataset comprises data collected from 50 sampling sites. The variable <code>biomass</code> represents the standing biomass, indicating the dry mass of algae at the time of collection. On the other hand, <code>conductivity</code> serves as a proxy for water quality, with higher values usually indicating a higher nutrient content in the water. Let me now proceed to draw a scatter plot that will help visualize the relationship between these two variables.</p>
<div class="sourceCode" id="cb355"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_algae</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">conductivity</span>,</span>
<span>             y <span class="op">=</span> <span class="va">biomass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:scatter"></span>
<img src="biostats_files/figure-html/scatter-1.png" alt="The relationship between algae biomass and conductivity." width="672"><p class="caption">
Figure 12.1: The relationship between algae biomass and conductivity.
</p>
</div>
<p>It seems that there is a noticeable positive correlation where increased conductivity results in higher algal biomass. Nevertheless, how can we accurately represent this relationship with a line?</p>
</div>
<div id="drawing-the-fittest-line" class="section level2" number="12.2">
<h2>
<span class="header-section-number">12.2</span> Drawing the “fittest” line<a class="anchor" aria-label="anchor" href="#drawing-the-fittest-line"><i class="fas fa-link"></i></a>
</h2>
<div id="linear-formula" class="section level3" number="12.2.1">
<h3>
<span class="header-section-number">12.2.1</span> Linear formula<a class="anchor" aria-label="anchor" href="#linear-formula"><i class="fas fa-link"></i></a>
</h3>
<p>The first step is to represent the relationship as a formula; let me ASSUME that the relationship can be described by the following linear formula:</p>
<p><span class="math display">\[
y_i = \alpha + \beta x_i
\]</span></p>
<p>In this formula, the algal biomass, denoted as <span class="math inline">\(y_i\)</span>, at site <span class="math inline">\(i\)</span>, is expressed as a function of conductivity, represented by <span class="math inline">\(x_i\)</span>. The variable being explained (<span class="math inline">\(y_i\)</span>) is referred to as a <strong>response (or dependent) variable</strong>, while the variable used to predict the response variable (<span class="math inline">\(x_i\)</span>) is referred to as <strong>an explanatory (or independent) variable.</strong> However, there are two additional constants, namely <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>. <span class="math inline">\(\alpha\)</span> is commonly known as the <strong>intercept</strong>, while <span class="math inline">\(\beta\)</span> is referred to as the <strong>slope</strong> or <strong>coefficient</strong>. The intercept represents the value of <span class="math inline">\(y\)</span> when <span class="math inline">\(x\)</span> is equal to zero, while the slope indicates the change in <span class="math inline">\(y\)</span> associated with a unit increase in <span class="math inline">\(x\)</span> (refer to Figure <a href="regression.html#fig:intercept-slope">12.2</a>).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:intercept-slope"></span>
<img src="image/figure_lm.png" alt="Intercept and slope." width="525"><p class="caption">
Figure 12.2: Intercept and slope.
</p>
</div>
<p>However, this formula, or “model,” is incomplete. We must add the error term <span class="math inline">\(\varepsilon_i\)</span> (<strong>residual</strong>) to consider the uncertainty associated with the observation process.</p>
<p><span class="math display">\[
y_i = \alpha + \beta x_i + \varepsilon_i\\
\varepsilon_i \sim \text{Normal}(0, \sigma^2)
\]</span></p>
<p>Notice that <span class="math inline">\(y_i\)</span>, <span class="math inline">\(x_i\)</span>, and <span class="math inline">\(\varepsilon_i\)</span> have subscripts, while <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> do not. This means that <span class="math inline">\(y_i\)</span>, <span class="math inline">\(x_i\)</span>, and <span class="math inline">\(\varepsilon_i\)</span> vary by data point <span class="math inline">\(i\)</span>, and <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are constants. Although <span class="math inline">\(\alpha + \beta x_i\)</span> cannot reproduce <span class="math inline">\(y_i\)</span> perfectly, we “fill” the gaps with the error term <span class="math inline">\(\varepsilon_i\)</span>, which is assumed to follow a Normal distribution.</p>
<p>In R, finding the best <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> – i.e., the parameters in this model – is very easy. Function <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> does everything for you. Let me apply this function to the example data set:</p>
<div class="sourceCode" id="cb356"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># lm() takes a formula as the first argument</span></span>
<span><span class="co"># don't forget to supply your data</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">biomass</span> <span class="op">~</span> <span class="va">conductivity</span>,</span>
<span>        data <span class="op">=</span> <span class="va">df_algae</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = biomass ~ conductivity, data = df_algae)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.5578 -2.8729 -0.7307  2.5479 11.4700 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   5.29647    1.57178    3.37  0.00149 ** 
## conductivity  0.50355    0.02568   19.61  &lt; 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 4.649 on 48 degrees of freedom
## Multiple R-squared:  0.889,  Adjusted R-squared:  0.8867 
## F-statistic: 384.5 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>In <code>Coefficients:</code>, it says <code>(Intercept)</code> is 5.3 and <code>conductivity</code> is 0.5. These values corresponds to <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>. Meanwhile, <code>Residual standard error:</code> indicates the SD of the error term <span class="math inline">\(\sigma\)</span>. Thus, substituting these values into the formula yields:</p>
<p><span class="math display">\[
y_i = 5.30 + 0.50 x_i + \varepsilon_i\\
\varepsilon_i \sim \text{Normal}(0, 4.6^2)
\]</span></p>
<p>We can draw this “fittest” line on the figure:</p>
<div class="sourceCode" id="cb358"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># coef() extracts estimated coefficients</span></span>
<span><span class="co"># e.g., coef(m)[1] is (Intercept)</span></span>
<span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span><span class="va">df_algae</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">conductivity</span>,</span>
<span>             y <span class="op">=</span> <span class="va">biomass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>              slope <span class="op">=</span> <span class="va">beta</span><span class="op">)</span> <span class="co"># draw the line</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fittest-line"></span>
<img src="biostats_files/figure-html/fittest-line-1.png" alt="Drawing the fitted model prediction." width="672"><p class="caption">
Figure 12.3: Drawing the fitted model prediction.
</p>
</div>
<p>However, how did <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> find <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>?</p>
</div>
<div id="minimizing-the-errors" class="section level3" number="12.2.2">
<h3>
<span class="header-section-number">12.2.2</span> Minimizing the errors<a class="anchor" aria-label="anchor" href="#minimizing-the-errors"><i class="fas fa-link"></i></a>
</h3>
<p>Notice that the error term is the difference between <span class="math inline">\(y_i\)</span> and <span class="math inline">\(\alpha + \beta x_i\)</span>:</p>
<p><span class="math display">\[
\varepsilon_i = y_i - (\alpha + \beta x_i)
\]</span>In other words, this term represents the portion of the observation <span class="math inline">\(y_i\)</span> that cannot be explained by the conductivity <span class="math inline">\(x_i\)</span>. Therefore, a logical approach would be to find values for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> that minimize this unexplained portion across all data points <span class="math inline">\(i\)</span>.</p>
<p><strong>Least squares methods</strong> are a widely employed statistical approach to achieve this objective. These methods aim to minimize the sum of squared errors, denoted as <span class="math inline">\(\sum_i \varepsilon_i^2\)</span>, across all data points. As the deviation from the expected value of <span class="math inline">\(\alpha + \beta x_i\)</span> increases, this quantity also increases. Consequently, determining parameter values (<span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>) that minimize this sum of squared errors yields the best-fitting formula (see Section <a href="regression.html#least-squares">12.2.3</a> for further details).</p>
</div>
<div id="least-squares" class="section level3" number="12.2.3">
<h3>
<span class="header-section-number">12.2.3</span> Least Squares<a class="anchor" aria-label="anchor" href="#least-squares"><i class="fas fa-link"></i></a>
</h3>
<p>Introducing a matrix representation is indeed a helpful way to explain the least square method. Here, I represent the vector of observed values <span class="math inline">\(y_i\)</span> as <span class="math inline">\(Y\)</span> (<span class="math inline">\(Y = \{y_1, y_2,...,y_n\}^T\)</span>), the vector of parameters as <span class="math inline">\(\Theta\)</span> (<span class="math inline">\(\Theta = \{\alpha, \beta\}^T\)</span>), and the matrix composed of <span class="math inline">\(1\)</span>s and <span class="math inline">\(x_i\)</span> values as <span class="math inline">\(X\)</span>. The matrix <span class="math inline">\(X\)</span> can be written as:</p>
<p><span class="math display">\[
X =
\begin{pmatrix}
  1 &amp; x_1\\
  1 &amp; x_2\\
  1 &amp; x_3\\
  \vdots &amp; \vdots\\
  1 &amp; x_n
\end{pmatrix}
\]</span></p>
<p>Using matrix notation, we can express the error vector <span class="math inline">\(\pmb{\varepsilon}\)</span> as:</p>
<p><span class="math display">\[
\pmb{\varepsilon} = Y - X\Theta
\]</span></p>
<p>The column of <span class="math inline">\(1\)</span>s is required to represent the intercept; <span class="math inline">\(X\Theta\)</span> reads:</p>
<p><span class="math display">\[
X\Theta =
\begin{pmatrix}
  1 &amp; x_1\\
  1 &amp; x_2\\
  1 &amp; x_3\\
  \vdots &amp; \vdots\\
  1 &amp; x_n
\end{pmatrix}
\begin{pmatrix}
  \alpha\\
  \beta
\end{pmatrix}
=
\begin{pmatrix}
  \alpha + \beta x_1\\
  \alpha + \beta x_2\\
  \alpha + \beta x_3\\
  \vdots\\
  \alpha + \beta x_n
\end{pmatrix}
\]</span></p>
<p>Minimizing the squared magnitude of <span class="math inline">\(\pmb{\varepsilon}\)</span> (solve the partial derivative of <span class="math inline">\(||\pmb{\varepsilon}||^2\)</span> about <span class="math inline">\(\Theta\)</span>) leads to the solution (for detailed derivation, refer to <a href="https://en.wikipedia.org/wiki/Least_squares">Wikipedia</a>):</p>
<p><span class="math display">\[
\hat{\Theta} = (X^TX)^{-1}X^{T}Y
\]</span></p>
<p>Let me see if this reproduces the result of <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>:</p>
<div class="sourceCode" id="cb359"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create matrix X</span></span>
<span><span class="va">v_x</span> <span class="op">&lt;-</span> <span class="va">df_algae</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">conductivity</span><span class="op">)</span></span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">v_x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create a vector of y</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">df_algae</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">biomass</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># %*%: matrix multiplication</span></span>
<span><span class="co"># t(): transpose a matrix</span></span>
<span><span class="co"># solve(): computes the inverse matrix</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">X</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">Y</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span></span></code></pre></div>
<pre><code>##          [,1]
##     5.2964689
## v_x 0.5035548</code></pre>
<p><code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> output for a reference:</p>
<div class="sourceCode" id="cb361"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">biomass</span> <span class="op">~</span> <span class="va">conductivity</span>,</span>
<span>        data <span class="op">=</span> <span class="va">df_algae</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  (Intercept) conductivity 
##    5.2964689    0.5035548</code></pre>
</div>
<div id="standard-errors-and-t-values" class="section level3" number="12.2.4">
<h3>
<span class="header-section-number">12.2.4</span> Standard Errors and t-values<a class="anchor" aria-label="anchor" href="#standard-errors-and-t-values"><i class="fas fa-link"></i></a>
</h3>
<p>Ensuring the reliability of the estimated point estimates for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> is crucial. In the <code>summary(m)</code> output, two statistical quantities, namely the <code>Std. Error</code> and <code>t-value</code>, play a significant role in assessing the uncertainty associated with these estimates.</p>
<p>The standard error (<code>Std. Error</code>; “SE”) represents the estimated standard deviation of the parameter estimates (<span class="math inline">\(\hat{\theta}\)</span> is either <span class="math inline">\(\hat{\alpha}\)</span> or <span class="math inline">\(\hat{\beta}\)</span>). A smaller value of the standard error indicates a higher degree of statistical reliability in the estimate. On the other hand, the <code>t-value</code> is a concept we have covered in Chapter <a href="two-group-comparison.html#two-group-comparison">10</a>. This value is defined as:</p>
<p><span class="math display">\[
t = \frac{\hat{\theta} - \theta_0}{\text{SE}(\hat{\theta})}
\]</span></p>
<p>The t-statistic is akin to the t-test; however, in the context of regression analysis, we do not have another group to compare with (i.e., <span class="math inline">\(\theta_0\)</span>). Typically, in regression analysis, we use zero as the reference (<span class="math inline">\(\theta_0 = 0\)</span>). Therefore, higher t-values in <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> indicate a greater deviation from zero. Consequently, the <strong>Null Hypothesis in regression analysis is</strong> <span class="math inline">\(\beta = 0\)</span>. This hypothesis is sensible in our specific example since we are interested in quantifying the effect of conductivity. If <span class="math inline">\(\beta = 0\)</span>, it implies that conductivity has no effect on algal biomass. Since <span class="math inline">\(\theta_0 = 0\)</span>, the following code reproduces the reported t-values:</p>
<div class="sourceCode" id="cb363"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># extract coefficients</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># extract standard errors</span></span>
<span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># t-value</span></span>
<span><span class="va">t_value</span> <span class="op">&lt;-</span> <span class="va">theta</span> <span class="op">/</span> <span class="va">se</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">t_value</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  (Intercept) conductivity 
##     3.369732    19.609446</code></pre>
<p>After defining the Null Hypothesis and t-values, we can compute the probability of observing the estimated parameters under the Null Hypothesis. Similar to the t-test, <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> utilizes a Student’s t-distribution for this purpose. However, the difference lies in how we estimate the degrees of freedom. In our case, we have 50 data points but need to subtract the number of parameters, which are <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>. Therefore, the degrees of freedom would be <span class="math inline">\(50 - 2 = 48\)</span>. This value is employed when calculating the p-value:</p>
<div class="sourceCode" id="cb365"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># for intercept</span></span>
<span><span class="co"># (1 - pt(t_value[1], df = 48)) calculates pr(t &gt; t_value[1])</span></span>
<span><span class="co"># pt(-t_value[1], df = 48) calculates pr(t &lt; -t_value[1])</span></span>
<span><span class="va">p_alpha</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span><span class="va">t_value</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, df <span class="op">=</span> <span class="fl">48</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span><span class="op">-</span><span class="va">t_value</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, df <span class="op">=</span> <span class="fl">48</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># for slope</span></span>
<span><span class="va">p_beta</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span><span class="va">t_value</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, df <span class="op">=</span> <span class="fl">48</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">pt</a></span><span class="op">(</span><span class="op">-</span><span class="va">t_value</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, df <span class="op">=</span> <span class="fl">48</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_alpha</span><span class="op">)</span></span></code></pre></div>
<pre><code>## (Intercept) 
## 0.001492023</code></pre>
<div class="sourceCode" id="cb367"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_beta</span><span class="op">)</span></span></code></pre></div>
<pre><code>## conductivity 
## 7.377061e-25</code></pre>
</div>
</div>
<div id="unexplained-variation" class="section level2" number="12.3">
<h2>
<span class="header-section-number">12.3</span> Unexplained Variation<a class="anchor" aria-label="anchor" href="#unexplained-variation"><i class="fas fa-link"></i></a>
</h2>
<div id="retrieve-errors" class="section level3" number="12.3.1">
<h3>
<span class="header-section-number">12.3.1</span> Retrieve Errors<a class="anchor" aria-label="anchor" href="#retrieve-errors"><i class="fas fa-link"></i></a>
</h3>
<p>The function <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> provides estimates for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>, but it does not directly provide the values of <span class="math inline">\(\varepsilon_i\)</span>. To gain a deeper understanding of the statistical model, it is necessary to examine the residuals <span class="math inline">\(\varepsilon_i\)</span>. By using the <code><a href="https://rdrr.io/r/stats/residuals.html">resid()</a></code> function, you can obtain the values of <span class="math inline">\(\varepsilon_i\)</span>. This allows you to explore and extract insights from the developed statistical model.</p>
<div class="sourceCode" id="cb369"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># eps - stands for epsilon</span></span>
<span><span class="va">eps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">eps</span><span class="op">)</span></span></code></pre></div>
<pre><code>##          1          2          3          4          5          6 
## -0.6838937 -1.2149034 -7.8576927 -3.0109473  1.7076481  6.1773586</code></pre>
<p>Each element retains the order of data point in the original data frame, so <code>eps[1]</code> (<span class="math inline">\(\varepsilon_1\)</span>) should be identical to <span class="math inline">\(y_1 - (\alpha + \beta x_1)\)</span>. Let me confirm:</p>
<div class="sourceCode" id="cb371"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pull vector data</span></span>
<span><span class="va">v_x</span> <span class="op">&lt;-</span> <span class="va">df_algae</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">conductivity</span><span class="op">)</span></span>
<span><span class="va">v_y</span> <span class="op">&lt;-</span> <span class="va">df_algae</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">biomass</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># theta[1] = alpha</span></span>
<span><span class="co"># theta[2] = beta</span></span>
<span><span class="va">error</span> <span class="op">&lt;-</span> <span class="va">v_y</span> <span class="op">-</span> <span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">theta</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">v_x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># cbind() combines vectors column-wise</span></span>
<span><span class="co"># head() retrieves the first 6 rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">eps</span>, <span class="va">error</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>##          eps      error
## 1 -0.6838937 -0.6838937
## 2 -1.2149034 -1.2149034
## 3 -7.8576927 -7.8576927
## 4 -3.0109473 -3.0109473
## 5  1.7076481  1.7076481
## 6  6.1773586  6.1773586</code></pre>
<p>To ensure that the two columns are indeed identical, a visual check may be prone to overlooking small differences. To perform a more precise comparison, you can use the <code><a href="https://rdrr.io/r/base/all.html">all()</a></code> function to check if the data aligns (here, evaluated at the five decimal points using <code><a href="https://rdrr.io/r/base/Round.html">round()</a></code>). By comparing the two columns in this manner, you can confirm whether they are identical or not.</p>
<div class="sourceCode" id="cb373"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># round values at 5 decimal</span></span>
<span><span class="va">eps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">eps</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">error</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">error</span>, <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># eps == error return "TRUE" or "FALSE"</span></span>
<span><span class="co"># all() returns TRUE if all elements meet eps == error</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">eps</span> <span class="op">==</span> <span class="va">error</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="visualize-errors" class="section level3" number="12.3.2">
<h3>
<span class="header-section-number">12.3.2</span> Visualize Errors<a class="anchor" aria-label="anchor" href="#visualize-errors"><i class="fas fa-link"></i></a>
</h3>
<p>To visualize the errors or residuals, which represent the distance from the best-fitted line to each data point, you can make use of the <code><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment()</a></code> function:</p>
<div class="sourceCode" id="cb375"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># add error column</span></span>
<span><span class="va">df_algae</span> <span class="op">&lt;-</span> <span class="va">df_algae</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>eps <span class="op">=</span> <span class="va">eps</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df_algae</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">conductivity</span>,</span>
<span>             y <span class="op">=</span> <span class="va">biomass</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>              slope <span class="op">=</span> <span class="va">beta</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">conductivity</span>, <span class="co"># start-coord x</span></span>
<span>                   xend <span class="op">=</span> <span class="va">conductivity</span>, <span class="co"># end-coord x</span></span>
<span>                   y <span class="op">=</span> <span class="va">biomass</span>, <span class="co"># start-coord y</span></span>
<span>                   yend <span class="op">=</span> <span class="va">biomass</span> <span class="op">-</span> <span class="va">eps</span><span class="op">)</span>, <span class="co"># end-coord y</span></span>
<span>               linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:geom-errors"></span>
<img src="biostats_files/figure-html/geom-errors-1.png" alt="Vertical segments indicate errors." width="672"><p class="caption">
Figure 12.4: Vertical segments indicate errors.
</p>
</div>
</div>
<div id="coefficient-of-determination" class="section level3" number="12.3.3">
<h3>
<span class="header-section-number">12.3.3</span> Coefficient of Determination<a class="anchor" aria-label="anchor" href="#coefficient-of-determination"><i class="fas fa-link"></i></a>
</h3>
<p>One crucial motivation for developing a regression model, or any statistical model, is to assess the extent to which the explanatory variable (<span class="math inline">\(x_i\)</span>) explains the variation in the response variable (<span class="math inline">\(y_i\)</span>). By fitting a regression model, we can quantify the amount of variability in the response variable that can be attributed to the explanatory variable. This assessment provides valuable insights into the strength and significance of the relationship between the variables under consideration.</p>
<p>The <strong>coefficient of determination</strong>, denoted as R², is a statistical measure that assesses the proportion of the variance in the response variable that can be explained by the explanatory variable(s) in a regression model. It provides an indication of how well the regression model fits the observed data. The formula for R² is:</p>
<p><span class="math display">\[
\text{R}^2 = 1 - \frac{SS}{SS_0}
\]</span></p>
<p>where <span class="math inline">\(SS\)</span> is the summed squares of residuals (<span class="math inline">\(\sum_i \varepsilon_i^2\)</span>), and <span class="math inline">\(SS_0\)</span> is the summed squares of the response variable (<span class="math inline">\(SS_0 = \sum_i(y_i - \hat{\mu}_y)^2\)</span>). The term <span class="math inline">\(\frac{SS}{SS_0}\)</span> represents the proportion of variability “unexplained” – therefore, <span class="math inline">\(1 - \frac{SS}{SS_0}\)</span> gives the proportion of variability “explained.” R² is a value between 0 and 1. An R² value of 0 indicates that the explanatory variable(s) cannot explain any of the variability in the response variable, while an R² value of 1 indicates that the explanatory variable(s) can fully explain the variability in the response variable.</p>
<p>While R<sup>2</sup> is provided as a default output of <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>, let’s confirm if the above equation reproduces the reported value:</p>
<div class="sourceCode" id="cb376"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># residual variance</span></span>
<span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">resid</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># null variance</span></span>
<span><span class="va">ss_0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">v_y</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">v_y</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># coefficient of determination</span></span>
<span><span class="va">r2</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">ss</span> <span class="op">/</span> <span class="va">ss_0</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">r2</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.8890251</code></pre>
<p>Compare it with <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> output:</p>
<div class="sourceCode" id="cb378"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = biomass ~ conductivity, data = df_algae)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.5578 -2.8729 -0.7307  2.5479 11.4700 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   5.29647    1.57178    3.37  0.00149 ** 
## conductivity  0.50355    0.02568   19.61  &lt; 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 4.649 on 48 degrees of freedom
## Multiple R-squared:  0.889,  Adjusted R-squared:  0.8867 
## F-statistic: 384.5 on 1 and 48 DF,  p-value: &lt; 2.2e-16</code></pre>
<p><code>Multiple R-squared:</code> corresponds to the calculated coefficient of determination.</p>
</div>
</div>
<div id="laboratory-5" class="section level2" number="12.4">
<h2>
<span class="header-section-number">12.4</span> Laboratory<a class="anchor" aria-label="anchor" href="#laboratory-5"><i class="fas fa-link"></i></a>
</h2>
<div id="develop-regression-models" class="section level3" number="12.4.1">
<h3>
<span class="header-section-number">12.4.1</span> Develop regression models<a class="anchor" aria-label="anchor" href="#develop-regression-models"><i class="fas fa-link"></i></a>
</h3>
<p>R provides a built-in data set called <code>iris</code>. The <code>iris</code> data contain data points from three different species (<code>Species</code> column). Split this data set by species (create three separate data frames) and perform regression for each species separately to analyze the relationship between <code>Sepal.Width</code> (response variable) and <code>Petal.Width</code> (explanatory variable).</p>
<div class="sourceCode" id="cb380"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
</div>
<div id="multiple-explanatory-variables" class="section level3" number="12.4.2">
<h3>
<span class="header-section-number">12.4.2</span> Multiple explanatory variables<a class="anchor" aria-label="anchor" href="#multiple-explanatory-variables"><i class="fas fa-link"></i></a>
</h3>
<p>Regression analysis can involve multiple explanatory variables. To explore this, consider utilizing <code>Petal.Length</code> as an additional explanatory variable for each species. Then, investigate (1) the variations in estimates of regression coefficients and (2) the differences in the coefficients of determination compared to the model with only a single explanatory variable.</p>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="multiple-group-comparison.html"><span class="header-section-number">11</span> Multiple-Group Comparison</a></div>
<div class="next"><a href="linear-model.html"><span class="header-section-number">13</span> Linear Model</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#regression"><span class="header-section-number">12</span> Regression</a></li>
<li><a class="nav-link" href="#explore-data-structure-1"><span class="header-section-number">12.1</span> Explore Data Structure</a></li>
<li>
<a class="nav-link" href="#drawing-the-fittest-line"><span class="header-section-number">12.2</span> Drawing the “fittest” line</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#linear-formula"><span class="header-section-number">12.2.1</span> Linear formula</a></li>
<li><a class="nav-link" href="#minimizing-the-errors"><span class="header-section-number">12.2.2</span> Minimizing the errors</a></li>
<li><a class="nav-link" href="#least-squares"><span class="header-section-number">12.2.3</span> Least Squares</a></li>
<li><a class="nav-link" href="#standard-errors-and-t-values"><span class="header-section-number">12.2.4</span> Standard Errors and t-values</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#unexplained-variation"><span class="header-section-number">12.3</span> Unexplained Variation</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#retrieve-errors"><span class="header-section-number">12.3.1</span> Retrieve Errors</a></li>
<li><a class="nav-link" href="#visualize-errors"><span class="header-section-number">12.3.2</span> Visualize Errors</a></li>
<li><a class="nav-link" href="#coefficient-of-determination"><span class="header-section-number">12.3.3</span> Coefficient of Determination</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#laboratory-5"><span class="header-section-number">12.4</span> Laboratory</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#develop-regression-models"><span class="header-section-number">12.4.1</span> Develop regression models</a></li>
<li><a class="nav-link" href="#multiple-explanatory-variables"><span class="header-section-number">12.4.2</span> Multiple explanatory variables</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/aterui/biostats/blob/master/chapters/basics-06-regression.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/aterui/biostats/edit/master/chapters/basics-06-regression.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>BIOSTATS</strong>" was written by Akira Terui. It was last built on 2025-12-21.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
