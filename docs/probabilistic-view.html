<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 Probabilistic View | BIOSTATS</title>
<meta name="author" content="Akira Terui">
<meta name="description" content="Chapter 2 emphasized the concept of sampling and introduced the crucial aspect of statistics: randomness. Although the mean represents the central tendency of the data, it does not encompass all...">
<meta name="generator" content="bookdown 0.29 with bs4_book()">
<meta property="og:title" content="Chapter 3 Probabilistic View | BIOSTATS">
<meta property="og:type" content="book">
<meta property="og:url" content="https://bookdown.org/janedoe/bookdown-demo/probabilistic-view.html">
<meta property="og:description" content="Chapter 2 emphasized the concept of sampling and introduced the crucial aspect of statistics: randomness. Although the mean represents the central tendency of the data, it does not encompass all...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 3 Probabilistic View | BIOSTATS">
<meta name="twitter:description" content="Chapter 2 emphasized the concept of sampling and introduced the crucial aspect of statistics: randomness. Although the mean represents the central tendency of the data, it does not encompass all...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">BIOSTATS</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Introduction</a></li>
<li><a class="" href="descriptive-statistics.html"><span class="header-section-number">1</span> Descriptive Statistics</a></li>
<li><a class="" href="sampling.html"><span class="header-section-number">2</span> Sampling</a></li>
<li><a class="active" href="probabilistic-view.html"><span class="header-section-number">3</span> Probabilistic View</a></li>
<li><a class="" href="two-group-comparison.html"><span class="header-section-number">4</span> Two-Group Comparison</a></li>
<li><a class="" href="multiple-group-comparison.html"><span class="header-section-number">5</span> Multiple-Group Comparison</a></li>
<li><a class="" href="regression.html"><span class="header-section-number">6</span> Regression</a></li>
<li><a class="" href="linear-model.html"><span class="header-section-number">7</span> Linear Model</a></li>
<li><a class="" href="generalized-linear-model.html"><span class="header-section-number">8</span> Generalized Linear Model</a></li>
<li><a class="" href="likelihood.html"><span class="header-section-number">9</span> Likelihood</a></li>
<li><a class="" href="model-comparison.html"><span class="header-section-number">10</span> Model Comparison</a></li>
<li><a class="" href="appendix-project.html">Appendix: Project</a></li>
<li><a class="" href="appendix-git-github.html">Appendix: Git &amp; GitHub</a></li>
<li><a class="" href="appendix-data-structure.html">Appendix: Data Structure</a></li>
<li><a class="" href="appendix-tidyverse.html">Appendix: Tidyverse</a></li>
<li><a class="" href="appendix-base-plot.html">Appendix: Base Plot</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/aterui/biostats">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="probabilistic-view" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Probabilistic View<a class="anchor" aria-label="anchor" href="#probabilistic-view"><i class="fas fa-link"></i></a>
</h1>
<p>Chapter <a href="sampling.html#sampling">2</a> emphasized the concept of sampling and introduced the crucial aspect of statistics: randomness. Although the mean represents the central tendency of the data, it does not encompass all the data points. Inevitable deviations occur, and we need a way to express this “randomness.” The concept of probability distributions aids in fully understanding the stochastic nature of observed data.</p>
<p><strong>Key words:</strong> probability density function (PDF), probability mass function (PMF), expected value</p>
<div id="continuous-variable" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Continuous Variable<a class="anchor" aria-label="anchor" href="#continuous-variable"><i class="fas fa-link"></i></a>
</h2>
<div id="probability-density-function" class="section level3" number="3.1.1">
<h3>
<span class="header-section-number">3.1.1</span> Probability Density Function<a class="anchor" aria-label="anchor" href="#probability-density-function"><i class="fas fa-link"></i></a>
</h3>
<p>Let me use the plant height example in Chapter <a href="sampling.html#sampling">2</a>:</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load csv data on R</span></span>
<span><span class="va">df_h0</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data_raw/data_plant_height.csv"</span><span class="op">)</span></span></code></pre></div>
<p>While Chapter <a href="sampling.html#sampling">2</a> primarily focused on exploring mean and variance, let’s broaden our perspective to gain a comprehensive understanding of the entire distribution of height.</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_h0</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">height</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="co"># specify binwidth</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">height</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># draw vertical line at the mean</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:histogram-height"></span>
<img src="biostats_files/figure-html/histogram-height-1.png" alt="Distribution of plant height" width="672"><p class="caption">
Figure 3.1: Distribution of plant height
</p>
</div>
<p>This distribution comprises a thousand height measurements. However, there are certain patterns to consider. The data is centered around the mean and exhibits a symmetrical distribution. This characteristic implies that the distribution can be approximated by a simple formula that relies on only a few <em>key parameters</em>.</p>
<p>In statistics, the symmetrical bell-shaped form is commonly approximated by a Normal distribution, often denoted as “<em>variable</em> <span class="math inline">\(x\)</span> <em>is assumed to follow a Normal distribution.</em>” We express this using the following mathematical expression:</p>
<p><span class="math display">\[
x \sim \mbox{Normal}(\mu, \sigma^2)
\]</span></p>
<p>Unlike an “equation,” we do not use the “<span class="math inline">\(=\)</span>” sign because variable <span class="math inline">\(x\)</span> is not equivalent to the Normal distribution. Rather, it represents a “stochastic” relationship that signifies the probability of <span class="math inline">\(x\)</span> taking on a specific range of values.</p>
<p>A Normal distribution is characterized by two parameters: the mean and the variance. Strictly speaking, the terms “mean” and “variance” in a probability distribution differ from “sample mean” and “sample variance,” although they converge when the variable <span class="math inline">\(x\)</span> is assumed to follow a Normal distribution (refer to Chapter <a href="likelihood.html#likelihood">9</a> for more details). More precisely, the mean is referred to as the “expected value” and is denoted as <span class="math inline">\(\mbox{E}(x)\)</span>. The variance represents the expected value of <span class="math inline">\(x^2\)</span> and is denoted as <span class="math inline">\(\mbox{E}(x^2)\)</span>. <strong>The expected value serves as the central tendency of a random variable, indicating where values are most likely to occur.</strong> On the other hand, <strong>the variance quantifies the extent to which individual data points deviate from this expected value</strong>. Although I use the terms mean and variance for simplicity, it is important to recognize the distinction.</p>
<p>Once these parameters are determined, the formula that defines the Normal distribution will yield the probability density for a given range of values. This formula <span class="math inline">\(f(x)\)</span> is known as the <strong>probability density function (PDF)</strong> and is displayed below:</p>
<p><span class="math display">\[
f(x) = \frac{1}{\sqrt{2 \pi} \sigma} \exp\left(-\frac{(x-\mu)^2}{2\sigma^2}\right)
\]</span></p>
<p>Well, understanding the meaning of a formula can be challenging without context. However, visualization can be a useful tool to help comprehend mathematical expressions.</p>
</div>
<div id="pdf-to-frequency-distribution" class="section level3" number="3.1.2">
<h3>
<span class="header-section-number">3.1.2</span> PDF to frequency distribution<a class="anchor" aria-label="anchor" href="#pdf-to-frequency-distribution"><i class="fas fa-link"></i></a>
</h3>
<p>In R, the function <code><a href="https://rdrr.io/r/stats/Normal.html">dnorm()</a></code> can be used to calculate the probability density for a given value. The first argument, <code>x</code>, should be a vector of values for which you want to calculate the probability density. The second argument, <code>mean</code>, and the third argument, <code>sd</code>, correspond to the mean and standard deviation of the distribution, respectively. Note that we must provide <code>mean</code> and <code>sd</code> to calculate the probability density.</p>
<p>To encompass the entire range of observed heights, we can use <span class="math inline">\(\text{min}(x)\)</span> and <span class="math inline">\(\text{max}(x)\)</span> as the lower and upper limits, respectively.</p>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># vector of x values</span></span>
<span><span class="co"># seq() generate min to max values with specified numbers of elements or interval</span></span>
<span><span class="co"># the following produce 100 elements</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">df_h0</span><span class="op">$</span><span class="va">height</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">df_h0</span><span class="op">$</span><span class="va">height</span><span class="op">)</span>, length <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate probability density</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df_h0</span><span class="op">$</span><span class="va">height</span><span class="op">)</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">df_h0</span><span class="op">$</span><span class="va">height</span><span class="op">)</span></span>
<span><span class="va">pd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="va">mu</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># figure</span></span>
<span><span class="fu">tibble</span><span class="op">(</span>y <span class="op">=</span> <span class="va">pd</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># data frame</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># draw lines</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Probability density"</span><span class="op">)</span> <span class="co"># re-label</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:dnorm"></span>
<img src="biostats_files/figure-html/dnorm-1.png" alt="Probability density function of a Normal distribution" width="672"><p class="caption">
Figure 3.2: Probability density function of a Normal distribution
</p>
</div>
<p>The shape of the curve appears quite similar to what we observed; however, the scale of the y-axis is different. This is because the y-axis represents “probability density.” To convert it into actual “probability,” we need to calculate the area under the curve. In R, we can utilize the <code><a href="https://rdrr.io/r/stats/Normal.html">pnorm()</a></code> function for this purpose. It calculates the probability of a variable being less than the specified value, which is provided in the first argument <code>q</code>.</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># probability of x &lt; 10</span></span>
<span><span class="va">p10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span>q <span class="op">=</span> <span class="fl">10</span>, mean <span class="op">=</span> <span class="va">mu</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p10</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.02731905</code></pre>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># probability of x &lt; 20</span></span>
<span><span class="va">p20</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span>q <span class="op">=</span> <span class="fl">20</span>, mean <span class="op">=</span> <span class="va">mu</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p20</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.504426</code></pre>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># probability of 10 &lt; x &lt; 20</span></span>
<span><span class="va">p20_10</span> <span class="op">&lt;-</span> <span class="va">p20</span> <span class="op">-</span> <span class="va">p10</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p20_10</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.4771069</code></pre>
<p>To make the estimates comparable to the frequency data, you can calculate the probability for each 1 cm bin. The expected frequency can be obtained by multiplying the probability by the sample size, which in this case is 1000. This allows you to estimate the number of observations you would expect in each 1 cm bin based on the calculated probabilities.</p>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x_min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">floor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">df_h0</span><span class="op">$</span><span class="va">height</span><span class="op">)</span><span class="op">)</span> <span class="co"># floor takes the integer part of the value</span></span>
<span><span class="va">x_max</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">df_h0</span><span class="op">$</span><span class="va">height</span><span class="op">)</span><span class="op">)</span> <span class="co"># ceiling takes the next closest integer</span></span>
<span><span class="va">bin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="va">x_min</span>, <span class="va">x_max</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># each bin has 1cm</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="cn">NULL</span> <span class="co"># empty object for probability</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">bin</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="va">bin</span><span class="op">[</span><span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span>, mean <span class="op">=</span> <span class="va">mu</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="va">bin</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, mean <span class="op">=</span> <span class="va">mu</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># data frame for probability</span></span>
<span><span class="co"># bin: last element [-length(bin)] was removed to match length</span></span>
<span><span class="co"># expected frequency in each bin is "prob times sample size"</span></span>
<span><span class="va">df_prob</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span><span class="va">p</span>, bin <span class="op">=</span> <span class="va">bin</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">bin</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>freq <span class="op">=</span> <span class="va">p</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df_h0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Overlay:</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_h0</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">height</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_prob</span>,</span>
<span>             <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">freq</span>,</span>
<span>                 x <span class="op">=</span> <span class="va">bin</span><span class="op">)</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"salmon"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_prob</span>,</span>
<span>            <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">freq</span>,</span>
<span>                x <span class="op">=</span> <span class="va">bin</span><span class="op">)</span>,</span>
<span>            color <span class="op">=</span> <span class="st">"salmon"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:histogram-overlaid"></span>
<img src="biostats_files/figure-html/histogram-overlaid-1.png" alt="Histogram overlaid with predicted frequency (red dots and line)" width="672"><p class="caption">
Figure 3.3: Histogram overlaid with predicted frequency (red dots and line)
</p>
</div>
<p>It is remarkable that the probability distribution, characterized by just two parameters (mean and variance), can effectively reproduce the overall shape observed in the original data set of 1000 data points. This is great news because it means that once we determine these key parameters, we can infer the general pattern of the data.</p>
</div>
</div>
<div id="discrete-variable" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Discrete Variable<a class="anchor" aria-label="anchor" href="#discrete-variable"><i class="fas fa-link"></i></a>
</h2>
<div id="probability-mass-function" class="section level3" number="3.2.1">
<h3>
<span class="header-section-number">3.2.1</span> Probability Mass Function<a class="anchor" aria-label="anchor" href="#probability-mass-function"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s shift our perspective and examine the density of plants in the garden. For this analysis, we have counted the number of plant individuals within 30 plots, with each plot covering an area of one square meter (refer to Figure <a href="probabilistic-view.html#fig:garden">3.4</a>).</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:garden"></span>
<img src="image/figure_garden.jpg" alt="Garden view with sampling plots. White squares represent plots. Red dots indicate plant individuals counted." width="600"><p class="caption">
Figure 3.4: Garden view with sampling plots. White squares represent plots. Red dots indicate plant individuals counted.
</p>
</div>
<p>Download the data <a href="https://github.com/aterui/biostats/blob/master/data_raw/data_garden_count.csv">here</a> and load it onto R:</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_count</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data_raw/data_garden_count.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">df_count</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 30 × 3
##     plot count nitrate
##    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1     1     1    14.6
##  2     2     4    32.6
##  3     3     6    29.3
##  4     4     4    30.4
##  5     5     7    34.1
##  6     6     2    26.6
##  7     7     2    30.2
##  8     8     2    28.7
##  9     9     3    32.5
## 10    10     2    26  
## # ℹ 20 more rows</code></pre>
<p>Make a histogram:</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_count</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.5</span>, <span class="co"># define binwidth</span></span>
<span>                 center <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># relative position of each bin</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:hist-density"></span>
<img src="biostats_files/figure-html/hist-density-1.png" alt="Histogram of plant individuals per plot" width="672"><p class="caption">
Figure 3.5: Histogram of plant individuals per plot
</p>
</div>
<p>There are several significant differences compared to the plant height example when considering the density of plants in the garden:</p>
<ol style="list-style-type: decimal">
<li><p>The possible values are discrete (count data) since we are counting the number of plant individuals in each plot.</p></li>
<li><p>The possible values are always positive, as counts cannot be negative.</p></li>
<li><p>The distribution appears to be non-symmetric around the sample mean.</p></li>
</ol>
<p>Given these characteristics, a Normal distribution may not be an appropriate choice for representing such a variable. Instead, it would be more suitable to use a Poisson distribution to characterize the observed distribution of the discrete variable.</p>
<p><span class="math display">\[
x \sim \mbox{Poisson}(\lambda)
\]</span></p>
<p>In a Poisson distribution, the mean parameter (<span class="math inline">\(\lambda\)</span>) serves as the sole parameter<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;In a Poisson distribution, mean = variance&lt;/p&gt;"><sup>1</sup></a>. Probability distributions that describe discrete variables are expressed using a <strong>probability mass function</strong> (PMF):</p>
<p><span class="math display">\[
g(x) = \frac{\lambda^x \exp(-\lambda)}{x!}
\]</span></p>
<p>Unlike a probability density function (PDF), a probability mass function (PMF) represents the probability of a discrete variable <span class="math inline">\(x\)</span> taking a specific value. For instance, the probability of <span class="math inline">\(x=2\)</span>, denoted as <span class="math inline">\(\Pr(x=2)\)</span>, can be calculated as follows:</p>
<p><span class="math display">\[
\Pr(x=2) = g(2) = \frac{\lambda^2 \exp(-\lambda)}{2!}
\]</span></p>
<p>In a generalized form, we write:</p>
<p><span class="math display">\[
\Pr(x=k) = g(k) = \frac{\lambda^k \exp(-\lambda)}{k!}
\]</span></p>
</div>
<div id="pmf-to-frequency-distribution" class="section level3" number="3.2.2">
<h3>
<span class="header-section-number">3.2.2</span> PMF to frequency distribution<a class="anchor" aria-label="anchor" href="#pmf-to-frequency-distribution"><i class="fas fa-link"></i></a>
</h3>
<p>In R, you can use the <code><a href="https://rdrr.io/r/stats/Poisson.html">dpois()</a></code> function to visualize a Poisson distribution. This function allows you to plot the probability mass function (PMF) of the Poisson distribution and gain insights into the distribution of the discrete variable. In the given example, I utilize the sample mean as an estimate for <span class="math inline">\(\lambda\)</span> — a somewhat counter-intuitive approach since <span class="math inline">\(x\)</span> does not conform to a Normal distribution. However, I will delve into a detailed explanation in Chapter <a href="likelihood.html#likelihood">9</a>, allowing me to assume its validity for the time being.</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># vector of x values</span></span>
<span><span class="co"># create a vector of 0 to 10 with an interval one</span></span>
<span><span class="co"># must be integer of &gt; 0</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate probability mass</span></span>
<span><span class="va">lambda_hat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df_count</span><span class="op">$</span><span class="va">count</span><span class="op">)</span></span>
<span><span class="va">pm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">dpois</a></span><span class="op">(</span><span class="va">x</span>, lambda <span class="op">=</span> <span class="va">lambda_hat</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># figure</span></span>
<span><span class="fu">tibble</span><span class="op">(</span>y <span class="op">=</span> <span class="va">pm</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># data frame</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span> <span class="co"># draw dashed lines</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># draw points</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="st">"Probability"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span> <span class="co"># re-label</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:dpois"></span>
<img src="biostats_files/figure-html/dpois-1.png" alt="Example of a Poisson distribution" width="672"><p class="caption">
Figure 3.6: Example of a Poisson distribution
</p>
</div>
<p>To convert the y-axis from probability to frequency, multiply the probabilities by the sample size (total number of observations) to obtain the expected frequency. As in the plant height example, you can plot the expected frequency on the histogram, providing a visual representation of the distribution of the discrete variable.</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_prob</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">pm</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>freq <span class="op">=</span> <span class="va">y</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df_count</span><span class="op">)</span><span class="op">)</span> <span class="co"># prob x sample size</span></span>
<span></span>
<span><span class="va">df_count</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                 center <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_prob</span>,</span>
<span>            <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>,</span>
<span>                y <span class="op">=</span> <span class="va">freq</span><span class="op">)</span>,</span>
<span>            linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_prob</span>,</span>
<span>             <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>,</span>
<span>                y <span class="op">=</span> <span class="va">freq</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:pois-hist"></span>
<img src="biostats_files/figure-html/pois-hist-1.png" alt="Observed histogram of the discrete variable overlaid with the Poisson expectation." width="672"><p class="caption">
Figure 3.7: Observed histogram of the discrete variable overlaid with the Poisson expectation.
</p>
</div>
<p>Cool, the Poisson distribution does an excellent job of characterizing the distribution of plant counts.</p>
</div>
</div>
<div id="why-probability-distributions" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Why Probability Distributions?<a class="anchor" aria-label="anchor" href="#why-probability-distributions"><i class="fas fa-link"></i></a>
</h2>
<p>As we have seen in the above examples, probability distributions provide a framework for describing the likelihood of different outcomes or events. By utilizing probability distributions, we can:</p>
<ol style="list-style-type: decimal">
<li>Make predictions and estimate probabilities of specific events or ranges of values.</li>
<li>Determine the most likely values or outcomes based on available information.</li>
<li>Quantify and analyze the uncertainty associated with random variables or processes.</li>
</ol>
<p>Probability distributions serve as fundamental tools in statistics, enabling us to model, analyze, and make informed decisions in the face of uncertainty.</p>
</div>
<div id="laboratory-2" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Laboratory<a class="anchor" aria-label="anchor" href="#laboratory-2"><i class="fas fa-link"></i></a>
</h2>
<div id="normal-distribution" class="section level3" number="3.4.1">
<h3>
<span class="header-section-number">3.4.1</span> Normal Distribution<a class="anchor" aria-label="anchor" href="#normal-distribution"><i class="fas fa-link"></i></a>
</h3>
<p>The function <code><a href="https://rdrr.io/r/stats/Normal.html">rnorm()</a></code> produces a random variable that follows a Normal distribution with a specified mean and SD. Using this function,</p>
<ol style="list-style-type: decimal">
<li>Generate a variable with 50 observations.</li>
<li>Create a figure similar to Figure <a href="probabilistic-view.html#fig:histogram-overlaid">3.3</a>
</li>
</ol>
</div>
<div id="poisson-distribution" class="section level3" number="3.4.2">
<h3>
<span class="header-section-number">3.4.2</span> Poisson Distribution<a class="anchor" aria-label="anchor" href="#poisson-distribution"><i class="fas fa-link"></i></a>
</h3>
<p>The function <code><a href="https://rdrr.io/r/stats/Poisson.html">rpois()</a></code> produces a random variable that follows a Poisson distribution with a specified mean. Using this function,</p>
<ol style="list-style-type: decimal">
<li>Generate a variable with 1000 observations.</li>
<li>Create a figure similar to Figure <a href="probabilistic-view.html#fig:pois-hist">3.7</a>
</li>
</ol>
</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="sampling.html"><span class="header-section-number">2</span> Sampling</a></div>
<div class="next"><a href="two-group-comparison.html"><span class="header-section-number">4</span> Two-Group Comparison</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#probabilistic-view"><span class="header-section-number">3</span> Probabilistic View</a></li>
<li>
<a class="nav-link" href="#continuous-variable"><span class="header-section-number">3.1</span> Continuous Variable</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#probability-density-function"><span class="header-section-number">3.1.1</span> Probability Density Function</a></li>
<li><a class="nav-link" href="#pdf-to-frequency-distribution"><span class="header-section-number">3.1.2</span> PDF to frequency distribution</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#discrete-variable"><span class="header-section-number">3.2</span> Discrete Variable</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#probability-mass-function"><span class="header-section-number">3.2.1</span> Probability Mass Function</a></li>
<li><a class="nav-link" href="#pmf-to-frequency-distribution"><span class="header-section-number">3.2.2</span> PMF to frequency distribution</a></li>
</ul>
</li>
<li><a class="nav-link" href="#why-probability-distributions"><span class="header-section-number">3.3</span> Why Probability Distributions?</a></li>
<li>
<a class="nav-link" href="#laboratory-2"><span class="header-section-number">3.4</span> Laboratory</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#normal-distribution"><span class="header-section-number">3.4.1</span> Normal Distribution</a></li>
<li><a class="nav-link" href="#poisson-distribution"><span class="header-section-number">3.4.2</span> Poisson Distribution</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/aterui/biostats/blob/master/chapters/03-probability.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/aterui/biostats/edit/master/chapters/03-probability.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>BIOSTATS</strong>" was written by Akira Terui. It was last built on 2023-08-01.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
