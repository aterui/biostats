<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Generalized Linear Model | BIOSTATS</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Generalized Linear Model | BIOSTATS" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Generalized Linear Model | BIOSTATS" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Akira Terui" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="linear-model.html"/>
<link rel="next" href="appendix-project-management.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BIOSTATS</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html"><i class="fa fa-check"></i><b>1</b> Descriptive Statistics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#central-tendency"><i class="fa fa-check"></i><b>1.1</b> Central Tendency</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>1.1.1</b> Measures of Central Tendency</a></li>
<li class="chapter" data-level="1.1.2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#r-exercise"><i class="fa fa-check"></i><b>1.1.2</b> R Exercise</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#variation"><i class="fa fa-check"></i><b>1.2</b> Variation</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#measures-of-variation"><i class="fa fa-check"></i><b>1.2.1</b> Measures of Variation</a></li>
<li class="chapter" data-level="1.2.2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#r-exercise-1"><i class="fa fa-check"></i><b>1.2.2</b> R Exercise</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#laboratory"><i class="fa fa-check"></i><b>1.3</b> Laboratory</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#comparing-central-tendency-measures"><i class="fa fa-check"></i><b>1.3.1</b> Comparing Central Tendency Measures</a></li>
<li class="chapter" data-level="1.3.2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#comparing-variation-measures"><i class="fa fa-check"></i><b>1.3.2</b> Comparing Variation Measures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="sampling.html"><a href="sampling.html"><i class="fa fa-check"></i><b>2</b> Sampling</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sampling.html"><a href="sampling.html#the-unknown-garden-plant-example"><i class="fa fa-check"></i><b>2.1</b> The Unknown: Garden Plant Example</a></li>
<li class="chapter" data-level="2.2" data-path="sampling.html"><a href="sampling.html#linking-part-to-the-whole"><i class="fa fa-check"></i><b>2.2</b> Linking Part to the Whole</a></li>
<li class="chapter" data-level="2.3" data-path="sampling.html"><a href="sampling.html#laboratory-1"><i class="fa fa-check"></i><b>2.3</b> Laboratory</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="probabilistic-view.html"><a href="probabilistic-view.html"><i class="fa fa-check"></i><b>3</b> Probabilistic View</a>
<ul>
<li class="chapter" data-level="3.1" data-path="probabilistic-view.html"><a href="probabilistic-view.html#probability-distribution-of-a-continuous-variable"><i class="fa fa-check"></i><b>3.1</b> Probability Distribution of a Continuous Variable</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="probabilistic-view.html"><a href="probabilistic-view.html#probability-density-function"><i class="fa fa-check"></i><b>3.1.1</b> Probability Density Function</a></li>
<li class="chapter" data-level="3.1.2" data-path="probabilistic-view.html"><a href="probabilistic-view.html#pdf-to-frequency-distribution"><i class="fa fa-check"></i><b>3.1.2</b> PDF to frequency distribution</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="probabilistic-view.html"><a href="probabilistic-view.html#probability-distribution-of-a-discrete-variable"><i class="fa fa-check"></i><b>3.2</b> Probability Distribution of a Discrete Variable</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="probabilistic-view.html"><a href="probabilistic-view.html#probability-mass-function"><i class="fa fa-check"></i><b>3.2.1</b> Probability Mass Function</a></li>
<li class="chapter" data-level="3.2.2" data-path="probabilistic-view.html"><a href="probabilistic-view.html#pmf-to-frequency-distribution"><i class="fa fa-check"></i><b>3.2.2</b> PMF to frequency distribution</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="probabilistic-view.html"><a href="probabilistic-view.html#why-probability-distributions"><i class="fa fa-check"></i><b>3.3</b> Why Probability Distributions?</a></li>
<li class="chapter" data-level="3.4" data-path="probabilistic-view.html"><a href="probabilistic-view.html#laboratory-2"><i class="fa fa-check"></i><b>3.4</b> Laboratory</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="probabilistic-view.html"><a href="probabilistic-view.html#normal-distribution"><i class="fa fa-check"></i><b>3.4.1</b> Normal Distribution</a></li>
<li class="chapter" data-level="3.4.2" data-path="probabilistic-view.html"><a href="probabilistic-view.html#poisson-distribution"><i class="fa fa-check"></i><b>3.4.2</b> Poisson Distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="two-group-comparison.html"><a href="two-group-comparison.html"><i class="fa fa-check"></i><b>4</b> Two-Group Comparison</a>
<ul>
<li class="chapter" data-level="4.1" data-path="two-group-comparison.html"><a href="two-group-comparison.html#explore-data-structure"><i class="fa fa-check"></i><b>4.1</b> Explore Data Structure</a></li>
<li class="chapter" data-level="4.2" data-path="two-group-comparison.html"><a href="two-group-comparison.html#test-statistic"><i class="fa fa-check"></i><b>4.2</b> Test Statistic</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="two-group-comparison.html"><a href="two-group-comparison.html#t-statistic"><i class="fa fa-check"></i><b>4.2.1</b> t-statistic</a></li>
<li class="chapter" data-level="4.2.2" data-path="two-group-comparison.html"><a href="two-group-comparison.html#null-hypothesis"><i class="fa fa-check"></i><b>4.2.2</b> Null Hypothesis</a></li>
<li class="chapter" data-level="4.2.3" data-path="two-group-comparison.html"><a href="two-group-comparison.html#interpretation"><i class="fa fa-check"></i><b>4.2.3</b> Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="two-group-comparison.html"><a href="two-group-comparison.html#t-test-in-r"><i class="fa fa-check"></i><b>4.3</b> t-test in R</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="two-group-comparison.html"><a href="two-group-comparison.html#t-test-with-equal-variance"><i class="fa fa-check"></i><b>4.3.1</b> t-test with equal variance</a></li>
<li class="chapter" data-level="4.3.2" data-path="two-group-comparison.html"><a href="two-group-comparison.html#t-test-with-unequal-variance"><i class="fa fa-check"></i><b>4.3.2</b> t-test with unequal variance</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="two-group-comparison.html"><a href="two-group-comparison.html#laboratory-3"><i class="fa fa-check"></i><b>4.4</b> Laboratory</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multiple-group-comparison.html"><a href="multiple-group-comparison.html"><i class="fa fa-check"></i><b>5</b> Multiple-Group Comparison</a>
<ul>
<li class="chapter" data-level="5.1" data-path="multiple-group-comparison.html"><a href="multiple-group-comparison.html#partition-the-variability"><i class="fa fa-check"></i><b>5.1</b> Partition the Variability</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="multiple-group-comparison.html"><a href="multiple-group-comparison.html#between-group-variability"><i class="fa fa-check"></i><b>5.1.1</b> Between-group variability</a></li>
<li class="chapter" data-level="5.1.2" data-path="multiple-group-comparison.html"><a href="multiple-group-comparison.html#within-group-variability"><i class="fa fa-check"></i><b>5.1.2</b> Within-group variability</a></li>
<li class="chapter" data-level="5.1.3" data-path="multiple-group-comparison.html"><a href="multiple-group-comparison.html#variability-to-variance"><i class="fa fa-check"></i><b>5.1.3</b> Variability to Variance</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="multiple-group-comparison.html"><a href="multiple-group-comparison.html#test-statistic-1"><i class="fa fa-check"></i><b>5.2</b> Test Statistic</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="multiple-group-comparison.html"><a href="multiple-group-comparison.html#f-statistic"><i class="fa fa-check"></i><b>5.2.1</b> F-statistic</a></li>
<li class="chapter" data-level="5.2.2" data-path="multiple-group-comparison.html"><a href="multiple-group-comparison.html#null-hypothesis-1"><i class="fa fa-check"></i><b>5.2.2</b> Null Hypothesis</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="multiple-group-comparison.html"><a href="multiple-group-comparison.html#anova-in-r"><i class="fa fa-check"></i><b>5.3</b> ANOVA in R</a></li>
<li class="chapter" data-level="5.4" data-path="multiple-group-comparison.html"><a href="multiple-group-comparison.html#post-hoc-tests"><i class="fa fa-check"></i><b>5.4</b> Post-hoc Tests</a></li>
<li class="chapter" data-level="5.5" data-path="multiple-group-comparison.html"><a href="multiple-group-comparison.html#laboratory-4"><i class="fa fa-check"></i><b>5.5</b> Laboratory</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>6</b> Regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="regression.html"><a href="regression.html#explore-data-structure-1"><i class="fa fa-check"></i><b>6.1</b> Explore Data Structure</a></li>
<li class="chapter" data-level="6.2" data-path="regression.html"><a href="regression.html#drawing-the-fittest-line"><i class="fa fa-check"></i><b>6.2</b> Drawing the “fittest” line</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="regression.html"><a href="regression.html#linear-formula"><i class="fa fa-check"></i><b>6.2.1</b> Linear formula</a></li>
<li class="chapter" data-level="6.2.2" data-path="regression.html"><a href="regression.html#minimizing-the-errors"><i class="fa fa-check"></i><b>6.2.2</b> Minimizing the errors</a></li>
<li class="chapter" data-level="6.2.3" data-path="regression.html"><a href="regression.html#least-squares"><i class="fa fa-check"></i><b>6.2.3</b> Least Squares</a></li>
<li class="chapter" data-level="6.2.4" data-path="regression.html"><a href="regression.html#standard-errors-and-t-values"><i class="fa fa-check"></i><b>6.2.4</b> Standard Errors and t-values</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="regression.html"><a href="regression.html#unexplained-variation"><i class="fa fa-check"></i><b>6.3</b> Unexplained Variation</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="regression.html"><a href="regression.html#retrieve-errors"><i class="fa fa-check"></i><b>6.3.1</b> Retrieve Errors</a></li>
<li class="chapter" data-level="6.3.2" data-path="regression.html"><a href="regression.html#visualize-errors"><i class="fa fa-check"></i><b>6.3.2</b> Visualize Errors</a></li>
<li class="chapter" data-level="6.3.3" data-path="regression.html"><a href="regression.html#coefficient-of-determination"><i class="fa fa-check"></i><b>6.3.3</b> Coefficient of Determination</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="regression.html"><a href="regression.html#laboratory-5"><i class="fa fa-check"></i><b>6.4</b> Laboratory</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="linear-model.html"><a href="linear-model.html"><i class="fa fa-check"></i><b>7</b> Linear Model</a>
<ul>
<li class="chapter" data-level="7.1" data-path="linear-model.html"><a href="linear-model.html#the-frame"><i class="fa fa-check"></i><b>7.1</b> The Frame</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="linear-model.html"><a href="linear-model.html#two-group-case"><i class="fa fa-check"></i><b>7.1.1</b> Two-Group Case</a></li>
<li class="chapter" data-level="7.1.2" data-path="linear-model.html"><a href="linear-model.html#multiple-group-case"><i class="fa fa-check"></i><b>7.1.2</b> Multiple-Group Case</a></li>
<li class="chapter" data-level="7.1.3" data-path="linear-model.html"><a href="linear-model.html#the-common-structure"><i class="fa fa-check"></i><b>7.1.3</b> The Common Structure</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="linear-model.html"><a href="linear-model.html#combine-multiple-types-of-variables"><i class="fa fa-check"></i><b>7.2</b> Combine Multiple Types of Variables</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="linear-model.html"><a href="linear-model.html#iris-example"><i class="fa fa-check"></i><b>7.2.1</b> <code>iris</code> Example</a></li>
<li class="chapter" data-level="7.2.2" data-path="linear-model.html"><a href="linear-model.html#variable-types"><i class="fa fa-check"></i><b>7.2.2</b> Variable Types</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="linear-model.html"><a href="linear-model.html#laboratory-6"><i class="fa fa-check"></i><b>7.3</b> Laboratory</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html"><i class="fa fa-check"></i><b>8</b> Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="8.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#count-data"><i class="fa fa-check"></i><b>8.1</b> Count Data</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#plant-density"><i class="fa fa-check"></i><b>8.1.1</b> Plant Density</a></li>
<li class="chapter" data-level="8.1.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#poisson-model"><i class="fa fa-check"></i><b>8.1.2</b> Poisson Model</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#proportional-data"><i class="fa fa-check"></i><b>8.2</b> Proportional Data</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#mussel-egg-fertilization"><i class="fa fa-check"></i><b>8.2.1</b> Mussel Egg Fertilization</a></li>
<li class="chapter" data-level="8.2.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#binomial-model"><i class="fa fa-check"></i><b>8.2.2</b> Binomial Model</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#the-glm-framework"><i class="fa fa-check"></i><b>8.3</b> The GLM Framework</a></li>
<li class="chapter" data-level="8.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#laboratory-7"><i class="fa fa-check"></i><b>8.4</b> Laboratory</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="appendix-project-management.html"><a href="appendix-project-management.html"><i class="fa fa-check"></i><b>9</b> Appendix: Project Management</a>
<ul>
<li class="chapter" data-level="9.1" data-path="appendix-project-management.html"><a href="appendix-project-management.html#r-project"><i class="fa fa-check"></i><b>9.1</b> R Project</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="appendix-project-management.html"><a href="appendix-project-management.html#script-editor"><i class="fa fa-check"></i><b>9.1.1</b> Script Editor</a></li>
<li class="chapter" data-level="9.1.2" data-path="appendix-project-management.html"><a href="appendix-project-management.html#file-name"><i class="fa fa-check"></i><b>9.1.2</b> File Name</a></li>
<li class="chapter" data-level="9.1.3" data-path="appendix-project-management.html"><a href="appendix-project-management.html#structure-your-project"><i class="fa fa-check"></i><b>9.1.3</b> Structure Your Project</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="appendix-project-management.html"><a href="appendix-project-management.html#robust-coding"><i class="fa fa-check"></i><b>9.2</b> Robust coding</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="appendix-git-github.html"><a href="appendix-git-github.html"><i class="fa fa-check"></i><b>10</b> Appendix: Git &amp; GitHub</a>
<ul>
<li class="chapter" data-level="10.1" data-path="appendix-git-github.html"><a href="appendix-git-github.html#git-github"><i class="fa fa-check"></i><b>10.1</b> Git &amp; GitHub</a></li>
<li class="chapter" data-level="10.2" data-path="appendix-git-github.html"><a href="appendix-git-github.html#commit-push"><i class="fa fa-check"></i><b>10.2</b> Commit &amp; Push</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="appendix-git-github.html"><a href="appendix-git-github.html#register-your-git-repo"><i class="fa fa-check"></i><b>10.2.1</b> Register Your Git repo</a></li>
<li class="chapter" data-level="10.2.2" data-path="appendix-git-github.html"><a href="appendix-git-github.html#commit"><i class="fa fa-check"></i><b>10.2.2</b> Commit</a></li>
<li class="chapter" data-level="10.2.3" data-path="appendix-git-github.html"><a href="appendix-git-github.html#push"><i class="fa fa-check"></i><b>10.2.3</b> Push</a></li>
<li class="chapter" data-level="10.2.4" data-path="appendix-git-github.html"><a href="appendix-git-github.html#edit"><i class="fa fa-check"></i><b>10.2.4</b> Edit</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html"><i class="fa fa-check"></i><b>11</b> Appendix: Data Structure</a>
<ul>
<li class="chapter" data-level="11.1" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#overview"><i class="fa fa-check"></i><b>11.1</b> Overview</a></li>
<li class="chapter" data-level="11.2" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#vector"><i class="fa fa-check"></i><b>11.2</b> Vector</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#create-vector"><i class="fa fa-check"></i><b>11.2.1</b> Create Vector</a></li>
<li class="chapter" data-level="11.2.2" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#check-features"><i class="fa fa-check"></i><b>11.2.2</b> Check Features</a></li>
<li class="chapter" data-level="11.2.3" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#access"><i class="fa fa-check"></i><b>11.2.3</b> Access</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#matrix"><i class="fa fa-check"></i><b>11.3</b> Matrix</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#create-matrix"><i class="fa fa-check"></i><b>11.3.1</b> Create Matrix</a></li>
<li class="chapter" data-level="11.3.2" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#check-features-1"><i class="fa fa-check"></i><b>11.3.2</b> Check Features</a></li>
<li class="chapter" data-level="11.3.3" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#access-1"><i class="fa fa-check"></i><b>11.3.3</b> Access</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#data-frame"><i class="fa fa-check"></i><b>11.4</b> Data Frame</a></li>
<li class="chapter" data-level="11.5" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#exercise"><i class="fa fa-check"></i><b>11.5</b> Exercise</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#vector-1"><i class="fa fa-check"></i><b>11.5.1</b> Vector</a></li>
<li class="chapter" data-level="11.5.2" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#matrix-1"><i class="fa fa-check"></i><b>11.5.2</b> Matrix</a></li>
<li class="chapter" data-level="11.5.3" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#data-frame-1"><i class="fa fa-check"></i><b>11.5.3</b> Data Frame</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html"><i class="fa fa-check"></i><b>12</b> Appendix: Tidyverse</a>
<ul>
<li class="chapter" data-level="12.1" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#overview-1"><i class="fa fa-check"></i><b>12.1</b> Overview</a></li>
<li class="chapter" data-level="12.2" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#data-manipulation"><i class="fa fa-check"></i><b>12.2</b> Data Manipulation</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#data-format"><i class="fa fa-check"></i><b>12.2.1</b> Data Format</a></li>
<li class="chapter" data-level="12.2.2" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#row-manipulation"><i class="fa fa-check"></i><b>12.2.2</b> Row Manipulation</a></li>
<li class="chapter" data-level="12.2.3" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#column-manipulation"><i class="fa fa-check"></i><b>12.2.3</b> Column Manipulation</a></li>
<li class="chapter" data-level="12.2.4" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#piping"><i class="fa fa-check"></i><b>12.2.4</b> Piping</a></li>
<li class="chapter" data-level="12.2.5" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#reshape"><i class="fa fa-check"></i><b>12.2.5</b> Reshape</a></li>
<li class="chapter" data-level="12.2.6" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#group-operation"><i class="fa fa-check"></i><b>12.2.6</b> Group Operation</a></li>
<li class="chapter" data-level="12.2.7" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#join"><i class="fa fa-check"></i><b>12.2.7</b> Join</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#visualization"><i class="fa fa-check"></i><b>12.3</b> Visualization</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#point"><i class="fa fa-check"></i><b>12.3.1</b> Point</a></li>
<li class="chapter" data-level="12.3.2" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#line"><i class="fa fa-check"></i><b>12.3.2</b> Line</a></li>
<li class="chapter" data-level="12.3.3" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#histogram"><i class="fa fa-check"></i><b>12.3.3</b> Histogram</a></li>
<li class="chapter" data-level="12.3.4" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#boxplot"><i class="fa fa-check"></i><b>12.3.4</b> Boxplot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html"><i class="fa fa-check"></i><b>13</b> Appendix: Base Plot</a>
<ul>
<li class="chapter" data-level="13.1" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html#overview-2"><i class="fa fa-check"></i><b>13.1</b> Overview</a></li>
<li class="chapter" data-level="13.2" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html#plot"><i class="fa fa-check"></i><b>13.2</b> Plot</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html#symbol"><i class="fa fa-check"></i><b>13.2.1</b> Symbol</a></li>
<li class="chapter" data-level="13.2.2" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html#symbol-size"><i class="fa fa-check"></i><b>13.2.2</b> Symbol size</a></li>
<li class="chapter" data-level="13.2.3" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html#symbol-color-border"><i class="fa fa-check"></i><b>13.2.3</b> Symbol color (border)</a></li>
<li class="chapter" data-level="13.2.4" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html#symbol-color-fill"><i class="fa fa-check"></i><b>13.2.4</b> Symbol color (fill)</a></li>
<li class="chapter" data-level="13.2.5" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html#label"><i class="fa fa-check"></i><b>13.2.5</b> Label</a></li>
<li class="chapter" data-level="13.2.6" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html#axis"><i class="fa fa-check"></i><b>13.2.6</b> Axis</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html#boxplot-1"><i class="fa fa-check"></i><b>13.3</b> Boxplot</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html#box-color"><i class="fa fa-check"></i><b>13.3.1</b> Box color</a></li>
<li class="chapter" data-level="13.3.2" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html#border-color"><i class="fa fa-check"></i><b>13.3.2</b> Border color</a></li>
<li class="chapter" data-level="13.3.3" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html#box-width"><i class="fa fa-check"></i><b>13.3.3</b> Box width</a></li>
<li class="chapter" data-level="13.3.4" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html#axis-1"><i class="fa fa-check"></i><b>13.3.4</b> Axis</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BIOSTATS</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="generalized-linear-model" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Generalized Linear Model<a href="generalized-linear-model.html#generalized-linear-model" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>One of the key assumptions in the Linear Model framework is Normality – that the error term follows a normal distribution (Chapter <a href="linear-model.html#linear-model">7</a>). However, this assumption frequently leads to situations where models predict unrealistic values for a response variable. In this chapter, I will introduce the Generalized Linear Model (GLM) framework, which enables more flexible modeling.</p>
<div id="count-data" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Count Data<a href="generalized-linear-model.html#count-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="plant-density" class="section level3 hasAnchor" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Plant Density<a href="generalized-linear-model.html#plant-density" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recall our data set of garden plant counts (Chapter <a href="probabilistic-view.html#probabilistic-view">3</a>):</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:garden-recall"></span>
<img src="image/figure_garden.jpg" alt="Garden view with sampling plots. White squares represent plots. Red dots indicate plant individuals counted." width="600" />
<p class="caption">
Figure 8.1: Garden view with sampling plots. White squares represent plots. Red dots indicate plant individuals counted.
</p>
</div>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="generalized-linear-model.html#cb203-1" aria-hidden="true" tabindex="-1"></a>df_count <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data_raw/data_garden_count.csv&quot;</span>)</span>
<span id="cb203-2"><a href="generalized-linear-model.html#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df_count)</span></code></pre></div>
<pre><code>## # A tibble: 30 × 3
##     plot count nitrate
##    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1     1     1    14.6
##  2     2     4    32.6
##  3     3     6    29.3
##  4     4     4    30.4
##  5     5     7    34.1
##  6     6     2    26.6
##  7     7     2    30.2
##  8     8     2    28.7
##  9     9     3    32.5
## 10    10     2    26  
## # ℹ 20 more rows</code></pre>
<p>The variable of plant count had the following characteristics:</p>
<ol style="list-style-type: decimal">
<li><p>The possible values are discrete (count data) since we are counting the number of plant individuals in each plot.</p></li>
<li><p>The possible values are always positive, as counts cannot be negative.</p></li>
<li><p>The distribution appears to be non-symmetric around the sample mean.</p></li>
</ol>
<p>What happens if we apply a simple linear model that assumes a Normal distribution? Let me model the plant count as a function of nitrate as follows:</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\sim \text{Normal}(\mu_i, \sigma^2)\\
\mu_i &amp;= \alpha + \beta~\text{nitrate}_i
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="generalized-linear-model.html#cb205-1" aria-hidden="true" tabindex="-1"></a>m_normal <span class="ot">&lt;-</span> <span class="fu">lm</span>(count <span class="sc">~</span> nitrate,</span>
<span id="cb205-2"><a href="generalized-linear-model.html#cb205-2" aria-hidden="true" tabindex="-1"></a>               df_count)</span>
<span id="cb205-3"><a href="generalized-linear-model.html#cb205-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb205-4"><a href="generalized-linear-model.html#cb205-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_normal)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = count ~ nitrate, data = df_count)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.9084 -0.9000 -0.2572  0.6134  3.0316 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -5.90545    1.42516  -4.144 0.000285 ***
## nitrate      0.30286    0.05105   5.933 2.19e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.291 on 28 degrees of freedom
## Multiple R-squared:  0.557,  Adjusted R-squared:  0.5411 
## F-statistic:  35.2 on 1 and 28 DF,  p-value: 2.193e-06</code></pre>
<p>This seems satisfactory, but an anomalous behavior occurs during the plotting process on the figure. Plot the data and the predicted values together.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="generalized-linear-model.html#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract estimates</span></span>
<span id="cb207-2"><a href="generalized-linear-model.html#cb207-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fu">coef</span>(m_normal)[<span class="dv">1</span>] <span class="co"># intercept</span></span>
<span id="cb207-3"><a href="generalized-linear-model.html#cb207-3" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="fu">coef</span>(m_normal)[<span class="dv">2</span>] <span class="co"># slope</span></span>
<span id="cb207-4"><a href="generalized-linear-model.html#cb207-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-5"><a href="generalized-linear-model.html#cb207-5" aria-hidden="true" tabindex="-1"></a>df_count <span class="sc">%&gt;%</span> </span>
<span id="cb207-6"><a href="generalized-linear-model.html#cb207-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> nitrate,</span>
<span id="cb207-7"><a href="generalized-linear-model.html#cb207-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb207-8"><a href="generalized-linear-model.html#cb207-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb207-9"><a href="generalized-linear-model.html#cb207-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> alpha,</span>
<span id="cb207-10"><a href="generalized-linear-model.html#cb207-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">slope =</span> beta)</span></code></pre></div>
<p><img src="biostats_files/figure-html/unnamed-chunk-59-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The intersection of the predicted line with the x-axis suggests the presence of negative predicted values for plant counts. However, it is logically implausible for plant counts to be negative.</p>
<p>This occurrence stems from the nature of the model employed.</p>
<ol style="list-style-type: decimal">
<li>In the Linear Model with a Normal error distribution, we allow the mean to encompass a wide range of values, including negative values.</li>
<li>Even when the mean predicted values do not intersect the x-axis, we consider the possibility of observations taking negative values, as dictated by the nature of a Normal distribution (<span class="math inline">\(\mu_i + \varepsilon_i\)</span> can be negative even when <span class="math inline">\(\mu_i &gt; 0\)</span>), which in reality can never occur.</li>
</ol>
</div>
<div id="poisson-model" class="section level3 hasAnchor" number="8.1.2">
<h3><span class="header-section-number">8.1.2</span> Poisson Model<a href="generalized-linear-model.html#poisson-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One possible approach is to consider the assumption that the error term follows a Poisson distribution. For the purpose of this discussion, let’s assume that a model based on the Poisson distribution is appropriate. Unlike a Normal distribution, the Poisson distribution generates only non-negative discrete values, which makes it a suitable fit for the plant count variable. To incorporate this, we can make the following modifications to the model:</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\sim \text{Poisson}(\lambda_i)\\
\log\lambda_i &amp;= \alpha + \beta~\text{nitrate}_i
\end{aligned}
\]</span></p>
<p>These changes are crucial:</p>
<ol style="list-style-type: decimal">
<li>The plant count, denoted as <span class="math inline">\(y_i\)</span>, is now assumed to follow a Poisson distribution with parameter <span class="math inline">\(\lambda_i\)</span>. This ensures that negative values of <span class="math inline">\(y_i\)</span> are not possible (i.e., <span class="math inline">\(\Pr(y_i &lt; 0) = 0\)</span>).</li>
<li>The mean <span class="math inline">\(\lambda_i\)</span> is log-transformed when expressing it as a function of nitrate. Given that the mean of a Poisson distribution cannot be negative, we must restrict the range of <span class="math inline">\(\lambda_i\)</span> to positive values. The log-transformation guarantees positivity of <span class="math inline">\(\lambda_i\)</span> (<span class="math inline">\(\lambda_i = \exp(\alpha + \beta~\text{nitrate}_i)\)</span>) irrespective of the values of <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span>, and <span class="math inline">\(\text{nitrate}_i\)</span>.</li>
</ol>
<p>The implementation of the Poisson model is quite simple. In the following example, we will use the function <code>glm()</code>:</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="generalized-linear-model.html#cb208-1" aria-hidden="true" tabindex="-1"></a>m_pois <span class="ot">&lt;-</span> <span class="fu">glm</span>(count <span class="sc">~</span> nitrate,</span>
<span id="cb208-2"><a href="generalized-linear-model.html#cb208-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> df_count,</span>
<span id="cb208-3"><a href="generalized-linear-model.html#cb208-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="st">&quot;poisson&quot;</span>)</span></code></pre></div>
<p>The major difference from <code>lm()</code> is the argument <code>family = "poisson"</code>. This argument specifies the probability distribution to be used; in this example, I used a Poisson distribution to model count data. However, in looking at estimates…</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="generalized-linear-model.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_pois)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = count ~ nitrate, family = &quot;poisson&quot;, data = df_count)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.6799  -0.5862  -0.1217   0.3250   1.8272  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -4.04899    1.05326  -3.844 0.000121 ***
## nitrate      0.17028    0.03467   4.911 9.06e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 48.598  on 29  degrees of freedom
## Residual deviance: 19.073  on 28  degrees of freedom
## AIC: 93.858
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>The estimated intercept is still negative…what’s wrong? No sweat, we estimated these parameters in a log scale; this result translates into:</p>
<p><span class="math display">\[
\lambda_i = \exp(-4.05 + 0.17~\text{nitrate}_i)
\]</span></p>
<p>Therefore, even when the intercept is estimated to be negative, the mean <span class="math inline">\(\lambda_i\)</span> is guaranteed to be non-negative.</p>
<p>Another important difference from <code>lm()</code> is that the test-statistic is no long the t-statistic – instead, <code>glm()</code> reports the z-statistic. However, the z-statistic is very similar to the t-statistic, defined as <span class="math inline">\(z=\frac{\hat{\theta} - \theta_0}{\text{SE}(\hat{\theta})}\)</span> (<span class="math inline">\(\hat{\theta} = \{\hat{\alpha}, \hat{\beta}\}\)</span>, <span class="math inline">\(\theta_0 = 0\)</span>). Therefore, you can reproduce the z-statistic by dividing the parameter estimates (<span class="math inline">\(\hat{\alpha}\)</span> and <span class="math inline">\(\hat{\beta}\)</span>) by their standard errors:</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="generalized-linear-model.html#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># parameter estimates and their SEs</span></span>
<span id="cb211-2"><a href="generalized-linear-model.html#cb211-2" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">coef</span>(m_pois)</span>
<span id="cb211-3"><a href="generalized-linear-model.html#cb211-3" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">diag</span>(<span class="fu">vcov</span>(m_pois)))</span>
<span id="cb211-4"><a href="generalized-linear-model.html#cb211-4" aria-hidden="true" tabindex="-1"></a>z_value <span class="ot">&lt;-</span> theta <span class="sc">/</span> se</span>
<span id="cb211-5"><a href="generalized-linear-model.html#cb211-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-6"><a href="generalized-linear-model.html#cb211-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(z_value)</span></code></pre></div>
<pre><code>## (Intercept)     nitrate 
##   -3.844229    4.910935</code></pre>
<p>We call this statistic “z-statistic” as it is known to follow the z-distribution (also known as the standardized Normal distribution <span class="math inline">\(\text{Normal}(0, 1)\)</span>), as opposed to the Student’s t-distribution. The reported p-value (<code>Pr(&gt;|z|)</code>) is estimated under this assumption, which can be seen as follows.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="generalized-linear-model.html#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># estimate Pr(&gt;|z|) using a standardized normal distribution</span></span>
<span id="cb213-2"><a href="generalized-linear-model.html#cb213-2" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(z_value), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb213-3"><a href="generalized-linear-model.html#cb213-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_value)</span></code></pre></div>
<pre><code>##  (Intercept)      nitrate 
## 1.209323e-04 9.064303e-07</code></pre>
<p>Let’s visualize the difference between the Normal and Poisson models (Figure <a href="generalized-linear-model.html#fig:normal-pois">8.2</a>). Clearly, the Poisson model does a better job.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="generalized-linear-model.html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make predictions</span></span>
<span id="cb215-2"><a href="generalized-linear-model.html#cb215-2" aria-hidden="true" tabindex="-1"></a>df_pred <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">nitrate =</span> <span class="fu">seq</span>(<span class="fu">min</span>(df_count<span class="sc">$</span>nitrate),</span>
<span id="cb215-3"><a href="generalized-linear-model.html#cb215-3" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">max</span>(df_count<span class="sc">$</span>nitrate),</span>
<span id="cb215-4"><a href="generalized-linear-model.html#cb215-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">length =</span> <span class="dv">100</span>))</span>
<span id="cb215-5"><a href="generalized-linear-model.html#cb215-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-6"><a href="generalized-linear-model.html#cb215-6" aria-hidden="true" tabindex="-1"></a><span class="co"># y_pois is exponentiated because predict() returns values in log-scale</span></span>
<span id="cb215-7"><a href="generalized-linear-model.html#cb215-7" aria-hidden="true" tabindex="-1"></a>y_normal <span class="ot">&lt;-</span> <span class="fu">predict</span>(m_normal, <span class="at">newdata =</span> df_pred)</span>
<span id="cb215-8"><a href="generalized-linear-model.html#cb215-8" aria-hidden="true" tabindex="-1"></a>y_pois <span class="ot">&lt;-</span> <span class="fu">predict</span>(m_pois, <span class="at">newdata =</span> df_pred) <span class="sc">%&gt;%</span> <span class="fu">exp</span>()</span>
<span id="cb215-9"><a href="generalized-linear-model.html#cb215-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-10"><a href="generalized-linear-model.html#cb215-10" aria-hidden="true" tabindex="-1"></a>df_pred <span class="ot">&lt;-</span> df_pred <span class="sc">%&gt;%</span> </span>
<span id="cb215-11"><a href="generalized-linear-model.html#cb215-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(y_normal,</span>
<span id="cb215-12"><a href="generalized-linear-model.html#cb215-12" aria-hidden="true" tabindex="-1"></a>         y_pois)</span>
<span id="cb215-13"><a href="generalized-linear-model.html#cb215-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-14"><a href="generalized-linear-model.html#cb215-14" aria-hidden="true" tabindex="-1"></a><span class="co"># figure</span></span>
<span id="cb215-15"><a href="generalized-linear-model.html#cb215-15" aria-hidden="true" tabindex="-1"></a>df_count <span class="sc">%&gt;%</span> </span>
<span id="cb215-16"><a href="generalized-linear-model.html#cb215-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> nitrate,</span>
<span id="cb215-17"><a href="generalized-linear-model.html#cb215-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb215-18"><a href="generalized-linear-model.html#cb215-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb215-19"><a href="generalized-linear-model.html#cb215-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df_pred,</span>
<span id="cb215-20"><a href="generalized-linear-model.html#cb215-20" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> y_normal),</span>
<span id="cb215-21"><a href="generalized-linear-model.html#cb215-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb215-22"><a href="generalized-linear-model.html#cb215-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df_pred,</span>
<span id="cb215-23"><a href="generalized-linear-model.html#cb215-23" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> y_pois),</span>
<span id="cb215-24"><a href="generalized-linear-model.html#cb215-24" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&quot;salmon&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:normal-pois"></span>
<img src="biostats_files/figure-html/normal-pois-1.png" alt="Comparison of the predicted values between Normal (broken, black) and Poisson models (solid, red)." width="672" />
<p class="caption">
Figure 8.2: Comparison of the predicted values between Normal (broken, black) and Poisson models (solid, red).
</p>
</div>
</div>
</div>
<div id="proportional-data" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Proportional Data<a href="generalized-linear-model.html#proportional-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="mussel-egg-fertilization" class="section level3 hasAnchor" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Mussel Egg Fertilization<a href="generalized-linear-model.html#mussel-egg-fertilization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There is another type of data for which a Normal distribution is not suitable - proportional data. Let’s consider an example dataset where an investigation was conducted on the number of fertilized eggs out of 30 eggs examined for 100 female freshwater mussels. You can download the dataset <a href="https://github.com/aterui/biostats/blob/master/data_raw/data_mussel.csv">here</a>.</p>
<p><img src="image/image_mussel.JPG" width="300" style="display: block; margin: auto;" /></p>
<p>Male freshwater mussels release sperm into the water, which is then drawn into female mussels downstream. Considering the nature of the fertilization process, female mussels are expected to have a higher probability of fertilization when they are surrounded by a greater number of males. To explore this relationship, the data can be loaded into R and visualized using a plot. By examining the data, we can observe the proportion of fertilized eggs based on the number of males. This visualization will provide insights into the impact of male presence on the fertilization process of female mussels.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="generalized-linear-model.html#cb216-1" aria-hidden="true" tabindex="-1"></a>df_mussel <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data_raw/data_mussel.csv&quot;</span>)</span>
<span id="cb216-2"><a href="generalized-linear-model.html#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df_mussel)</span></code></pre></div>
<pre><code>## # A tibble: 100 × 4
##    ind_id n_fertilized n_examined density
##     &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;
##  1      1            0         30       3
##  2      2            1         30      14
##  3      3            2         30      14
##  4      4            6         30      19
##  5      5            2         30      17
##  6      6            0         30       8
##  7      7            4         30      19
##  8      8            0         30      11
##  9      9            0         30       7
## 10     10            0         30       7
## # ℹ 90 more rows</code></pre>
<p>This data frame contains variables such as <code>ind_id</code> (mussel individual ID), <code>n_fertilized</code> (number of fertilized eggs), <code>n_examined</code> (number of eggs examined), and <code>density</code> (number of mussels in a 1 m<span class="math inline">\(^2\)</span> quadrat). To visualize the relationship between the proportion of eggs fertilized and the density gradient, plot the proportion of fertilized eggs against the density gradient (Figure <a href="generalized-linear-model.html#fig:mussel-egg">8.3</a>).</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="generalized-linear-model.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the proportion of fertilized eggs</span></span>
<span id="cb218-2"><a href="generalized-linear-model.html#cb218-2" aria-hidden="true" tabindex="-1"></a>df_mussel <span class="ot">&lt;-</span> df_mussel <span class="sc">%&gt;%</span> </span>
<span id="cb218-3"><a href="generalized-linear-model.html#cb218-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop_fert =</span> n_fertilized <span class="sc">/</span> n_examined)</span>
<span id="cb218-4"><a href="generalized-linear-model.html#cb218-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-5"><a href="generalized-linear-model.html#cb218-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb218-6"><a href="generalized-linear-model.html#cb218-6" aria-hidden="true" tabindex="-1"></a>df_mussel <span class="sc">%&gt;%</span> </span>
<span id="cb218-7"><a href="generalized-linear-model.html#cb218-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> density,</span>
<span id="cb218-8"><a href="generalized-linear-model.html#cb218-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> prop_fert)) <span class="sc">+</span></span>
<span id="cb218-9"><a href="generalized-linear-model.html#cb218-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb218-10"><a href="generalized-linear-model.html#cb218-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Proportion of eggs fertilized&quot;</span>,</span>
<span id="cb218-11"><a href="generalized-linear-model.html#cb218-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Mussel density&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:mussel-egg"></span>
<img src="biostats_files/figure-html/mussel-egg-1.png" alt="Relationship between the proportion of fertilized eggs and mussel density in the surround." width="672" />
<p class="caption">
Figure 8.3: Relationship between the proportion of fertilized eggs and mussel density in the surround.
</p>
</div>
<p>In this example, the response variable, which represents the number of eggs fertilized, possesses the following characteristics:</p>
<ol style="list-style-type: decimal">
<li><p>Discreteness: The variable takes on discrete values rather than continuous ones.</p></li>
<li><p>Upper limit: The number of eggs fertilized is bounded by an upper limit (in this case, 30).</p></li>
</ol>
<p>The discrete nature of the variable might initially lead one to consider the Poisson distribution as a potential candidate. However, due to the presence of an upper limit where the number of fertilized eggs cannot exceed the number of eggs examined, the Poisson distribution is not a suitable option.</p>
</div>
<div id="binomial-model" class="section level3 hasAnchor" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Binomial Model<a href="generalized-linear-model.html#binomial-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A Binomial distribution is a natural and appropriate choice for modeling this variable. The Binomial distribution is characterized by two parameters: the number of trials (<span class="math inline">\(N\)</span>) and the probability of success (<span class="math inline">\(p\)</span>). Each trial has a certain probability of success, and the outcome of each trial is either assigned a value of 1 (indicating success) or 0 (indicating failure). In the given example, we can consider the “fertilization” as a successful outcome among the 30 trials. Consequently, the number of eggs fertilized (<span class="math inline">\(y_i\)</span>) for each individual mussel (<span class="math inline">\(i\)</span>) can be described as:</p>
<p><span class="math display">\[
y_i \sim \text{Binomial}(N_i, p_i)
\]</span></p>
<p>This formulation adequately captures the nature of the response variable, as the outcome of the Binomial distribution is constrained within the range of <span class="math inline">\(0\)</span> to <span class="math inline">\(N_i\)</span>, aligning with the upper limit imposed by the number of examined eggs.</p>
<p>Our prediction was that the fertilization probability <span class="math inline">\(p_i\)</span> would increase with increasing mussel’s density – how do we relate <span class="math inline">\(p_i\)</span> to mussel density? The value of <span class="math inline">\(p_i\)</span> must be constrained within a range of <span class="math inline">\(0.0-1.0\)</span> because it is a “probability.” Given this, the log-transformation, which we used in the Poisson model, is not a suitable choice. Instead, we can use a logit-transformation to convert the linear formula to fall within a range of <span class="math inline">\(0.0 - 1.0\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\sim \text{Binomial}(N_i, p_i)\\
\log(\frac{p_i}{1-p_i}) &amp;= \alpha + \beta~\text{density}_i
\end{aligned}
\]</span></p>
<p>The logit transformation, represented as <span class="math inline">\(\log\left(\frac{p_i}{1-p_i}\right)\)</span>, guarantees that the values of <span class="math inline">\(p_i\)</span> are confined within the range of 0.0 to 1.0. This relationship is expressed by the following equation:</p>
<p><span class="math display">\[
p_i = \frac{\exp(\alpha + \beta~\text{density}_i)}{1 + \exp(\alpha + \beta~\text{density}_i)}
\]</span></p>
<p>A straightforward coding can verify this.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="generalized-linear-model.html#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># x: produce 100 numbers from -100 to 100 (assume logit scale)</span></span>
<span id="cb219-2"><a href="generalized-linear-model.html#cb219-2" aria-hidden="true" tabindex="-1"></a><span class="co"># y: convert with inverse-logit transformation (ordinary scale)</span></span>
<span id="cb219-3"><a href="generalized-linear-model.html#cb219-3" aria-hidden="true" tabindex="-1"></a>df_test <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">logit_x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="at">length =</span> <span class="dv">100</span>),</span>
<span id="cb219-4"><a href="generalized-linear-model.html#cb219-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x =</span> <span class="fu">exp</span>(logit_x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(logit_x)))</span>
<span id="cb219-5"><a href="generalized-linear-model.html#cb219-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-6"><a href="generalized-linear-model.html#cb219-6" aria-hidden="true" tabindex="-1"></a>df_test <span class="sc">%&gt;%</span> </span>
<span id="cb219-7"><a href="generalized-linear-model.html#cb219-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> logit_x,</span>
<span id="cb219-8"><a href="generalized-linear-model.html#cb219-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> x)) <span class="sc">+</span></span>
<span id="cb219-9"><a href="generalized-linear-model.html#cb219-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb219-10"><a href="generalized-linear-model.html#cb219-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb219-11"><a href="generalized-linear-model.html#cb219-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb219-12"><a href="generalized-linear-model.html#cb219-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;logit(x)&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:logit-transform"></span>
<img src="biostats_files/figure-html/logit-transform-1.png" alt="Logit-transformation ensures that the transformed variable to fall in the range of zero to one." width="672" />
<p class="caption">
Figure 8.4: Logit-transformation ensures that the transformed variable to fall in the range of zero to one.
</p>
</div>
<p>The <code>glm()</code> function can be used to implement this modeling approach. However, certain modifications need to be made to the response variable in order to ensure compatibility with the binomial distribution.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="generalized-linear-model.html#cb220-1" aria-hidden="true" tabindex="-1"></a>m_binom <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">cbind</span>(n_fertilized, n_examined <span class="sc">-</span> n_fertilized) <span class="sc">~</span> density,</span>
<span id="cb220-2"><a href="generalized-linear-model.html#cb220-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> df_mussel,</span>
<span id="cb220-3"><a href="generalized-linear-model.html#cb220-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span></code></pre></div>
<p>In contrast to the Normal or Poisson models, the response variable was encoded using the <code>cbind(n_fertilized, n_examined - n_fertilized)</code> function. The <code>cbind()</code> function combines the number of successes (fertilized) and failures (not fertilized) into a single matrix. This approach allows for modeling the data using the binomial distribution, taking into account both the successes and the total number of trials within each observation.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="generalized-linear-model.html#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(df_mussel<span class="sc">$</span>n_fertilized, df_mussel<span class="sc">$</span>n_examined <span class="sc">-</span> df_mussel<span class="sc">$</span>n_fertilized) <span class="sc">%&gt;%</span> </span>
<span id="cb221-2"><a href="generalized-linear-model.html#cb221-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>##      [,1] [,2]
## [1,]    0   30
## [2,]    1   29
## [3,]    2   28
## [4,]    6   24
## [5,]    2   28
## [6,]    0   30</code></pre>
<p>Similar to the previous examples, the <code>summary()</code> function provides estimates of the model parameters. By applying the <code>summary()</code> function to the fitted model, you can obtain information such as coefficient estimates, standard errors, p-values, and other relevant statistics.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="generalized-linear-model.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_binom)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = cbind(n_fertilized, n_examined - n_fertilized) ~ 
##     density, family = &quot;binomial&quot;, data = df_mussel)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.4925  -0.6394  -0.3832  -0.0666   3.2751  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -8.06411    0.49944  -16.15   &lt;2e-16 ***
## density      0.34209    0.03077   11.12   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 233.752  on 99  degrees of freedom
## Residual deviance:  70.744  on 98  degrees of freedom
## AIC: 158.3
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>This result translates into:</p>
<p><span class="math display">\[
\begin{aligned}
y_i &amp;\sim \text{Binomial}(N_i, p_i)\\
\log(\frac{p_i}{1 - p_i}) &amp;= -8.06 + 0.34~\text{density}_i
\end{aligned}
\]</span></p>
<p>To make predictions, it is necessary to back-transform the predicted fertilization probability since it is estimated on a logit scale. The back-transformation will convert the predicted values back to the original probability scale (<span class="math inline">\(0.0-1.0\)</span>).</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="generalized-linear-model.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># make prediction</span></span>
<span id="cb225-2"><a href="generalized-linear-model.html#cb225-2" aria-hidden="true" tabindex="-1"></a>df_pred <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">density =</span> <span class="fu">seq</span>(<span class="fu">min</span>(df_mussel<span class="sc">$</span>density),</span>
<span id="cb225-3"><a href="generalized-linear-model.html#cb225-3" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">max</span>(df_mussel<span class="sc">$</span>density),</span>
<span id="cb225-4"><a href="generalized-linear-model.html#cb225-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">length =</span> <span class="dv">100</span>))</span>
<span id="cb225-5"><a href="generalized-linear-model.html#cb225-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-6"><a href="generalized-linear-model.html#cb225-6" aria-hidden="true" tabindex="-1"></a><span class="co"># y_binom is inv.logit-transformed because predict() returns values in logit-scale</span></span>
<span id="cb225-7"><a href="generalized-linear-model.html#cb225-7" aria-hidden="true" tabindex="-1"></a>y_binom <span class="ot">&lt;-</span> <span class="fu">predict</span>(m_binom, <span class="at">newdata =</span> df_pred) <span class="sc">%&gt;%</span> boot<span class="sc">::</span><span class="fu">inv.logit</span>()</span>
<span id="cb225-8"><a href="generalized-linear-model.html#cb225-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-9"><a href="generalized-linear-model.html#cb225-9" aria-hidden="true" tabindex="-1"></a>df_pred <span class="ot">&lt;-</span> df_pred <span class="sc">%&gt;%</span> </span>
<span id="cb225-10"><a href="generalized-linear-model.html#cb225-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(y_binom)</span></code></pre></div>
<p>Draw on the figure (Figure <a href="generalized-linear-model.html#fig:binom-fit-figure">8.5</a>).</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="generalized-linear-model.html#cb226-1" aria-hidden="true" tabindex="-1"></a>df_mussel <span class="sc">%&gt;%</span> </span>
<span id="cb226-2"><a href="generalized-linear-model.html#cb226-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> density,</span>
<span id="cb226-3"><a href="generalized-linear-model.html#cb226-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> prop_fert)) <span class="sc">+</span></span>
<span id="cb226-4"><a href="generalized-linear-model.html#cb226-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb226-5"><a href="generalized-linear-model.html#cb226-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df_pred,</span>
<span id="cb226-6"><a href="generalized-linear-model.html#cb226-6" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">y =</span> y_binom)) <span class="sc">+</span></span>
<span id="cb226-7"><a href="generalized-linear-model.html#cb226-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Proportion of eggs fertilized&quot;</span>,</span>
<span id="cb226-8"><a href="generalized-linear-model.html#cb226-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Mussel density&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:binom-fit-figure"></span>
<img src="biostats_files/figure-html/binom-fit-figure-1.png" alt="Prediction by the Binomial model." width="672" />
<p class="caption">
Figure 8.5: Prediction by the Binomial model.
</p>
</div>
<p>Perfect.</p>
</div>
</div>
<div id="the-glm-framework" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> The GLM Framework<a href="generalized-linear-model.html#the-glm-framework" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="laboratory-7" class="section level2 hasAnchor" number="8.4">
<h2><span class="header-section-number">8.4</span> Laboratory<a href="generalized-linear-model.html#laboratory-7" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linear-model.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="appendix-project-management.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/aterui/biostats/chapters/08-glm.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["biostats.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
