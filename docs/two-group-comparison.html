<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Two-Group Comparison | BIOSTATS</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Two-Group Comparison | BIOSTATS" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Two-Group Comparison | BIOSTATS" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Akira Terui" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="probabilistic-view.html"/>
<link rel="next" href="multiple-group-comparison.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BIOSTATS</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html"><i class="fa fa-check"></i><b>1</b> Descriptive Statistics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#central-tendency"><i class="fa fa-check"></i><b>1.1</b> Central Tendency</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>1.1.1</b> Measures of Central Tendency</a></li>
<li class="chapter" data-level="1.1.2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#r-exercise"><i class="fa fa-check"></i><b>1.1.2</b> R Exercise</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#variation"><i class="fa fa-check"></i><b>1.2</b> Variation</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#measures-of-variation"><i class="fa fa-check"></i><b>1.2.1</b> Measures of Variation</a></li>
<li class="chapter" data-level="1.2.2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#r-exercise-1"><i class="fa fa-check"></i><b>1.2.2</b> R Exercise</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#laboratory"><i class="fa fa-check"></i><b>1.3</b> Laboratory</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#comparing-central-tendency-measures"><i class="fa fa-check"></i><b>1.3.1</b> Comparing Central Tendency Measures</a></li>
<li class="chapter" data-level="1.3.2" data-path="descriptive-statistics.html"><a href="descriptive-statistics.html#comparing-variation-measures"><i class="fa fa-check"></i><b>1.3.2</b> Comparing Variation Measures</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="sampling.html"><a href="sampling.html"><i class="fa fa-check"></i><b>2</b> Sampling</a>
<ul>
<li class="chapter" data-level="2.1" data-path="sampling.html"><a href="sampling.html#the-unknown-garden-plant-example"><i class="fa fa-check"></i><b>2.1</b> The Unknown: Garden Plant Example</a></li>
<li class="chapter" data-level="2.2" data-path="sampling.html"><a href="sampling.html#linking-part-to-the-whole"><i class="fa fa-check"></i><b>2.2</b> Linking Part to the Whole</a></li>
<li class="chapter" data-level="2.3" data-path="sampling.html"><a href="sampling.html#laboratory-1"><i class="fa fa-check"></i><b>2.3</b> Laboratory</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="probabilistic-view.html"><a href="probabilistic-view.html"><i class="fa fa-check"></i><b>3</b> Probabilistic View</a>
<ul>
<li class="chapter" data-level="3.1" data-path="probabilistic-view.html"><a href="probabilistic-view.html#probability-distribution-of-a-continuous-variable"><i class="fa fa-check"></i><b>3.1</b> Probability Distribution of a Continuous Variable</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="probabilistic-view.html"><a href="probabilistic-view.html#probability-density-function"><i class="fa fa-check"></i><b>3.1.1</b> Probability Density Function</a></li>
<li class="chapter" data-level="3.1.2" data-path="probabilistic-view.html"><a href="probabilistic-view.html#pdf-to-frequency-distribution"><i class="fa fa-check"></i><b>3.1.2</b> PDF to frequency distribution</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="probabilistic-view.html"><a href="probabilistic-view.html#probability-distribution-of-a-discrete-variable"><i class="fa fa-check"></i><b>3.2</b> Probability Distribution of a Discrete Variable</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="probabilistic-view.html"><a href="probabilistic-view.html#probability-mass-function"><i class="fa fa-check"></i><b>3.2.1</b> Probability Mass Function</a></li>
<li class="chapter" data-level="3.2.2" data-path="probabilistic-view.html"><a href="probabilistic-view.html#pmf-to-frequency-distribution"><i class="fa fa-check"></i><b>3.2.2</b> PMF to frequency distribution</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="probabilistic-view.html"><a href="probabilistic-view.html#why-probability-distributions"><i class="fa fa-check"></i><b>3.3</b> Why Probability Distributions?</a></li>
<li class="chapter" data-level="3.4" data-path="probabilistic-view.html"><a href="probabilistic-view.html#laboratory-2"><i class="fa fa-check"></i><b>3.4</b> Laboratory</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="probabilistic-view.html"><a href="probabilistic-view.html#normal-distribution"><i class="fa fa-check"></i><b>3.4.1</b> Normal Distribution</a></li>
<li class="chapter" data-level="3.4.2" data-path="probabilistic-view.html"><a href="probabilistic-view.html#poisson-distribution"><i class="fa fa-check"></i><b>3.4.2</b> Poisson Distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="two-group-comparison.html"><a href="two-group-comparison.html"><i class="fa fa-check"></i><b>4</b> Two-Group Comparison</a>
<ul>
<li class="chapter" data-level="4.1" data-path="two-group-comparison.html"><a href="two-group-comparison.html#explore-data-structure"><i class="fa fa-check"></i><b>4.1</b> Explore Data Structure</a></li>
<li class="chapter" data-level="4.2" data-path="two-group-comparison.html"><a href="two-group-comparison.html#test-statistic"><i class="fa fa-check"></i><b>4.2</b> Test Statistic</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="two-group-comparison.html"><a href="two-group-comparison.html#t-statistic"><i class="fa fa-check"></i><b>4.2.1</b> t-statistic</a></li>
<li class="chapter" data-level="4.2.2" data-path="two-group-comparison.html"><a href="two-group-comparison.html#null-hypothesis"><i class="fa fa-check"></i><b>4.2.2</b> Null Hypothesis</a></li>
<li class="chapter" data-level="4.2.3" data-path="two-group-comparison.html"><a href="two-group-comparison.html#interpretation"><i class="fa fa-check"></i><b>4.2.3</b> Interpretation</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="two-group-comparison.html"><a href="two-group-comparison.html#t-test-in-r"><i class="fa fa-check"></i><b>4.3</b> t-test in R</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="two-group-comparison.html"><a href="two-group-comparison.html#t-test-with-equal-variance"><i class="fa fa-check"></i><b>4.3.1</b> t-test with equal variance</a></li>
<li class="chapter" data-level="4.3.2" data-path="two-group-comparison.html"><a href="two-group-comparison.html#t-test-with-unequal-variance"><i class="fa fa-check"></i><b>4.3.2</b> t-test with unequal variance</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="two-group-comparison.html"><a href="two-group-comparison.html#laboratory-3"><i class="fa fa-check"></i><b>4.4</b> Laboratory</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multiple-group-comparison.html"><a href="multiple-group-comparison.html"><i class="fa fa-check"></i><b>5</b> Multiple-Group Comparison</a>
<ul>
<li class="chapter" data-level="5.1" data-path="multiple-group-comparison.html"><a href="multiple-group-comparison.html#partition-the-variability"><i class="fa fa-check"></i><b>5.1</b> Partition the Variability</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="multiple-group-comparison.html"><a href="multiple-group-comparison.html#between-group-variability"><i class="fa fa-check"></i><b>5.1.1</b> Between-group variability</a></li>
<li class="chapter" data-level="5.1.2" data-path="multiple-group-comparison.html"><a href="multiple-group-comparison.html#within-group-variability"><i class="fa fa-check"></i><b>5.1.2</b> Within-group variability</a></li>
<li class="chapter" data-level="5.1.3" data-path="multiple-group-comparison.html"><a href="multiple-group-comparison.html#variability-to-variance"><i class="fa fa-check"></i><b>5.1.3</b> Variability to Variance</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="multiple-group-comparison.html"><a href="multiple-group-comparison.html#test-statistic-1"><i class="fa fa-check"></i><b>5.2</b> Test Statistic</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="multiple-group-comparison.html"><a href="multiple-group-comparison.html#f-statistic"><i class="fa fa-check"></i><b>5.2.1</b> F-statistic</a></li>
<li class="chapter" data-level="5.2.2" data-path="multiple-group-comparison.html"><a href="multiple-group-comparison.html#null-hypothesis-1"><i class="fa fa-check"></i><b>5.2.2</b> Null Hypothesis</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="multiple-group-comparison.html"><a href="multiple-group-comparison.html#anova-in-r"><i class="fa fa-check"></i><b>5.3</b> ANOVA in R</a></li>
<li class="chapter" data-level="5.4" data-path="multiple-group-comparison.html"><a href="multiple-group-comparison.html#post-hoc-tests"><i class="fa fa-check"></i><b>5.4</b> Post-hoc Tests</a></li>
<li class="chapter" data-level="5.5" data-path="multiple-group-comparison.html"><a href="multiple-group-comparison.html#laboratory-4"><i class="fa fa-check"></i><b>5.5</b> Laboratory</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>6</b> Regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="regression.html"><a href="regression.html#explore-data-structure-1"><i class="fa fa-check"></i><b>6.1</b> Explore Data Structure</a></li>
<li class="chapter" data-level="6.2" data-path="regression.html"><a href="regression.html#drawing-the-fittest-line"><i class="fa fa-check"></i><b>6.2</b> Drawing the “fittest” line</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="regression.html"><a href="regression.html#linear-formula"><i class="fa fa-check"></i><b>6.2.1</b> Linear formula</a></li>
<li class="chapter" data-level="6.2.2" data-path="regression.html"><a href="regression.html#minimizing-the-errors"><i class="fa fa-check"></i><b>6.2.2</b> Minimizing the errors</a></li>
<li class="chapter" data-level="6.2.3" data-path="regression.html"><a href="regression.html#least-squares"><i class="fa fa-check"></i><b>6.2.3</b> Least Squares</a></li>
<li class="chapter" data-level="6.2.4" data-path="regression.html"><a href="regression.html#standard-errors-and-t-values"><i class="fa fa-check"></i><b>6.2.4</b> Standard Errors and t-values</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="regression.html"><a href="regression.html#unexplained-variation"><i class="fa fa-check"></i><b>6.3</b> Unexplained Variation</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="regression.html"><a href="regression.html#retrieve-errors"><i class="fa fa-check"></i><b>6.3.1</b> Retrieve Errors</a></li>
<li class="chapter" data-level="6.3.2" data-path="regression.html"><a href="regression.html#visualize-errors"><i class="fa fa-check"></i><b>6.3.2</b> Visualize Errors</a></li>
<li class="chapter" data-level="6.3.3" data-path="regression.html"><a href="regression.html#coefficient-of-determination"><i class="fa fa-check"></i><b>6.3.3</b> Coefficient of Determination</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="regression.html"><a href="regression.html#laboratory-5"><i class="fa fa-check"></i><b>6.4</b> Laboratory</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="linear-model.html"><a href="linear-model.html"><i class="fa fa-check"></i><b>7</b> Linear Model</a>
<ul>
<li class="chapter" data-level="7.1" data-path="linear-model.html"><a href="linear-model.html#the-frame"><i class="fa fa-check"></i><b>7.1</b> The Frame</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="linear-model.html"><a href="linear-model.html#two-group-case"><i class="fa fa-check"></i><b>7.1.1</b> Two-Group Case</a></li>
<li class="chapter" data-level="7.1.2" data-path="linear-model.html"><a href="linear-model.html#multiple-group-case"><i class="fa fa-check"></i><b>7.1.2</b> Multiple-Group Case</a></li>
<li class="chapter" data-level="7.1.3" data-path="linear-model.html"><a href="linear-model.html#the-common-structure"><i class="fa fa-check"></i><b>7.1.3</b> The Common Structure</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="linear-model.html"><a href="linear-model.html#combine-multiple-types-of-variables"><i class="fa fa-check"></i><b>7.2</b> Combine Multiple Types of Variables</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="linear-model.html"><a href="linear-model.html#iris-example"><i class="fa fa-check"></i><b>7.2.1</b> <code>iris</code> Example</a></li>
<li class="chapter" data-level="7.2.2" data-path="linear-model.html"><a href="linear-model.html#variable-types"><i class="fa fa-check"></i><b>7.2.2</b> Variable Types</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="linear-model.html"><a href="linear-model.html#laboratory-6"><i class="fa fa-check"></i><b>7.3</b> Laboratory</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html"><i class="fa fa-check"></i><b>8</b> Generalized Linear Model</a>
<ul>
<li class="chapter" data-level="8.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#count-data"><i class="fa fa-check"></i><b>8.1</b> Count Data</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#plant-density"><i class="fa fa-check"></i><b>8.1.1</b> Plant Density</a></li>
<li class="chapter" data-level="8.1.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#poisson-model"><i class="fa fa-check"></i><b>8.1.2</b> Poisson Model</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#proportional-data"><i class="fa fa-check"></i><b>8.2</b> Proportional Data</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#mussel-egg-fertilization"><i class="fa fa-check"></i><b>8.2.1</b> Mussel Egg Fertilization</a></li>
<li class="chapter" data-level="8.2.2" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#binomial-model"><i class="fa fa-check"></i><b>8.2.2</b> Binomial Model</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#the-glm-framework"><i class="fa fa-check"></i><b>8.3</b> The GLM Framework</a></li>
<li class="chapter" data-level="8.4" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html#laboratory-7"><i class="fa fa-check"></i><b>8.4</b> Laboratory</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="appendix-project-management.html"><a href="appendix-project-management.html"><i class="fa fa-check"></i><b>9</b> Appendix: Project Management</a>
<ul>
<li class="chapter" data-level="9.1" data-path="appendix-project-management.html"><a href="appendix-project-management.html#r-project"><i class="fa fa-check"></i><b>9.1</b> R Project</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="appendix-project-management.html"><a href="appendix-project-management.html#script-editor"><i class="fa fa-check"></i><b>9.1.1</b> Script Editor</a></li>
<li class="chapter" data-level="9.1.2" data-path="appendix-project-management.html"><a href="appendix-project-management.html#file-name"><i class="fa fa-check"></i><b>9.1.2</b> File Name</a></li>
<li class="chapter" data-level="9.1.3" data-path="appendix-project-management.html"><a href="appendix-project-management.html#structure-your-project"><i class="fa fa-check"></i><b>9.1.3</b> Structure Your Project</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="appendix-project-management.html"><a href="appendix-project-management.html#robust-coding"><i class="fa fa-check"></i><b>9.2</b> Robust coding</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="appendix-git-github.html"><a href="appendix-git-github.html"><i class="fa fa-check"></i><b>10</b> Appendix: Git &amp; GitHub</a>
<ul>
<li class="chapter" data-level="10.1" data-path="appendix-git-github.html"><a href="appendix-git-github.html#git-github"><i class="fa fa-check"></i><b>10.1</b> Git &amp; GitHub</a></li>
<li class="chapter" data-level="10.2" data-path="appendix-git-github.html"><a href="appendix-git-github.html#commit-push"><i class="fa fa-check"></i><b>10.2</b> Commit &amp; Push</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="appendix-git-github.html"><a href="appendix-git-github.html#register-your-git-repo"><i class="fa fa-check"></i><b>10.2.1</b> Register Your Git repo</a></li>
<li class="chapter" data-level="10.2.2" data-path="appendix-git-github.html"><a href="appendix-git-github.html#commit"><i class="fa fa-check"></i><b>10.2.2</b> Commit</a></li>
<li class="chapter" data-level="10.2.3" data-path="appendix-git-github.html"><a href="appendix-git-github.html#push"><i class="fa fa-check"></i><b>10.2.3</b> Push</a></li>
<li class="chapter" data-level="10.2.4" data-path="appendix-git-github.html"><a href="appendix-git-github.html#edit"><i class="fa fa-check"></i><b>10.2.4</b> Edit</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html"><i class="fa fa-check"></i><b>11</b> Appendix: Data Structure</a>
<ul>
<li class="chapter" data-level="11.1" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#overview"><i class="fa fa-check"></i><b>11.1</b> Overview</a></li>
<li class="chapter" data-level="11.2" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#vector"><i class="fa fa-check"></i><b>11.2</b> Vector</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#create-vector"><i class="fa fa-check"></i><b>11.2.1</b> Create Vector</a></li>
<li class="chapter" data-level="11.2.2" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#check-features"><i class="fa fa-check"></i><b>11.2.2</b> Check Features</a></li>
<li class="chapter" data-level="11.2.3" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#access"><i class="fa fa-check"></i><b>11.2.3</b> Access</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#matrix"><i class="fa fa-check"></i><b>11.3</b> Matrix</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#create-matrix"><i class="fa fa-check"></i><b>11.3.1</b> Create Matrix</a></li>
<li class="chapter" data-level="11.3.2" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#check-features-1"><i class="fa fa-check"></i><b>11.3.2</b> Check Features</a></li>
<li class="chapter" data-level="11.3.3" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#access-1"><i class="fa fa-check"></i><b>11.3.3</b> Access</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#data-frame"><i class="fa fa-check"></i><b>11.4</b> Data Frame</a></li>
<li class="chapter" data-level="11.5" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#exercise"><i class="fa fa-check"></i><b>11.5</b> Exercise</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#vector-1"><i class="fa fa-check"></i><b>11.5.1</b> Vector</a></li>
<li class="chapter" data-level="11.5.2" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#matrix-1"><i class="fa fa-check"></i><b>11.5.2</b> Matrix</a></li>
<li class="chapter" data-level="11.5.3" data-path="appendix-data-structure.html"><a href="appendix-data-structure.html#data-frame-1"><i class="fa fa-check"></i><b>11.5.3</b> Data Frame</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html"><i class="fa fa-check"></i><b>12</b> Appendix: Tidyverse</a>
<ul>
<li class="chapter" data-level="12.1" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#overview-1"><i class="fa fa-check"></i><b>12.1</b> Overview</a></li>
<li class="chapter" data-level="12.2" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#data-manipulation"><i class="fa fa-check"></i><b>12.2</b> Data Manipulation</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#data-format"><i class="fa fa-check"></i><b>12.2.1</b> Data Format</a></li>
<li class="chapter" data-level="12.2.2" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#row-manipulation"><i class="fa fa-check"></i><b>12.2.2</b> Row Manipulation</a></li>
<li class="chapter" data-level="12.2.3" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#column-manipulation"><i class="fa fa-check"></i><b>12.2.3</b> Column Manipulation</a></li>
<li class="chapter" data-level="12.2.4" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#piping"><i class="fa fa-check"></i><b>12.2.4</b> Piping</a></li>
<li class="chapter" data-level="12.2.5" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#reshape"><i class="fa fa-check"></i><b>12.2.5</b> Reshape</a></li>
<li class="chapter" data-level="12.2.6" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#group-operation"><i class="fa fa-check"></i><b>12.2.6</b> Group Operation</a></li>
<li class="chapter" data-level="12.2.7" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#join"><i class="fa fa-check"></i><b>12.2.7</b> Join</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#visualization"><i class="fa fa-check"></i><b>12.3</b> Visualization</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#point"><i class="fa fa-check"></i><b>12.3.1</b> Point</a></li>
<li class="chapter" data-level="12.3.2" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#line"><i class="fa fa-check"></i><b>12.3.2</b> Line</a></li>
<li class="chapter" data-level="12.3.3" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#histogram"><i class="fa fa-check"></i><b>12.3.3</b> Histogram</a></li>
<li class="chapter" data-level="12.3.4" data-path="appendix-tidyverse.html"><a href="appendix-tidyverse.html#boxplot"><i class="fa fa-check"></i><b>12.3.4</b> Boxplot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html"><i class="fa fa-check"></i><b>13</b> Appendix: Base Plot</a>
<ul>
<li class="chapter" data-level="13.1" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html#overview-2"><i class="fa fa-check"></i><b>13.1</b> Overview</a></li>
<li class="chapter" data-level="13.2" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html#plot"><i class="fa fa-check"></i><b>13.2</b> Plot</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html#symbol"><i class="fa fa-check"></i><b>13.2.1</b> Symbol</a></li>
<li class="chapter" data-level="13.2.2" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html#symbol-size"><i class="fa fa-check"></i><b>13.2.2</b> Symbol size</a></li>
<li class="chapter" data-level="13.2.3" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html#symbol-color-border"><i class="fa fa-check"></i><b>13.2.3</b> Symbol color (border)</a></li>
<li class="chapter" data-level="13.2.4" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html#symbol-color-fill"><i class="fa fa-check"></i><b>13.2.4</b> Symbol color (fill)</a></li>
<li class="chapter" data-level="13.2.5" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html#label"><i class="fa fa-check"></i><b>13.2.5</b> Label</a></li>
<li class="chapter" data-level="13.2.6" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html#axis"><i class="fa fa-check"></i><b>13.2.6</b> Axis</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html#boxplot-1"><i class="fa fa-check"></i><b>13.3</b> Boxplot</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html#box-color"><i class="fa fa-check"></i><b>13.3.1</b> Box color</a></li>
<li class="chapter" data-level="13.3.2" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html#border-color"><i class="fa fa-check"></i><b>13.3.2</b> Border color</a></li>
<li class="chapter" data-level="13.3.3" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html#box-width"><i class="fa fa-check"></i><b>13.3.3</b> Box width</a></li>
<li class="chapter" data-level="13.3.4" data-path="appendix-base-plot.html"><a href="appendix-base-plot.html#axis-1"><i class="fa fa-check"></i><b>13.3.4</b> Axis</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">BIOSTATS</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="two-group-comparison" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Two-Group Comparison<a href="two-group-comparison.html#two-group-comparison" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Data consists of “samples” extracted from the population of interest, but it’s important to acknowledge that these samples are not flawless replicas of the entire population. Given this imperfect information, how can we effectively investigate and discern the distinction between two populations? In this Chapter, I will introduce one of the most basic statistical tests – “t-test.” The t-test takes the following steps:</p>
<ol style="list-style-type: decimal">
<li>Define a <strong>test statistic</strong> to signify the difference between groups (t-statistic).</li>
<li>Define a probability distribution of t-statistic under the <strong>null hypothesis</strong>, i.e., a scenario that we assume no difference between groups.</li>
<li>Estimate the probability of yielding greater or less than the observed test statistic.</li>
</ol>
<div id="explore-data-structure" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Explore Data Structure<a href="two-group-comparison.html#explore-data-structure" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Suppose that we study fish populations of the same species in two lakes (Lake <code>a</code> and <code>b</code>). These lakes are in stark contrast of productivity (Lake <code>b</code> looks more productive), and our interest is the difference in <em>mean</em> body size between the two lakes. We obtained <span class="math inline">\(50\)</span> data points of fish length from each lake (download <a href="https://github.com/aterui/biostats/blob/master/data_raw/data_fish_length.csv">here</a>). Save under <code>data_raw/</code> and use <code>read_csv()</code> to read data:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="two-group-comparison.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co"># call add-in packages everytime you open new R session</span></span>
<span id="cb93-2"><a href="two-group-comparison.html#cb93-2" aria-hidden="true" tabindex="-1"></a>df_fl <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data_raw/data_fish_length.csv&quot;</span>)</span>
<span id="cb93-3"><a href="two-group-comparison.html#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df_fl)</span></code></pre></div>
<pre><code>## # A tibble: 100 × 3
##    lake  length unit 
##    &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;
##  1 a       10.8 cm   
##  2 a       13.6 cm   
##  3 a       10.1 cm   
##  4 a       18.6 cm   
##  5 a       14.2 cm   
##  6 a       10.1 cm   
##  7 a       14.7 cm   
##  8 a       15.6 cm   
##  9 a       15   cm   
## 10 a       11.9 cm   
## # ℹ 90 more rows</code></pre>
<p>In this data frame, fish length data from lake <code>a</code> and <code>b</code> are recorded. Confirm this with <code>unique()</code> or <code>distinct()</code> function:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="two-group-comparison.html#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unique returns unique values as a vector</span></span>
<span id="cb95-2"><a href="two-group-comparison.html#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(df_fl<span class="sc">$</span>lake)</span></code></pre></div>
<pre><code>## [1] &quot;a&quot; &quot;b&quot;</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="two-group-comparison.html#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># distinct returns unique values as a tibble</span></span>
<span id="cb97-2"><a href="two-group-comparison.html#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">distinct</span>(df_fl, lake)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 1
##   lake 
##   &lt;chr&gt;
## 1 a    
## 2 b</code></pre>
<p>Visualization provides a powerful tool for summarizing data effectively. By plotting individual data points overlaid with mean values and error bars, we can observe the distribution and patterns within the data, allowing us to identify trends, variations, and potential outliers:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="two-group-comparison.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># group mean and sd</span></span>
<span id="cb99-2"><a href="two-group-comparison.html#cb99-2" aria-hidden="true" tabindex="-1"></a>df_fl_mu <span class="ot">&lt;-</span> df_fl <span class="sc">%&gt;%</span> </span>
<span id="cb99-3"><a href="two-group-comparison.html#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(lake) <span class="sc">%&gt;%</span> <span class="co"># group operation</span></span>
<span id="cb99-4"><a href="two-group-comparison.html#cb99-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mu_l =</span> <span class="fu">mean</span>(length), <span class="co"># summarize by mean()</span></span>
<span id="cb99-5"><a href="two-group-comparison.html#cb99-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_l =</span> <span class="fu">sd</span>(length)) <span class="co"># summarize with sd()</span></span>
<span id="cb99-6"><a href="two-group-comparison.html#cb99-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-7"><a href="two-group-comparison.html#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb99-8"><a href="two-group-comparison.html#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="co"># geom_jitter() plot data points with scatter</span></span>
<span id="cb99-9"><a href="two-group-comparison.html#cb99-9" aria-hidden="true" tabindex="-1"></a><span class="co"># geom_segment() draw lines</span></span>
<span id="cb99-10"><a href="two-group-comparison.html#cb99-10" aria-hidden="true" tabindex="-1"></a><span class="co"># geom_point() draw points</span></span>
<span id="cb99-11"><a href="two-group-comparison.html#cb99-11" aria-hidden="true" tabindex="-1"></a>df_fl <span class="sc">%&gt;%</span> </span>
<span id="cb99-12"><a href="two-group-comparison.html#cb99-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lake,</span>
<span id="cb99-13"><a href="two-group-comparison.html#cb99-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> length)) <span class="sc">+</span></span>
<span id="cb99-14"><a href="two-group-comparison.html#cb99-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="co"># scatter width</span></span>
<span id="cb99-15"><a href="two-group-comparison.html#cb99-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">height =</span> <span class="dv">0</span>, <span class="co"># scatter height (no scatter with zero)</span></span>
<span id="cb99-16"><a href="two-group-comparison.html#cb99-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.25</span>) <span class="sc">+</span> <span class="co"># transparency of data points</span></span>
<span id="cb99-17"><a href="two-group-comparison.html#cb99-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> df_fl_mu, <span class="co"># switch data frame</span></span>
<span id="cb99-18"><a href="two-group-comparison.html#cb99-18" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x =</span> lake,</span>
<span id="cb99-19"><a href="two-group-comparison.html#cb99-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xend =</span> lake,</span>
<span id="cb99-20"><a href="two-group-comparison.html#cb99-20" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> mu_l <span class="sc">-</span> sd_l,</span>
<span id="cb99-21"><a href="two-group-comparison.html#cb99-21" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend =</span> mu_l <span class="sc">+</span> sd_l)) <span class="sc">+</span></span>
<span id="cb99-22"><a href="two-group-comparison.html#cb99-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df_fl_mu, <span class="co"># switch data frame</span></span>
<span id="cb99-23"><a href="two-group-comparison.html#cb99-23" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> lake,</span>
<span id="cb99-24"><a href="two-group-comparison.html#cb99-24" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y =</span> mu_l),</span>
<span id="cb99-25"><a href="two-group-comparison.html#cb99-25" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb99-26"><a href="two-group-comparison.html#cb99-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Lake&quot;</span>, <span class="co"># x label</span></span>
<span id="cb99-27"><a href="two-group-comparison.html#cb99-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Fish body length&quot;</span>) <span class="co"># y label</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:mean-plot"></span>
<img src="_main_files/figure-html/mean-plot-1.png" alt="Example of mean and SD plot" width="672" />
<p class="caption">
Figure 4.1: Example of mean and SD plot
</p>
</div>
<p>Hmm, it is possible that there is a noticeable disparity in body size between Lake <code>a</code> and Lake <code>b</code>. However, how can we ascertain and provide evidence for this claim?</p>
</div>
<div id="test-statistic" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Test Statistic<a href="two-group-comparison.html#test-statistic" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="t-statistic" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> t-statistic<a href="two-group-comparison.html#t-statistic" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Since our focus is on examining the difference in means, it is logical to estimate the disparity between the sample means in each lake. Let me denote the sample means as <span class="math inline">\(\hat{\mu}_a\)</span> and <span class="math inline">\(\hat{\mu}_b\)</span> for Lake <code>a</code> and Lake <code>b</code>, respectively. We can estimate the difference between the means using the following approach:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="two-group-comparison.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># take another look at df_fl_mu</span></span>
<span id="cb100-2"><a href="two-group-comparison.html#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df_fl_mu)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   lake   mu_l  sd_l
##   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 a      13.4  2.92
## 2 b      15.4  3.39</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="two-group-comparison.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pull mu_l from tibble as vector</span></span>
<span id="cb102-2"><a href="two-group-comparison.html#cb102-2" aria-hidden="true" tabindex="-1"></a>v_mu <span class="ot">&lt;-</span> df_fl_mu <span class="sc">%&gt;%</span> </span>
<span id="cb102-3"><a href="two-group-comparison.html#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(mu_l)</span>
<span id="cb102-4"><a href="two-group-comparison.html#cb102-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-5"><a href="two-group-comparison.html#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="co"># lake a</span></span>
<span id="cb102-6"><a href="two-group-comparison.html#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(v_mu[<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 13.35</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="two-group-comparison.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lake b</span></span>
<span id="cb104-2"><a href="two-group-comparison.html#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(v_mu[<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## [1] 15.406</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="two-group-comparison.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># difference</span></span>
<span id="cb106-2"><a href="two-group-comparison.html#cb106-2" aria-hidden="true" tabindex="-1"></a>v_mu[<span class="dv">1</span>] <span class="sc">-</span> v_mu[<span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [1] -2.056</code></pre>
<p>The average fish body size in Lake <code>b</code> is approximately 2 cm larger than that in Lake <code>a</code>. However, it is crucial to recognize that we are still lacking vital information, specifically, the uncertainty associated with this difference. As discussed in Chapter <a href="sampling.html#sampling">2</a>, we must acknowledge that sample means are not flawless representations of the entire population.</p>
<p>Fortunately, we can utilize sample variances to address such uncertainties. The <strong>t-statistic</strong> is a common indicator of the difference of means that takes into consideration the uncertainty associated with sample means.</p>
<p><span class="math display">\[
t = \frac{\hat{\mu_a} - \hat{\mu_b}}{\sqrt{\hat{\sigma}^2_p \left(\frac{1}{N_a} + \frac{1}{N_b}\right)}}
\]</span></p>
<p>where <span class="math inline">\(N_a\)</span> and <span class="math inline">\(N_b\)</span> are sample sizes in Lake <code>a</code> and <code>b</code> (i.e., <span class="math inline">\(N_a = N_b = 50\)</span> in this specific example), and <span class="math inline">\(\hat{\sigma}^2_p\)</span> is the weighted mean of sample variances:</p>
<p><span class="math display">\[
\hat{\sigma}^2_p = \frac{N_a-1}{N_a + N_b - 2}\hat{\sigma}^2_a + \frac{N_b-1}{N_a + N_b - 2}\hat{\sigma}^2_b
\]</span></p>
<p>We can calculate this value in R manually:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="two-group-comparison.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># group mean, variance, and sample size</span></span>
<span id="cb108-2"><a href="two-group-comparison.html#cb108-2" aria-hidden="true" tabindex="-1"></a>df_t <span class="ot">&lt;-</span> df_fl <span class="sc">%&gt;%</span> </span>
<span id="cb108-3"><a href="two-group-comparison.html#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(lake) <span class="sc">%&gt;%</span> <span class="co"># group operation</span></span>
<span id="cb108-4"><a href="two-group-comparison.html#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">mu_l =</span> <span class="fu">mean</span>(length), <span class="co"># summarize by mean()</span></span>
<span id="cb108-5"><a href="two-group-comparison.html#cb108-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">var_l =</span> <span class="fu">var</span>(length), <span class="co"># summarize with sd()</span></span>
<span id="cb108-6"><a href="two-group-comparison.html#cb108-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>()) <span class="co"># count number of rows per group</span></span>
<span id="cb108-7"><a href="two-group-comparison.html#cb108-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-8"><a href="two-group-comparison.html#cb108-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df_t)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 4
##   lake   mu_l var_l     n
##   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
## 1 a      13.4  8.52    50
## 2 b      15.4 11.5     50</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="two-group-comparison.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pull values as a vector</span></span>
<span id="cb110-2"><a href="two-group-comparison.html#cb110-2" aria-hidden="true" tabindex="-1"></a>v_mu <span class="ot">&lt;-</span> <span class="fu">pull</span>(df_t, mu_l)</span>
<span id="cb110-3"><a href="two-group-comparison.html#cb110-3" aria-hidden="true" tabindex="-1"></a>v_var <span class="ot">&lt;-</span> <span class="fu">pull</span>(df_t, var_l)</span>
<span id="cb110-4"><a href="two-group-comparison.html#cb110-4" aria-hidden="true" tabindex="-1"></a>v_n <span class="ot">&lt;-</span> <span class="fu">pull</span>(df_t, n)</span>
<span id="cb110-5"><a href="two-group-comparison.html#cb110-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-6"><a href="two-group-comparison.html#cb110-6" aria-hidden="true" tabindex="-1"></a>var_p <span class="ot">&lt;-</span> ((v_n[<span class="dv">1</span>] <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>(<span class="fu">sum</span>(v_n) <span class="sc">-</span> <span class="dv">2</span>)) <span class="sc">*</span> v_var[<span class="dv">1</span>] <span class="sc">+</span></span>
<span id="cb110-7"><a href="two-group-comparison.html#cb110-7" aria-hidden="true" tabindex="-1"></a>  ((v_n[<span class="dv">2</span>] <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>(<span class="fu">sum</span>(v_n) <span class="sc">-</span> <span class="dv">2</span>)) <span class="sc">*</span> v_var[<span class="dv">2</span>]</span>
<span id="cb110-8"><a href="two-group-comparison.html#cb110-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-9"><a href="two-group-comparison.html#cb110-9" aria-hidden="true" tabindex="-1"></a>t_value <span class="ot">&lt;-</span> (v_mu[<span class="dv">1</span>] <span class="sc">-</span> v_mu[<span class="dv">2</span>]) <span class="sc">/</span> <span class="fu">sqrt</span>(var_p <span class="sc">*</span> ((<span class="dv">1</span> <span class="sc">/</span> v_n[<span class="dv">1</span>]) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">/</span> v_n[<span class="dv">2</span>])))</span>
<span id="cb110-10"><a href="two-group-comparison.html#cb110-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-11"><a href="two-group-comparison.html#cb110-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(t_value)</span></code></pre></div>
<pre><code>## [1] -3.247322</code></pre>
<p>The difference in sample means were -2.06; therefore, t-statistic further emphasizes the distinction between the study lakes. This occurrence can be attributed to the t-statistic formula.</p>
<p>In the denominator, we observe the inclusion of <span class="math inline">\(\hat{\sigma}^2_p\)</span> (estimated pooled variance), as well as the inverses of sample sizes <span class="math inline">\(N_a\)</span> and <span class="math inline">\(N_b\)</span>. Consequently, as <span class="math inline">\(\hat{\sigma}^2_p\)</span> decreases and/or the sample sizes increase, the t-statistic increases. This is a reasonable outcome since a decrease in variance and/or an increase in sample size enhance the certainty of the mean difference.</p>
</div>
<div id="null-hypothesis" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Null Hypothesis<a href="two-group-comparison.html#null-hypothesis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The observed t-statistic serves a dual purpose in accounting for both the disparity of means and the accompanying uncertainty. However, the significance of this t-statistic remains unclear.</p>
<p>To address this, the concept of the <strong>Null Hypothesis</strong> is utilized to substantiate the observed t-statistic. The Null Hypothesis, no difference between groups or <span class="math inline">\(\mu_a = \mu_b\)</span>, allows us to draw the probability distribution of the test-statistic. Once we know the probability distribution, we can <strong><em>estimate the probability of observing the given t-statistic by random chance</em></strong> if there were no difference in mean body size between the lakes.</p>
<p>Let’s begin by assuming that there is no difference in the mean body size of fish populations between the lakes, meaning the true difference in means is zero (<span class="math inline">\(\mu_a - \mu_b = 0\)</span>; without hats in this formula!). Under this assumption, we can define the probability distribution of t-statistics, which represents how t-statistics are distributed across a range of possible values.</p>
<p>This probability distribution is known as the Student’s t-distribution and is characterized by three parameters: the mean, the variance, and the degrees of freedom (d.f.). Considering that we are evaluating the difference in body size as the test statistic, the mean (of the difference) is assumed to be zero. The variance is estimated using <span class="math inline">\(\hat{\sigma}^2_p\)</span>, and the degrees of freedom are determined by <span class="math inline">\(N_a + N_b - 2\)</span> (where d.f. can be considered as a measure related to the sample size<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>).</p>
<p>R has a function to draw the Student’s t-distribution; let’s try that out:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="two-group-comparison.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># produce 500 values from -5 to 5 with equal interval</span></span>
<span id="cb112-2"><a href="two-group-comparison.html#cb112-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">length =</span> <span class="dv">500</span>)</span>
<span id="cb112-3"><a href="two-group-comparison.html#cb112-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-4"><a href="two-group-comparison.html#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="co"># probability density of t-statistics with df = sum(v_n) - 2</span></span>
<span id="cb112-5"><a href="two-group-comparison.html#cb112-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">dt</span>(x, <span class="at">df =</span> <span class="fu">sum</span>(v_n) <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb112-6"><a href="two-group-comparison.html#cb112-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-7"><a href="two-group-comparison.html#cb112-7" aria-hidden="true" tabindex="-1"></a><span class="co"># draw figure</span></span>
<span id="cb112-8"><a href="two-group-comparison.html#cb112-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(x, y) <span class="sc">%&gt;%</span> </span>
<span id="cb112-9"><a href="two-group-comparison.html#cb112-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x,</span>
<span id="cb112-10"><a href="two-group-comparison.html#cb112-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb112-11"><a href="two-group-comparison.html#cb112-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb112-12"><a href="two-group-comparison.html#cb112-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Probability density&quot;</span>,</span>
<span id="cb112-13"><a href="two-group-comparison.html#cb112-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;t-statistic&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:student-t"></span>
<img src="_main_files/figure-html/student-t-1.png" alt="Distribution of t-statistics under null hypothesis. The probability density in a distribution determines the likelihood of observing a particular t-statistic. Higher probability density indicates a greater likelihood of the t-statistic occurring." width="672" />
<p class="caption">
Figure 4.2: Distribution of t-statistics under null hypothesis. The probability density in a distribution determines the likelihood of observing a particular t-statistic. Higher probability density indicates a greater likelihood of the t-statistic occurring.
</p>
</div>
<p>The probability density in a distribution (Figure <a href="two-group-comparison.html#fig:student-t">4.2</a>) determines the likelihood of observing a particular t-statistic. Higher probability density indicates a greater likelihood of the t-statistic occurring. Compare the observed t-statistic against this null distribution:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="two-group-comparison.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># draw entire range</span></span>
<span id="cb113-2"><a href="two-group-comparison.html#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(x, y) <span class="sc">%&gt;%</span> </span>
<span id="cb113-3"><a href="two-group-comparison.html#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x,</span>
<span id="cb113-4"><a href="two-group-comparison.html#cb113-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb113-5"><a href="two-group-comparison.html#cb113-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb113-6"><a href="two-group-comparison.html#cb113-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> t_value,</span>
<span id="cb113-7"><a href="two-group-comparison.html#cb113-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;salmon&quot;</span>) <span class="sc">+</span> <span class="co"># t_value is the observed t_value</span></span>
<span id="cb113-8"><a href="two-group-comparison.html#cb113-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">abs</span>(t_value),</span>
<span id="cb113-9"><a href="two-group-comparison.html#cb113-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">&quot;salmon&quot;</span>) <span class="sc">+</span> <span class="co"># t_value is the observed t_value</span></span>
<span id="cb113-10"><a href="two-group-comparison.html#cb113-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Probability density&quot;</span>,</span>
<span id="cb113-11"><a href="two-group-comparison.html#cb113-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;t-statistic&quot;</span>) </span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:student-t-obs"></span>
<img src="_main_files/figure-html/student-t-obs-1.png" alt="Observed t-statistic in comparison to the null distrubution" width="672" />
<p class="caption">
Figure 4.3: Observed t-statistic in comparison to the null distrubution
</p>
</div>
<p>In a probability distribution, the area under the curve corresponds to the probability. Notably, <strong>the area under the curve that falls below or above the observed t-statistic (indicated by vertical red lines) is very small (Figure</strong> <a href="two-group-comparison.html#fig:student-t-obs">4.3</a><strong>)</strong>, meaning that the observed difference in body size is very unlikely to occur under the null hypothesis (no difference in true means).</p>
<p>The function <code>pt()</code> allows us to calculate the area under the curve:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="two-group-comparison.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate area under the curve from -infinity to t_value</span></span>
<span id="cb114-2"><a href="two-group-comparison.html#cb114-2" aria-hidden="true" tabindex="-1"></a>pr_below <span class="ot">&lt;-</span> <span class="fu">pt</span>(<span class="at">q =</span> t_value, <span class="at">df =</span> <span class="fu">sum</span>(v_n) <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb114-3"><a href="two-group-comparison.html#cb114-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-4"><a href="two-group-comparison.html#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate area under the curve from abs(t_value) to infinity</span></span>
<span id="cb114-5"><a href="two-group-comparison.html#cb114-5" aria-hidden="true" tabindex="-1"></a>pr_above <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="at">q =</span> <span class="fu">abs</span>(t_value), <span class="at">df =</span> <span class="fu">sum</span>(v_n) <span class="sc">-</span> <span class="dv">2</span>)</span></code></pre></div>
<p>The <strong>p-value,</strong> i.e., <em>the probability of observing t-statistics</em> less than ( <code>pr_below</code>) or greater than (<code>pr_above</code>) the observed t-statistic under the null hypothesis, can be estimated as the sum of <code>pr_below</code> and <code>pr_above</code>.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="two-group-comparison.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p_value</span></span>
<span id="cb115-2"><a href="two-group-comparison.html#cb115-2" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> pr_below <span class="sc">+</span> pr_above</span>
<span id="cb115-3"><a href="two-group-comparison.html#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(p_value)</span></code></pre></div>
<pre><code>## [1] 0.001595529</code></pre>
</div>
<div id="interpretation" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Interpretation<a href="two-group-comparison.html#interpretation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The above exercise is called <strong>t-test</strong> – perhaps, the most well-known hypothesis testing. To explain the interpretation of the results, let me use the following notations. <span class="math inline">\(t_{obs}\)</span>, the observed t-statistic; <span class="math inline">\(t_0\)</span>, possible t-statistics under the null hypothesis; <span class="math inline">\(\Pr(\cdot)\)</span>, the probability of “<span class="math inline">\(\cdot\)</span>” occurs – for example, <span class="math inline">\(\Pr(x &gt; 2)\)</span> means that the probability of <span class="math inline">\(x\)</span> exceeding <span class="math inline">\(2\)</span>.</p>
<p>We first calculated the observed t-statistic <span class="math inline">\(t_{obs}\)</span> using the data of fish body size, which was -3.25. Then, we calculated p-value, i.e., <span class="math inline">\(\Pr(t_0 &lt; t_{obs}) + \Pr(t_0 &gt; t_{obs})\)</span> under the null hypothesis of <span class="math inline">\(\mu_a = \mu_b\)</span>. We found p-value was very low, meaning that the observed t-statistic is very unlikely to occur if <span class="math inline">\(\mu_a = \mu_b\)</span> is the truth. Therefore, it is logical to conclude that the <strong>Alternative Hypothesis</strong> <span class="math inline">\(\mu_a \ne \mu_b\)</span> is very likely.</p>
<p>The same logic is used in many statistical analyses – define the null hypothesis, and estimate the probability of observing a given value under the null hypothesis. It is tricky, but I find this genius: we can substantiate the observation(s) objectively that are otherwise a subjective claim!</p>
<p>However, it is crucial to recognize that, <strong>even if we found the observed t-statistic that results in very high p-value (i.e., very common under the null hypothesis), finding such a result does NOT support the null hypothesis – we just can’t reject it.</strong></p>
</div>
</div>
<div id="t-test-in-r" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> t-test in R<a href="two-group-comparison.html#t-test-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="t-test-with-equal-variance" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> t-test with equal variance<a href="two-group-comparison.html#t-test-with-equal-variance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In R, this t-test can be performed with <code>t.test()</code>. Let me examine if the function gives us identical results:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="two-group-comparison.html#cb117-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> df_fl <span class="sc">%&gt;%</span></span>
<span id="cb117-2"><a href="two-group-comparison.html#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(lake <span class="sc">==</span> <span class="st">&quot;a&quot;</span>) <span class="sc">%&gt;%</span>  <span class="co"># subset lake a</span></span>
<span id="cb117-3"><a href="two-group-comparison.html#cb117-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(length)</span>
<span id="cb117-4"><a href="two-group-comparison.html#cb117-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-5"><a href="two-group-comparison.html#cb117-5" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> df_fl <span class="sc">%&gt;%</span></span>
<span id="cb117-6"><a href="two-group-comparison.html#cb117-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(lake <span class="sc">==</span> <span class="st">&quot;b&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># subset lake b</span></span>
<span id="cb117-7"><a href="two-group-comparison.html#cb117-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(length)</span>
<span id="cb117-8"><a href="two-group-comparison.html#cb117-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-9"><a href="two-group-comparison.html#cb117-9" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(x, y, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  x and y
## t = -3.2473, df = 98, p-value = 0.001596
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -3.3124399 -0.7995601
## sample estimates:
## mean of x mean of y 
##    13.350    15.406</code></pre>
<p>The reported t-statistic <code>t = -3.2473</code>, the p-value <code>p-value = 0.001596</code>, and the degrees of freedom all agreed (<code>df = 98</code>) with what we have estimated manually. Importantly, this t-test assumes relative similarity of variance between groups.</p>
</div>
<div id="t-test-with-unequal-variance" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> t-test with unequal variance<a href="two-group-comparison.html#t-test-with-unequal-variance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The relative similarity of variance between groups could be an unrealistic assumption. Luckily, there is a variant of t-test “Welch’s t-test,” in which we assume unequal variance between groups. The implementation is easy – set <code>var.equal = FALSE</code> in <code>t.test()</code>:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="two-group-comparison.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(x, y, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  x and y
## t = -3.2473, df = 95.846, p-value = 0.001606
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -3.3127929 -0.7992071
## sample estimates:
## mean of x mean of y 
##    13.350    15.406</code></pre>
<p>In Welch’s t-test, t-statistics are defined differently to account for unequal variance between groups<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>:</p>
<p><span class="math display">\[
t = \frac{\hat{\mu_a} - \hat{\mu_b}}{\sqrt{\left(\frac{\hat{\sigma}^2_a}{N_a} + \frac{\hat{\sigma}^2_b}{N_b}\right)}}
\]</span></p>
<p>This t-statistic is known to follow the Student’s t-distribution with the degrees of freedom:</p>
<p><span class="math display">\[
d.f. = \frac{\frac{\hat{\sigma}^2_a}{N_a} + \frac{\hat{\sigma}^2_b}{N_b}}{\frac{(\hat{\sigma}^2_a / N_a)^2}{N_a - 1} + \frac{(\hat{\sigma}^2_b/N_b)^2}{N_b-1}}
\]</span></p>
<p>Therefore, the reported values of t-statistic and d.f. are different from what we estimated. The Welch’s t-test covers the cases for equal variances; therefore, by default, we use the Welch’s test.</p>
</div>
</div>
<div id="laboratory-3" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Laboratory<a href="two-group-comparison.html#laboratory-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p>Discussing the concept of degrees of freedom in depth would require a more comprehensive explanation, so I will refer to it here as a quantity relevant to the sample size.<a href="two-group-comparison.html#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>When <span class="math inline">\(\hat{\sigma}^2_a \approx \hat{\sigma}_b^2\)</span>, the t-statistic for Welch’s t-test is reduced to the original t-statistic.<a href="two-group-comparison.html#fnref3" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="probabilistic-view.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multiple-group-comparison.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/aterui/biostats/chapters/04-two-group.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
