<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 11 Multiple-Group Comparison | BIOSTATS</title>
<meta name="author" content="Akira Terui">
<meta name="description" content="The t-test is used to compare two groups, but when there are more than two groups, ANOVA (Analysis of Variance) is employed. ANOVA allows for simultaneous comparison of means among multiple groups...">
<meta name="generator" content="bookdown 0.43 with bs4_book()">
<meta property="og:title" content="Chapter 11 Multiple-Group Comparison | BIOSTATS">
<meta property="og:type" content="book">
<meta property="og:description" content="The t-test is used to compare two groups, but when there are more than two groups, ANOVA (Analysis of Variance) is employed. ANOVA allows for simultaneous comparison of means among multiple groups...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 11 Multiple-Group Comparison | BIOSTATS">
<meta name="twitter:description" content="The t-test is used to compare two groups, but when there are more than two groups, ANOVA (Analysis of Variance) is employed. ANOVA allows for simultaneous comparison of means among multiple groups...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.9.0/transition.js"></script><script src="libs/bs3compat-0.9.0/tabs.js"></script><script src="libs/bs3compat-0.9.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-QZSNHVQQNV"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-QZSNHVQQNV');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">BIOSTATS</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Introduction</a></li>
<li class="book-part">Getting Started</li>
<li><a class="" href="what-is-r-and-r-studio.html"><span class="header-section-number">1</span> What is R and R studio?</a></li>
<li><a class="" href="installing-r-and-rstudio.html"><span class="header-section-number">2</span> Installing R and RStudio</a></li>
<li><a class="" href="r-project.html"><span class="header-section-number">3</span> R Project</a></li>
<li class="book-part">R Basics</li>
<li><a class="" href="data-structure.html"><span class="header-section-number">4</span> Data Structure</a></li>
<li><a class="" href="data-manipulation.html"><span class="header-section-number">5</span> Data Manipulation</a></li>
<li><a class="" href="visualization.html"><span class="header-section-number">6</span> Visualization</a></li>
<li class="book-part">Basic Statistics</li>
<li><a class="" href="descriptive-statistics.html"><span class="header-section-number">7</span> Descriptive Statistics</a></li>
<li><a class="" href="sampling.html"><span class="header-section-number">8</span> Sampling</a></li>
<li><a class="" href="probabilistic-view.html"><span class="header-section-number">9</span> Probabilistic View</a></li>
<li><a class="" href="two-group-comparison.html"><span class="header-section-number">10</span> Two-Group Comparison</a></li>
<li><a class="active" href="multiple-group-comparison.html"><span class="header-section-number">11</span> Multiple-Group Comparison</a></li>
<li><a class="" href="regression.html"><span class="header-section-number">12</span> Regression</a></li>
<li><a class="" href="linear-model.html"><span class="header-section-number">13</span> Linear Model</a></li>
<li><a class="" href="generalized-linear-model.html"><span class="header-section-number">14</span> Generalized Linear Model</a></li>
<li><a class="" href="likelihood.html"><span class="header-section-number">15</span> Likelihood</a></li>
<li><a class="" href="model-comparison.html"><span class="header-section-number">16</span> Model Comparison</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="git-github.html">Git &amp; GitHub</a></li>
<li><a class="" href="base-plot.html">Base Plot</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/aterui/biostats">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="multiple-group-comparison" class="section level1" number="11">
<h1>
<span class="header-section-number">11</span> Multiple-Group Comparison<a class="anchor" aria-label="anchor" href="#multiple-group-comparison"><i class="fas fa-link"></i></a>
</h1>
<p>The t-test is used to compare two groups, but when there are more than two groups, ANOVA (Analysis of Variance) is employed. ANOVA allows for simultaneous comparison of means among multiple groups to determine if there are statistically significant differences. ANOVA uses the following steps:</p>
<ol style="list-style-type: decimal">
<li>Partition the total variability into <strong>between-group</strong> and <strong>within-group</strong> components.</li>
<li>Define a <strong>test statistic</strong> as a ratio of between-group variability to within-group variability (F statistic).</li>
<li>Define a probability distribution of F-statistic under the null hypothesis.</li>
<li>Estimate the probability of yielding greater the observed test statistic.</li>
</ol>
<p>If appropriate, post-hoc tests can be conducted to identify specific differing groups.</p>
<p><strong>Key words</strong>: F-statistic, Sum of Squares</p>
<div id="partition-the-variability" class="section level2" number="11.1">
<h2>
<span class="header-section-number">11.1</span> Partition the Variability<a class="anchor" aria-label="anchor" href="#partition-the-variability"><i class="fas fa-link"></i></a>
</h2>
<p>The first step is to determine what aspect to examine. In the case of a t-test, we focus on the difference in sample means between groups. One might initially consider conducting t-tests for all possible combinations. However, this approach leads to a problem known as the <a href="https://en.wikipedia.org/wiki/Multiple_comparisons_problem#:~:text=In%20statistics%2C%20the%20multiple%20comparisons,based%20on%20the%20observed%20values.">multiple comparisons problem</a>. Hence, this is not a viable option. Therefore, we need to explore the data from a different perspective.</p>
<p>To facilitate learning, let’s once again utilize the lake fish data (download <a href="https://github.com/aterui/biostats/blob/master/data_raw/data_fish_length_anova.csv">here</a>), but this time we have three lakes in our analysis:</p>
<div class="sourceCode" id="cb325"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_anova</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data_raw/data_fish_length_anova.csv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">df_anova</span>, <span class="va">lake</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 3 × 1
##   lake 
##   &lt;chr&gt;
## 1 a    
## 2 b    
## 3 c</code></pre>
<p>Visualization can be helpful in understanding how the data is distributed. While mean <span class="math inline">\(\pm\)</span> SD is perfectly fine here, let me use a violin plot to show a different way of visualization.</p>
<div class="sourceCode" id="cb327"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># geom_violin() - function for violin plots</span></span>
<span><span class="co"># geom_jitter() - jittered points</span></span>
<span></span>
<span><span class="va">df_anova</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">lake</span>,</span>
<span>             y <span class="op">=</span> <span class="va">length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html">geom_violin</a></span><span class="op">(</span>draw_quantiles <span class="op">=</span> <span class="fl">0.5</span>, <span class="co"># draw median horizontal line</span></span>
<span>              alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span> <span class="co"># transparency</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="co"># transparency</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:violin"></span>
<img src="biostats_files/figure-html/violin-1.png" alt="Violin plot for fish length in three lakes." width="672"><p class="caption">
Figure 11.1: Violin plot for fish length in three lakes.
</p>
</div>
<p>It appears that Lake <code>b</code> exhibits a larger average body size compared to the other lakes. One approach to quantifying this difference between groups is by examining the ratio of between-group variability to within-group variability. <strong>If we observe a greater between-group variability relative to within-group variability, it suggests that the differences among the groups are substantial.</strong> In other words, much of the observed variation is explained by the group structure (lake).</p>
<p>Let me denote between-group and within-group variability as <span class="math inline">\(S_b\)</span> and <span class="math inline">\(S_w\)</span>, respectively, which are defined as follows:</p>
<p><span class="math display">\[
\begin{aligned}
S_b &amp;= \sum_g \sum_i (\hat{\mu}_{g(i)} - \hat{\mu})^2\\
S_w &amp;= \sum_g \sum_i (x_{i} - \hat{\mu}_{g(i)})^2
\end{aligned}
\]</span></p>
<p>The double summation <span class="math inline">\(\sum_g \sum_i\)</span> might scare you, but no worries. We can decompose this equation into two steps.</p>
<div id="between-group-variability" class="section level3" number="11.1.1">
<h3>
<span class="header-section-number">11.1.1</span> Between-group variability<a class="anchor" aria-label="anchor" href="#between-group-variability"><i class="fas fa-link"></i></a>
</h3>
<p>Let me first consider <span class="math inline">\(S_b = \sum_g \sum_i (\hat{\mu}_{g(i)} - \hat{\mu})^2\)</span>. In this equation, <span class="math inline">\(\hat{\mu}\)</span> is the overall mean of the fish length and <span class="math inline">\(\hat{\mu}_{g(i)}\)</span> is the group-mean in a given lake (<span class="math inline">\(g \in \{a, b, c\}\)</span>). Let’s perform this estimation in R:</p>
<div class="sourceCode" id="cb328"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># estimate overall mean</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">df_anova</span><span class="op">$</span><span class="va">length</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># estimate group means and sample size each</span></span>
<span><span class="va">df_g</span> <span class="op">&lt;-</span> <span class="va">df_anova</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">lake</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mu_g <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">length</span><span class="op">)</span>, <span class="co"># mean for each group</span></span>
<span>            dev_g <span class="op">=</span> <span class="op">(</span><span class="va">mu_g</span> <span class="op">-</span> <span class="va">mu</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span>, <span class="co"># squared deviation for each group</span></span>
<span>            n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># sample size for each group</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">df_g</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 3 × 4
##   lake   mu_g   dev_g     n
##   &lt;chr&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;
## 1 a      13.4 1.12       50
## 2 b      15.4 0.997      50
## 3 c      14.5 0.00344    50</code></pre>
<p>In the column <code>dev_g</code>, we estimated <span class="math inline">\((\hat{\mu}_{g(i)} - \hat{\mu})^2\)</span>. We must sum over <span class="math inline">\(i\)</span> (fish individual) to get the variability in each lake (<span class="math inline">\(\sum_i (\hat{\mu}_{g(i)} - \hat{\mu})^2\)</span>). Since <span class="math inline">\(\hat{\mu}_{g(i)}\)</span> is constant in each lake, we can simply multiply <code>dev_g</code> with sample size <code>n</code> in each lake:</p>
<div class="sourceCode" id="cb330"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_g</span> <span class="op">&lt;-</span> <span class="va">df_g</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ss <span class="op">=</span> <span class="va">dev_g</span> <span class="op">*</span> <span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">df_g</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 3 × 5
##   lake   mu_g   dev_g     n     ss
##   &lt;chr&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;  &lt;dbl&gt;
## 1 a      13.4 1.12       50 55.9  
## 2 b      15.4 0.997      50 49.9  
## 3 c      14.5 0.00344    50  0.172</code></pre>
<p>Sum over <span class="math inline">\(g\)</span> (lake) to get <span class="math inline">\(S_b\)</span>.</p>
<div class="sourceCode" id="cb332"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df_g</span><span class="op">$</span><span class="va">ss</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">s_b</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 105.9365</code></pre>
</div>
<div id="within-group-variability" class="section level3" number="11.1.2">
<h3>
<span class="header-section-number">11.1.2</span> Within-group variability<a class="anchor" aria-label="anchor" href="#within-group-variability"><i class="fas fa-link"></i></a>
</h3>
<p>We can follow the same steps to estimate the within-group variability <span class="math inline">\(S_w = \sum_g \sum_i (x_{i} - \hat{\mu}_{g(i)})^2\)</span>. Let’s estimate <span class="math inline">\((x_{i} - \hat{\mu}_{g(i)})^2\)</span> first:</p>
<div class="sourceCode" id="cb334"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_i</span> <span class="op">&lt;-</span> <span class="va">df_anova</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">lake</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>mu_g <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">length</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># use mutate() to retain individual rows</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>dev_i <span class="op">=</span> <span class="op">(</span><span class="va">length</span> <span class="op">-</span> <span class="va">mu_g</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="co"># deviation from group mean for each fish</span></span></code></pre></div>
<p>You can take a look at group-level data with the following code; the column <code>mu_g</code> contains group-specific means of fish length, and <code>dev_i</code> contains <span class="math inline">\((x_i - \hat{\mu}_{g(i)})^2\)</span>:</p>
<div class="sourceCode" id="cb335"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># filter() &amp; slice(): show first 3 rows each group</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">df_i</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">lake</span> <span class="op">==</span> <span class="st">"a"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">df_i</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">lake</span> <span class="op">==</span> <span class="st">"b"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">df_i</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">lake</span> <span class="op">==</span> <span class="st">"c"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Sum over <span class="math inline">\(i\)</span> in each lake <span class="math inline">\(g\)</span> (<span class="math inline">\(\sum_i (x_i - \hat{\mu}_{g(i)})^2\)</span>):</p>
<div class="sourceCode" id="cb336"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_i_g</span> <span class="op">&lt;-</span> <span class="va">df_i</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">lake</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>ss <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">dev_i</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">df_i_g</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   lake     ss
##   &lt;chr&gt; &lt;dbl&gt;
## 1 a      417.
## 2 b      565.
## 3 c      486.</code></pre>
<p>Then sum over <span class="math inline">\(g\)</span> to get <span class="math inline">\(S_w\)</span>:</p>
<div class="sourceCode" id="cb338"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s_w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">df_i_g</span><span class="op">$</span><span class="va">ss</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">s_w</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 1467.645</code></pre>
</div>
<div id="variability-to-variance" class="section level3" number="11.1.3">
<h3>
<span class="header-section-number">11.1.3</span> Variability to Variance<a class="anchor" aria-label="anchor" href="#variability-to-variance"><i class="fas fa-link"></i></a>
</h3>
<p>I referred to <span class="math inline">\(S_b\)</span> and <span class="math inline">\(S_w\)</span> as “variability,” which essentially represents the summation of squared deviations. To convert them into variances, we can divide them by appropriate numbers. In Chapter <a href="sampling.html#sampling">8</a>, I mentioned that the denominator for variance is the sample size minus one. The same principle applies here, but with caution.</p>
<p>For the between-group variability, denoted as <span class="math inline">\(S_b\)</span>, the realized sample size is the number of groups, <span class="math inline">\(N_g\)</span>, which in this case is three (representing the number of lakes). Therefore, we divide by three minus one to obtain an unbiased estimate of the between-group variance, denoted as <span class="math inline">\(\hat{\sigma}_b^2\)</span>:</p>
<p><span class="math display">\[
\hat{\sigma}^2_b = \frac{S_b}{N_g-1}
\]</span></p>
<div class="sourceCode" id="cb340"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># n_distinct() count the number of unique elements</span></span>
<span><span class="va">n_g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html">n_distinct</a></span><span class="op">(</span><span class="va">df_anova</span><span class="op">$</span><span class="va">lake</span><span class="op">)</span></span>
<span><span class="va">s2_b</span> <span class="op">&lt;-</span> <span class="va">s_b</span> <span class="op">/</span> <span class="op">(</span><span class="va">n_g</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">s2_b</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 52.96827</code></pre>
<p>Meanwhile, we need to be careful when estimating the within-group variance. Since the within-group variance is measured at the individual level, the number of data used is equal to the number of fish individuals. Yet, we subtract the number of groups – while the rationale behind this is beyond the scope, we are essentially accounting for the fact that some of the degrees of freedom are “used up” in estimating the group means. As such, we estimate the within-group variance <span class="math inline">\(\hat{\sigma}^2_w\)</span> as follows:</p>
<p><span class="math display">\[
\hat{\sigma}^2_w = \frac{S_w}{N-N_g}
\]</span></p>
<div class="sourceCode" id="cb342"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s2_w</span> <span class="op">&lt;-</span> <span class="va">s_w</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df_anova</span><span class="op">)</span> <span class="op">-</span> <span class="va">n_g</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">s2_w</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 9.983982</code></pre>
</div>
</div>
<div id="test-statistic-1" class="section level2" number="11.2">
<h2>
<span class="header-section-number">11.2</span> Test Statistic<a class="anchor" aria-label="anchor" href="#test-statistic-1"><i class="fas fa-link"></i></a>
</h2>
<div id="f-statistic" class="section level3" number="11.2.1">
<h3>
<span class="header-section-number">11.2.1</span> F-statistic<a class="anchor" aria-label="anchor" href="#f-statistic"><i class="fas fa-link"></i></a>
</h3>
<p>In ANOVA, we use F-statistic – the ratio of between-group variability to within-group variability. The above exercise was essentially performed to yield this test statistic:</p>
<p><span class="math display">\[
F = \frac{\text{between-group variance}}{\text{within-group variance}} = \frac{\hat{\sigma}^2_b}{\hat{\sigma}^2_w}
\]</span></p>
<div class="sourceCode" id="cb344"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f_value</span> <span class="op">&lt;-</span> <span class="va">s2_b</span> <span class="op">/</span> <span class="va">s2_w</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">f_value</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 5.305325</code></pre>
<p>The F-statistic in our data was calculated to be 5.31. This indicates that the between-group variance is approximately five times higher than the within-group variance. While this difference appears significant, it is important to determine whether it is statistically substantial. To make such a claim, we can use the Null Hypothesis as a reference.</p>
</div>
<div id="null-hypothesis-1" class="section level3" number="11.2.2">
<h3>
<span class="header-section-number">11.2.2</span> Null Hypothesis<a class="anchor" aria-label="anchor" href="#null-hypothesis-1"><i class="fas fa-link"></i></a>
</h3>
<p>The F-statistic follows an F-distribution when there is no difference in means among the groups. Therefore, the null hypothesis we are considering in our example is that the means of all groups are equal, represented as <span class="math inline">\(\mu_a = \mu_b = \mu_c\)</span>. It’s worth noting that the alternative hypotheses can take different forms, such as <span class="math inline">\(\mu_a \ne \mu_b = \mu_c\)</span>, <span class="math inline">\(\mu_a = \mu_b \ne \mu_c\)</span>, or <span class="math inline">\(\mu_a \ne \mu_b \ne \mu_c\)</span>. ANOVA, however, is unable to distinguish between these alternative hypotheses.</p>
<p>The degrees of freedom in an F-distribution are determined by two parameters: <span class="math inline">\(N_g - 1\)</span> and <span class="math inline">\(N - N_g\)</span>. To visualize the distribution, you can utilize the<code><a href="https://rdrr.io/r/stats/Fdist.html">df()</a></code> function. Similar to the t-test, we can plot the F-distribution and draw a vertical line to represent the observed F-statistic. This approach allows us to assess the position of the observed F-statistic within the distribution and determine the associated p-value.</p>
<div class="sourceCode" id="cb346"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html">df</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, df1 <span class="op">=</span> <span class="va">n_g</span> <span class="op">-</span> <span class="fl">1</span>, df2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df_anova</span><span class="op">)</span> <span class="op">-</span> <span class="va">n_g</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>,</span>
<span>             y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="co"># F distribution</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">f_value</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"salmon"</span><span class="op">)</span> <span class="co"># observed F-statistic</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:f-dist"></span>
<img src="biostats_files/figure-html/f-dist-1.png" alt="F-distribution. The vertical red line denotes the observed F-statistic." width="672"><p class="caption">
Figure 11.2: F-distribution. The vertical red line denotes the observed F-statistic.
</p>
</div>
<p>Unlike t-statistics, F-statistics can take only positive values (because F-statistics are the ratio of positive values). The p-value here is <span class="math inline">\(\Pr(F_0 &gt; F)\)</span>, where <span class="math inline">\(F_0\)</span> is the possible F-statistics under the null hypothesis. Let’s estimate this probability using <code><a href="https://rdrr.io/r/stats/Fdist.html">pf()</a></code>:</p>
<div class="sourceCode" id="cb347"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pf() estimate the probability of less than q</span></span>
<span><span class="co"># Pr(F0 &gt; F) is 1 - Pr(F0 &lt; F)</span></span>
<span><span class="va">p_value</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html">pf</a></span><span class="op">(</span>q <span class="op">=</span> <span class="va">f_value</span>, df1 <span class="op">=</span> <span class="va">n_g</span> <span class="op">-</span> <span class="fl">1</span>, df2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">df_anova</span><span class="op">)</span> <span class="op">-</span> <span class="va">n_g</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">p_value</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 0.00596054</code></pre>
</div>
</div>
<div id="anova-in-r" class="section level2" number="11.3">
<h2>
<span class="header-section-number">11.3</span> ANOVA in R<a class="anchor" aria-label="anchor" href="#anova-in-r"><i class="fas fa-link"></i></a>
</h2>
<p>Like the t-test, R provides functions to perform ANOVA easily. In this case, we will utilize the <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> function. The first argument of this function is the “formula,” which is used to describe the structure of the model. In our scenario, we aim to explain the fish body length by grouping them according to lakes. In the formula expression, we represent this relationship as <code>length ~ lake</code>, using the tilde symbol (~) to indicate the stochastic nature of the relationship.</p>
<div class="sourceCode" id="cb349"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># first argument is formula</span></span>
<span><span class="co"># second argument is data frame for reference</span></span>
<span><span class="co"># do not forget specify data = XXX! aov() refer to columns in the data frame</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">length</span> <span class="op">~</span> <span class="va">lake</span>,</span>
<span>         data <span class="op">=</span> <span class="va">df_anova</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Call:
##    aov(formula = length ~ lake, data = df_anova)
## 
## Terms:
##                      lake Residuals
## Sum of Squares   105.9365 1467.6454
## Deg. of Freedom         2       147
## 
## Residual standard error: 3.159744
## Estimated effects may be unbalanced</code></pre>
<p>The function returns <code>Sum of Squares</code> and <code>Deg. of Freedom</code> – these value matches what we have calculated. To get deeper insights, wrap the object with <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>:</p>
<div class="sourceCode" id="cb351"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## lake          2  105.9   52.97   5.305 0.00596 **
## Residuals   147 1467.6    9.98                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
<p>The F-statistic and p-value are identical to our manual estimate.</p>
</div>
<div id="post-hoc-tests" class="section level2" number="11.4">
<h2>
<span class="header-section-number">11.4</span> Post-hoc Tests<a class="anchor" aria-label="anchor" href="#post-hoc-tests"><i class="fas fa-link"></i></a>
</h2>
<p>When conducting an ANOVA and finding a significant difference among group means, a post-hoc test is often performed to determine which specific groups differ significantly from each other. Post-hoc tests help to identify pairwise comparisons that contribute to the observed overall difference.</p>
<p>There are several post-hoc tests available for ANOVA, including:</p>
<ol style="list-style-type: decimal">
<li><p>Tukey’s Honestly Significant Difference (HSD): This test compares all possible pairs of group means and provides adjusted p-values to control for the family-wise error rate. It is a commonly used and reliable post-hoc test.</p></li>
<li><p>Bonferroni correction: This method adjusts the significance level for each individual comparison to control the overall Type I error rate. The adjusted p-value is obtained by dividing the desired significance level (e.g., 0.05) by the number of comparisons.</p></li>
<li><p>Scheffe’s test: This test controls the family-wise error rate by considering all possible pairwise comparisons. It is more conservative than Tukey’s HSD, but it is suitable for cases where specific comparisons are of particular interest.</p></li>
<li><p>Dunnett’s test: This test is useful when comparing multiple groups against a control group. It controls the overall error rate by conducting multiple t-tests between the control group and each of the other groups.</p></li>
</ol>
<p>The choice of post-hoc test depends on the specific research question, assumptions, and desired control of the Type I error rate. It is important to select an appropriate test and interpret the results accordingly to draw valid conclusions about group differences in an ANOVA analysis.</p>
</div>
<div id="laboratory-4" class="section level2" number="11.5">
<h2>
<span class="header-section-number">11.5</span> Laboratory<a class="anchor" aria-label="anchor" href="#laboratory-4"><i class="fas fa-link"></i></a>
</h2>
<div id="application-to-plantgrowth" class="section level3" number="11.5.1">
<h3>
<span class="header-section-number">11.5.1</span> Application to <code>PlantGrowth</code><a class="anchor" aria-label="anchor" href="#application-to-plantgrowth"><i class="fas fa-link"></i></a>
</h3>
<p>In R, there is a built-in data set called <code>PlantGrowth</code>. To analyze this data set, carry out the following tasks:</p>
<ol style="list-style-type: decimal">
<li><p>The data set consists of two columns: weight, group. Create figures similar to Figure <a href="multiple-group-comparison.html#fig:violin">11.1</a>.</p></li>
<li><p>Conduct an ANOVA to examine whether there are differences in <code>weight</code> among the different <code>group</code>.</p></li>
<li><p>Discuss what values to be reported in a scientific article?</p></li>
</ol>
</div>
<div id="power-analysis" class="section level3" number="11.5.2">
<h3>
<span class="header-section-number">11.5.2</span> Power analysis<a class="anchor" aria-label="anchor" href="#power-analysis"><i class="fas fa-link"></i></a>
</h3>
<p>You’re planning to compare the mean plant biomass among three different wetlands using ANOVA. You expect a large effect size (Cohen’s <code>f = 0.5</code>) and want to achieve 80% power at a 0.05 significance level. How can you calculate the required sample size per group in R? You may use <code><a href="https://rdrr.io/pkg/pwr/man/pwr.anova.test.html">pwr::pwr.anova.test()</a></code> function in R (see arguments below).</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="25%">
<col width="25%">
<col width="25%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th align="left"><strong>Argument</strong></th>
<th align="left"><strong>Description</strong></th>
<th align="left"><strong>Example Value</strong></th>
<th align="left"><strong>Interpretation</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code>k</code></td>
<td align="left">Number of groups (levels of the independent variable)</td>
<td align="left"><code>3</code></td>
<td align="left">Comparing means across <strong>3 groups</strong> (e.g., three wetland treatments)</td>
</tr>
<tr class="even">
<td align="left"><code>f</code></td>
<td align="left">Effect size (Cohen’s <em>f</em>)</td>
<td align="left"><code>0.5</code></td>
<td align="left">Expected <strong>magnitude of group differences</strong>; 0.1 = small, 0.25 = medium, 0.4+ = large</td>
</tr>
<tr class="odd">
<td align="left"><code>sig.level</code></td>
<td align="left">Significance level (α)</td>
<td align="left"><code>0.05</code></td>
<td align="left">Probability of a <strong>Type I error</strong> — rejecting <em>H₀</em> when it’s actually true</td>
</tr>
<tr class="even">
<td align="left"><code>power</code></td>
<td align="left">Desired statistical power (1 − β)</td>
<td align="left"><code>0.8</code></td>
<td align="left">Probability of <strong>detecting a true effect</strong> if one exists (80 % is typical)</td>
</tr>
<tr class="odd">
<td align="left"><code>n</code></td>
<td align="left">Sample size per group</td>
<td align="left"><em>computed by function</em></td>
<td align="left">Returned by the function — number of observations needed per group</td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="two-group-comparison.html"><span class="header-section-number">10</span> Two-Group Comparison</a></div>
<div class="next"><a href="regression.html"><span class="header-section-number">12</span> Regression</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#multiple-group-comparison"><span class="header-section-number">11</span> Multiple-Group Comparison</a></li>
<li>
<a class="nav-link" href="#partition-the-variability"><span class="header-section-number">11.1</span> Partition the Variability</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#between-group-variability"><span class="header-section-number">11.1.1</span> Between-group variability</a></li>
<li><a class="nav-link" href="#within-group-variability"><span class="header-section-number">11.1.2</span> Within-group variability</a></li>
<li><a class="nav-link" href="#variability-to-variance"><span class="header-section-number">11.1.3</span> Variability to Variance</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#test-statistic-1"><span class="header-section-number">11.2</span> Test Statistic</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#f-statistic"><span class="header-section-number">11.2.1</span> F-statistic</a></li>
<li><a class="nav-link" href="#null-hypothesis-1"><span class="header-section-number">11.2.2</span> Null Hypothesis</a></li>
</ul>
</li>
<li><a class="nav-link" href="#anova-in-r"><span class="header-section-number">11.3</span> ANOVA in R</a></li>
<li><a class="nav-link" href="#post-hoc-tests"><span class="header-section-number">11.4</span> Post-hoc Tests</a></li>
<li>
<a class="nav-link" href="#laboratory-4"><span class="header-section-number">11.5</span> Laboratory</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#application-to-plantgrowth"><span class="header-section-number">11.5.1</span> Application to PlantGrowth</a></li>
<li><a class="nav-link" href="#power-analysis"><span class="header-section-number">11.5.2</span> Power analysis</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/aterui/biostats/blob/master/chapters/basics-05-anova.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/aterui/biostats/edit/master/chapters/basics-05-anova.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>BIOSTATS</strong>" was written by Akira Terui. It was last built on 2025-12-21.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
