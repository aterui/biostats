% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{book}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\usepackage[normalem]{ulem}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{5}
\usepackage{booktabs}
\usepackage{amsmath}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage[]{natbib}
\bibliographystyle{plainnat}
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={BIOSTATS},
  pdfauthor={Akira Terui},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{BIOSTATS}
\author{Akira Terui}
\date{Last updated on 2023-06-18}

\begin{document}
\maketitle

{
\setcounter{tocdepth}{1}
\tableofcontents
}
\hypertarget{introduction}{%
\chapter*{Introduction}\label{introduction}}
\addcontentsline{toc}{chapter}{Introduction}

This textbook is designed to provide a comprehensive introduction to fundamental statistical techniques and their practical applications in the context of biological data analysis. What sets this book apart is its ``flipped-order'' approach to teaching. Unlike traditional statistics courses that often begin with theoretical concepts, this book takes a different approach by initially presenting real-world data. By grounding the material in practical scenarios, it aims to make the learning process more accessible, particularly for those who are new to statistics.

Through the ``flipped-order'' introduction, readers will be able to engage with concrete examples of statistical methods in use before delving into the underlying theories and concepts that support them. This pedagogical approach aims to provide a solid foundation for readers to comprehend and apply statistical techniques effectively in the biological sciences.

\hypertarget{descriptive-statistics}{%
\chapter{Descriptive Statistics}\label{descriptive-statistics}}

Descriptive statistics are a set of summary measures that provide a concise overview of a dataset. They help us understand the characteristics and properties of the data without delving into complex statistical analyses. Some commonly used descriptive statistics include the mean, standard deviation, and median.

To illustrate the concept, let's consider fish length measurement \(x\). Each fish is identified by a subscript, and their lengths are denoted as follows:

\[
x_1 = 15.9\\
x_2 = 15.1\\
x_3 = 21.9\\
x_4 = 13.3\\
x_5 = 24.4\\
\] Often times, we use subscript \(i\) (or any character you like) instead of actual number to indicate a given data point. For example, we write fish length \(x_i\) for individual \(i\). Alternatively, instead of writing each individual data point, we can represent them as a vector using boldface, denoted as \(\pmb{x}\). In this case, the vector \(\pmb{x}\) can be expressed as:

\[
\pmb{x} = \{15.9, 15.1, 21.9, 13.3, 24.4\}
\]

Now let's see how we represent summary statistics of vector \(\pmb{x}\).

\hypertarget{central-tendency}{%
\section{Central Tendency}\label{central-tendency}}

\hypertarget{measures-of-central-tendency}{%
\subsection{Measures of Central Tendency}\label{measures-of-central-tendency}}

Central tendency measures (Table \ref{tab:central}) provide insights into the typical or central value of a dataset. There are three commonly used measures:

\begin{itemize}
\item
  \textbf{Arithmetic Mean}. This is the most commonly used measure of central tendency. It represents the \emph{additive} average of the data. To calculate the arithmetic mean, you sum up all the values and divide the total by the number of data points. It can be heavily influenced by extreme values, known as outliers.
\item
  \textbf{Geometric Mean}. The geometric mean is a \emph{multiplicative} average. It is always smaller than the arithmetic mean and less sensitive to unusually large values. However, it is not applicable when the data contain negative values.
\item
  \textbf{Median}. The median is the value that separates the higher half from the lower half of the dataset. It represents the 50th percentile data point. The median is less affected by outliers compared to the arithmetic mean. To calculate the median, you arrange the data in ascending order and select the middle value if the dataset has an odd number of values. If the dataset has an even number of values, you take the average of the two middle values.
\end{itemize}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.3750}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.6250}}@{}}
\caption{\label{tab:central} Common measures of central tendency. \(N\) refers to the number of data points.}\tabularnewline
\toprule()
\begin{minipage}[b]{\linewidth}\raggedright
Measure
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Formula
\end{minipage} \\
\midrule()
\endfirsthead
\toprule()
\begin{minipage}[b]{\linewidth}\raggedright
Measure
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Formula
\end{minipage} \\
\midrule()
\endhead
Arithmetic mean \(\mu\) & \(                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \frac{\sum_i^N x_i}{N}                                                                                                                                                                       
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \) \\
Geometric mean \(\mu_{ge}\) & \(                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      (\prod_i^N x_i)^{\frac{1}{N}}                                                                                                                                                                
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \) \\
Median \(\mu_{med}\) & \(                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \begin{aligned}                                                                                                                                                                              
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      &x_{(\frac{N + 1}{2}^\text{th})} &&\text{if N is odd number}\\                                                                                                                               
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      &\frac{1}{2}[x_{(\frac{N}{2}^\text{th})} + x_{(\frac{N}{2} + 1^\text{th})}] &&\text{if N is even number}                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      \end{aligned}\) \\
\bottomrule()
\end{longtable}

\hypertarget{r-exercise}{%
\subsection{R Exercise}\label{r-exercise}}

To learn more about these measures, let's create vectors \(\pmb{x} = \{15.9, 15.1, 21.9, 13.3, 24.4\}\) and \(\pmb{y} = \{15.9, 15.1, 21.9, 53.3, 24.4\}\) -- \(\pmb{y}\) is identical to \(\pmb{x}\) but contains one outlier value. How does this make difference? To construct vectors in R, we use \texttt{c()}, a function that stands for ``construct.'' Below is the script:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# construct vectors x and y}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FloatTok{15.9}\NormalTok{, }\FloatTok{15.1}\NormalTok{, }\FloatTok{21.9}\NormalTok{, }\FloatTok{13.3}\NormalTok{, }\FloatTok{24.4}\NormalTok{)}
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FloatTok{15.9}\NormalTok{, }\FloatTok{15.1}\NormalTok{, }\FloatTok{21.9}\NormalTok{, }\FloatTok{53.3}\NormalTok{, }\FloatTok{24.4}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Confirm you constructed them correctly:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 15.9 15.1 21.9 13.3 24.4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 15.9 15.1 21.9 53.3 24.4
\end{verbatim}

Cool! Now we can calculate summary statistics of \texttt{x} and \texttt{y}.

\textbf{Arithmetic mean}

While R has a function for arithmetic \texttt{mean()}, let's try to calculate the value from scratch:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# for vector x}
\NormalTok{n\_x }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(x) }\CommentTok{\# the number of elements in x = the number of data points}
\NormalTok{sum\_x }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(x) }\CommentTok{\# summation for x}
\NormalTok{mu\_x }\OtherTok{\textless{}{-}}\NormalTok{ sum\_x }\SpecialCharTok{/}\NormalTok{ n\_x }\CommentTok{\# arithmetic mean}
\FunctionTok{print}\NormalTok{(mu\_x) }\CommentTok{\# print calculated value}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 18.12
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# for vector y; we can calculate directly too}
\NormalTok{mu\_y }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(y) }\SpecialCharTok{/} \FunctionTok{length}\NormalTok{(y)}
\FunctionTok{print}\NormalTok{(mu\_y) }\CommentTok{\# print calculated value}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 26.12
\end{verbatim}

Compare with outputs from \texttt{mean()} :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\FunctionTok{mean}\NormalTok{(x))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 18.12
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\FunctionTok{mean}\NormalTok{(y))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 26.12
\end{verbatim}

\textbf{Geometric Mean}

Unfortunately, there is no build-in function for geometric mean \(\mu_{ge}\) in R (as far as I know; there are packages though). But, we can calculate the value from scratch again:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# for vector x}
\NormalTok{prod\_x }\OtherTok{\textless{}{-}} \FunctionTok{prod}\NormalTok{(x) }\CommentTok{\# product of vector x; x1 * x2 * x3...}
\NormalTok{n\_x }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(x)}
\NormalTok{mug\_x }\OtherTok{\textless{}{-}}\NormalTok{ prod\_x}\SpecialCharTok{\^{}}\NormalTok{(}\DecValTok{1} \SpecialCharTok{/}\NormalTok{ n\_x) }\CommentTok{\# \^{} means power}
\FunctionTok{print}\NormalTok{(mug\_x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 17.63648
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# for vector y}
\NormalTok{mug\_y }\OtherTok{\textless{}{-}} \FunctionTok{prod}\NormalTok{(y)}\SpecialCharTok{\^{}}\NormalTok{(}\DecValTok{1} \SpecialCharTok{/} \FunctionTok{length}\NormalTok{(y))}
\FunctionTok{print}\NormalTok{(mug\_y)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 23.28022
\end{verbatim}

\textbf{Median}

Lastly, let's do the same for median:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# for vector x}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{sort}\NormalTok{(x) }\CommentTok{\# sort x from small to large}
\NormalTok{index }\OtherTok{\textless{}{-}}\NormalTok{ (}\FunctionTok{length}\NormalTok{(x) }\SpecialCharTok{+} \DecValTok{1}\NormalTok{) }\SpecialCharTok{/} \DecValTok{2} \CommentTok{\# (N + 1)/2 th index as length(x) is an odd number}
\NormalTok{med\_x }\OtherTok{\textless{}{-}}\NormalTok{ x[index]}
\FunctionTok{print}\NormalTok{(med\_x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 15.9
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# for vector y}
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{sort}\NormalTok{(y) }\CommentTok{\# sort y from small to large}
\NormalTok{med\_y }\OtherTok{\textless{}{-}}\NormalTok{ y[(}\FunctionTok{length}\NormalTok{(y) }\SpecialCharTok{+} \DecValTok{1}\NormalTok{) }\SpecialCharTok{/} \DecValTok{2}\NormalTok{]}
\FunctionTok{print}\NormalTok{(med\_y)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 21.9
\end{verbatim}

Compare with outputs from \texttt{median()}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\FunctionTok{median}\NormalTok{(x))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 15.9
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(}\FunctionTok{median}\NormalTok{(y))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 21.9
\end{verbatim}

\hypertarget{variation}{%
\section{Variation}\label{variation}}

\hypertarget{measures-of-variation}{%
\subsection{Measures of Variation}\label{measures-of-variation}}

Variation measures (Table \ref{tab:variation}) provide information about the spread of data points.

\begin{itemize}
\item
  \textbf{Variance.} Variance is a statistical measure that quantifies the spread or dispersion of a dataset. It provides a numerical value that indicates how far individual data points in a dataset deviate from the mean or average value. In other words, variance measures the average squared difference between each data point and the mean. \textbf{Standard deviation (SD) is the square root of variance}.
\item
  \textbf{Inter-Quantile Range.} The interquartile range (IQR) is a statistical measure that provides information about the spread or dispersion of a dataset, specifically focusing on the middle 50\% of the data. It is a robust measure of variability that is less affected by outliers compared to variance.
\item
  \textbf{Median Absolute Deviation.} Median Absolute Deviation (MAD) is similar to variance, but provides a robust estimation of variability that is less affected by outliers compared to variance. MAD is defined as the median of the absolute deviations from the data's median.
\item
  \textbf{Coefficient of Variation.} The coefficient of variation (CV) is a statistical measure that expresses the relative variability of a dataset in relation to its mean. It is particularly useful when comparing the variability of different datasets that have different scales or units of measurement.
\item
  \textbf{MAD/Median.} MAD/Median is a statistical measure used to assess the relative variability of a dataset without assuming any specific distribution or parametric model. CV is sensitive to outliers because of its reliance on the arithmetic mean. However, MAD/Median is robust to this issue.
\end{itemize}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.3889}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.6111}}@{}}
\caption{\label{tab:variation} Common measures of variation. \(N\) refers to the number of data points.}\tabularnewline
\toprule()
\begin{minipage}[b]{\linewidth}\raggedright
Measure
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Formula
\end{minipage} \\
\midrule()
\endfirsthead
\toprule()
\begin{minipage}[b]{\linewidth}\raggedright
Measure
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Formula
\end{minipage} \\
\midrule()
\endhead
Variance \(\sigma^2\) (standard deviation \(\sigma\)) & \(                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \frac{\sum_i^N (x_i - \mu)^2}{N}                                                                       
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \) \\
Inter-Quantile Range IQR (\(x_l\) and \(x_h\) are \(l^{th}\) and \(h^{th}\) percentiles, respectively) & \(                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |x_{l} - x_{h}|                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \) \\
Median Absolute Deviation (MAD) & \(                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \text{Median}(|x_i-\mu_{med}|)                                                                         
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \) \\
Coefficient of Variation (CV) & \(                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \frac{\sigma}{\mu}                                                                                     
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \) \\
MAD/Median & \(                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \frac{\text{MAD}}{\mu_{med}}                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  \) \\
\bottomrule()
\end{longtable}

\hypertarget{r-exercise-1}{%
\subsection{R Exercise}\label{r-exercise-1}}

\textbf{Variance, SD, and CV}

Let's try variance, SD, and CV:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# for x}
\NormalTok{sqd\_x }\OtherTok{\textless{}{-}}\NormalTok{ (x }\SpecialCharTok{{-}} \FunctionTok{mean}\NormalTok{(x))}\SpecialCharTok{\^{}}\DecValTok{2} \CommentTok{\# sqared deviance}
\NormalTok{sum\_sqd\_x }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(sqd\_x)}

\NormalTok{var\_x }\OtherTok{\textless{}{-}}\NormalTok{ sum\_sqd\_x }\SpecialCharTok{/} \FunctionTok{length}\NormalTok{(x)}
\NormalTok{sd\_x }\OtherTok{\textless{}{-}} \FunctionTok{sqrt}\NormalTok{(var\_x) }\CommentTok{\# sqrt(): square root}
\NormalTok{cv\_x }\OtherTok{\textless{}{-}}\NormalTok{ sd\_x }\SpecialCharTok{/} \FunctionTok{mean}\NormalTok{(x)}

\FunctionTok{print}\NormalTok{(var\_x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 18.2016
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(sd\_x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 4.266333
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(cv\_x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.2354489
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# for y}
\NormalTok{var\_y }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{((y }\SpecialCharTok{{-}} \FunctionTok{mean}\NormalTok{(y))}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }\SpecialCharTok{/} \FunctionTok{length}\NormalTok{(y)}
\NormalTok{sd\_y }\OtherTok{\textless{}{-}} \FunctionTok{sqrt}\NormalTok{(var\_y)}
\NormalTok{cv\_y }\OtherTok{\textless{}{-}}\NormalTok{ sd\_y }\SpecialCharTok{/} \FunctionTok{mean}\NormalTok{(y)}

\FunctionTok{print}\NormalTok{(var\_y)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 197.0816
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(sd\_y)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 14.03858
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(cv\_y)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.5374646
\end{verbatim}

\textbf{IQR, MAD, and MAD/Median}

Let's try IQR, MAD, and MAD/Median. IQR can be defined for given percentiles. Here, let me use 25 and 75 percentiles as \(x_l\) and \(x_h\).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# for x}
\DocumentationTok{\#\# IQR}
\NormalTok{x\_l }\OtherTok{\textless{}{-}} \FunctionTok{quantile}\NormalTok{(x, }\FloatTok{0.25}\NormalTok{) }\CommentTok{\# quantile(): return quantile values, 25 percentile}
\NormalTok{x\_h }\OtherTok{\textless{}{-}} \FunctionTok{quantile}\NormalTok{(x, }\FloatTok{0.75}\NormalTok{) }\CommentTok{\# quantile(): return quantile values, 75 percentile}
\NormalTok{iqr\_x }\OtherTok{\textless{}{-}} \FunctionTok{abs}\NormalTok{(x\_l }\SpecialCharTok{{-}}\NormalTok{ x\_h) }\CommentTok{\# abs(): absolute value}

\DocumentationTok{\#\# MAD}
\NormalTok{ad\_x }\OtherTok{\textless{}{-}} \FunctionTok{abs}\NormalTok{(x }\SpecialCharTok{{-}} \FunctionTok{mean}\NormalTok{(x))}
\NormalTok{mad\_x }\OtherTok{\textless{}{-}} \FunctionTok{median}\NormalTok{(ad\_x)}

\DocumentationTok{\#\# MAD/median}
\NormalTok{mad\_m\_x }\OtherTok{\textless{}{-}}\NormalTok{ mad\_x }\SpecialCharTok{/} \FunctionTok{median}\NormalTok{(x)}

\FunctionTok{print}\NormalTok{(iqr\_x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 25% 
## 6.8
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(mad\_x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3.78
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(mad\_m\_x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.2377358
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# for y}
\DocumentationTok{\#\# IQR}
\NormalTok{y\_q }\OtherTok{\textless{}{-}} \FunctionTok{quantile}\NormalTok{(y, }\FunctionTok{c}\NormalTok{(}\FloatTok{0.25}\NormalTok{, }\FloatTok{0.75}\NormalTok{)) }\CommentTok{\# return as a vector}
\NormalTok{iqr\_y }\OtherTok{\textless{}{-}} \FunctionTok{abs}\NormalTok{(y\_q[}\DecValTok{1}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{ y\_q[}\DecValTok{2}\NormalTok{]) }\CommentTok{\# y\_q[1] = 25 percentile; y\_q[2] = 75 percentile}

\DocumentationTok{\#\# MAD}
\NormalTok{mad\_y }\OtherTok{\textless{}{-}} \FunctionTok{median}\NormalTok{(}\FunctionTok{abs}\NormalTok{(y }\SpecialCharTok{{-}} \FunctionTok{mean}\NormalTok{(y)))}

\DocumentationTok{\#\# MAD/median}
\NormalTok{mad\_m\_y }\OtherTok{\textless{}{-}}\NormalTok{ mad\_y }\SpecialCharTok{/} \FunctionTok{median}\NormalTok{(y)}

\FunctionTok{print}\NormalTok{(iqr\_y)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 25% 
## 8.5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(mad\_y)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 10.22
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(mad\_m\_y)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.4666667
\end{verbatim}

\hypertarget{laboratory}{%
\section{Laboratory}\label{laboratory}}

\hypertarget{comparing-central-tendency-measures}{%
\subsection{Comparing Central Tendency Measures}\label{comparing-central-tendency-measures}}

What are the differences of the three measures of central tendency? To investigate this further, let's perform the following exercise.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Create a new vector \texttt{z} with length \(1000\) as \texttt{exp(rnorm(n\ =\ 1000,\ mean\ =\ 0,\ sd\ =\ 0.1))}, and calculate the arithmetic mean, geometric mean, and median.
\item
  Draw a histogram of \texttt{z} using functions \texttt{tibble()}, \texttt{ggplot()}, and \texttt{geom\_histogram()}.
\item
  Draw vertical lines of arithmetic mean, geometric mean, and median on the histogram with different colors using a function \texttt{geom\_vline()} .
\item
  Compare the values of the central tendency measures.
\item
  Create a new vector \texttt{z\_rev} as \texttt{-z\ +\ max(z)\ +\ 0.1}, and repeat step 1 -- 4.
\end{enumerate}

\hypertarget{comparing-variation-measures}{%
\subsection{Comparing Variation Measures}\label{comparing-variation-measures}}

Why do we have absolute (variance, SD, MAD, IQR) and relative measures (CV, MAD/Median) of variation? To understand this, suppose we have 100 measurements of fish weight in unit ``gram.'' (\texttt{w} in the following script)

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{w }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{100}\NormalTok{, }\AttributeTok{mean =} \DecValTok{10}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{)}
\FunctionTok{head}\NormalTok{(w) }\CommentTok{\# show first 10 elements in w}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  9.237455  9.171337 10.834474  9.032348  9.971185 10.232525
\end{verbatim}

Using this data, perform the following exercise:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Convert the unit of \texttt{w} to ``milligram'' and create a new vector \texttt{m}.
\item
  Calculate SD and MAD for \texttt{w} and \texttt{m}.
\item
  Calculate CV and MAD/Median for \texttt{w} and \texttt{m}.
\end{enumerate}

\hypertarget{sampling}{%
\chapter{Sampling}\label{sampling}}

\emph{``Why do I need statistics in the first place?''} This was the initial question that arose when I entered the field of ecology. Initially, I assumed it would be a straightforward query with an immediate response. However, I soon realized that it is a profound question with a complex answer. In short, ``we need statistics because we often possess only partial information about what we seek to understand.'' Now, let's explore the more elaborate explanation below.

\hypertarget{the-unknown-garden-plant-example}{%
\section{The Unknown: Garden Plant Example}\label{the-unknown-garden-plant-example}}

Consider a scenario where we are conducting a study on plant height in a garden. In this garden, there exists a thousand of individual plants, making it impractical for a single researcher to measure all of them. Instead, due to resource limitations, a sample of \(10\) plants was selected to \textbf{\emph{calculate}} the average height and the extent of variation among these plant individuals:

\begin{verbatim}
## # A tibble: 10 x 4
##     ...1 plant_id height unit 
##    <dbl>    <dbl>  <dbl> <chr>
##  1     1        1   16.9 cm   
##  2     2        2   20.9 cm   
##  3     3        3   15.8 cm   
##  4     4        4   28   cm   
##  5     5        5   21.6 cm   
##  6     6        6   15.9 cm   
##  7     7        7   22.4 cm   
##  8     8        8   23.7 cm   
##  9     9        9   22.9 cm   
## 10    10       10   18.5 cm
\end{verbatim}

Cool. Let's use this data set to learn about the pitfall behind this. Create a vector of plant height \texttt{h} and put it in a \texttt{tibble()} to analyze it:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{h }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FloatTok{16.9}\NormalTok{, }\FloatTok{20.9}\NormalTok{, }\FloatTok{15.8}\NormalTok{, }\DecValTok{28}\NormalTok{, }\FloatTok{21.6}\NormalTok{, }\FloatTok{15.9}\NormalTok{, }\FloatTok{22.4}\NormalTok{, }\FloatTok{23.7}\NormalTok{, }\FloatTok{22.9}\NormalTok{, }\FloatTok{18.5}\NormalTok{)}

\NormalTok{df\_h1 }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{plant\_id =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{, }\CommentTok{\# a vector from 1 to 10 by 1}
                \AttributeTok{height =}\NormalTok{ h, }\CommentTok{\# height}
                \AttributeTok{unit =} \StringTok{"cm"}\NormalTok{) }\CommentTok{\# unit}
\end{Highlighting}
\end{Shaded}

This format (\texttt{tibble()}) is better than a raw vector of height because it allows more flexible analysis. Let's add columns of \texttt{mu\_height} and \texttt{var\_height} using \texttt{mutate()}, a function that adds new column(s) to an existing \texttt{tibble()} (or \texttt{data.frame()}):

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# nrow() returns the number of rows}
\CommentTok{\# while piping, "." refers to the dataframe inherited }
\CommentTok{\# i.e., nrow(.) counts the number of rows in df\_h1}
\NormalTok{df\_h1 }\OtherTok{\textless{}{-}}\NormalTok{ df\_h1 }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{mu\_height =} \FunctionTok{mean}\NormalTok{(height),}
         \AttributeTok{var\_height =} \FunctionTok{sum}\NormalTok{((height }\SpecialCharTok{{-}}\NormalTok{ mu\_height)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }\SpecialCharTok{/} \FunctionTok{nrow}\NormalTok{(.))}
\end{Highlighting}
\end{Shaded}

Awesome, we were able to get the average height and the variance! -- \textbf{however, how confident are you?} We obtained plant height only from 10\ldots out of 1000. Are they different if we measure another set of 10 plant individuals? Let's see:

\begin{verbatim}
## # A tibble: 10 x 4
##     ...1 plant_id height unit 
##    <dbl>    <dbl>  <dbl> <chr>
##  1    11       11   27.6 cm   
##  2    12       12   21.9 cm   
##  3    13       13   16.9 cm   
##  4    14       14    8.9 cm   
##  5    15       15   25.6 cm   
##  6    16       16   19.8 cm   
##  7    17       17   19.9 cm   
##  8    18       18   24.7 cm   
##  9    19       19   24.1 cm   
## 10    20       20   23   cm
\end{verbatim}

Create another \texttt{tibble()} :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{h }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FloatTok{27.6}\NormalTok{, }\FloatTok{21.9}\NormalTok{, }\FloatTok{16.9}\NormalTok{, }\FloatTok{8.9}\NormalTok{, }\FloatTok{25.6}\NormalTok{, }\FloatTok{19.8}\NormalTok{, }\FloatTok{19.9}\NormalTok{, }\FloatTok{24.7}\NormalTok{, }\FloatTok{24.1}\NormalTok{, }\DecValTok{23}\NormalTok{)}

\NormalTok{df\_h2 }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{plant\_id =} \DecValTok{11}\SpecialCharTok{:}\DecValTok{20}\NormalTok{, }\CommentTok{\# a vector from 11 to 20 by 1}
                \AttributeTok{height =}\NormalTok{ h,}
                \AttributeTok{unit =} \StringTok{"cm"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{mu\_height =} \FunctionTok{mean}\NormalTok{(height),}
         \AttributeTok{var\_height =} \FunctionTok{sum}\NormalTok{((height }\SpecialCharTok{{-}}\NormalTok{ mu\_height)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }\SpecialCharTok{/} \FunctionTok{nrow}\NormalTok{(.))}

\FunctionTok{print}\NormalTok{(df\_h2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 10 x 5
##    plant_id height unit  mu_height var_height
##       <int>  <dbl> <chr>     <dbl>      <dbl>
##  1       11   27.6 cm         21.2       25.8
##  2       12   21.9 cm         21.2       25.8
##  3       13   16.9 cm         21.2       25.8
##  4       14    8.9 cm         21.2       25.8
##  5       15   25.6 cm         21.2       25.8
##  6       16   19.8 cm         21.2       25.8
##  7       17   19.9 cm         21.2       25.8
##  8       18   24.7 cm         21.2       25.8
##  9       19   24.1 cm         21.2       25.8
## 10       20   23   cm         21.2       25.8
\end{verbatim}

Wow, that's totally different.

\hypertarget{linking-part-to-the-whole}{%
\section{Linking Part to the Whole}\label{linking-part-to-the-whole}}

The exercise highlights an important takeaway: what we can determine from the above data is the average and variance of the sample, \textbf{which may not perfectly represent the characteristics of the entire garden.}

In the field of biological research, it is often impractical or impossible to sample the entire population, so we must rely on estimating the unknowns (in this case, the \emph{mean} and \emph{variance}) from the available samples. This is where statistics comes into play, offering a tool to infer information about the entire population based on partial information obtained from the samples.

The unknowns we are interested in, which the population mean and variance in this example, are referred to as ``\textbf{parameters.}'' These parameters \uline{\emph{cannot be directly measured}} but can be \uline{\emph{estimated}} from samples through statistical inference.

Provided that certain assumptions are met, the \emph{sample mean} is the unbiased point estimate of the \emph{population} \emph{mean}. The \textbf{``\emph{unbiased}''} means that the sample means -- if we repeat the sampling process -- are centered around the population mean. In the meantime, the sample variance -- if we use the formula in Chapter \ref{descriptive-statistics} -- is ``\textbf{\emph{biased}}.'' It tends to be smaller than the population variance.

Let's explore this concept further through simple simulations. Suppose we have data on a thousand plant individuals, although this scenario may be unrealistic in practice. However, by conducting these simulations, we can examine how different sample means and variances can deviate from the true values.

Download the data \href{https://github.com/aterui/biostats/blob/master/data_raw/data_plant_height.csv}{here} containing height measurements of thousand individuals, and place this file under \texttt{data\_raw/} in your project directory. You can load this \texttt{csv} file in R as follows:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# load csv data on R}
\NormalTok{df\_h0 }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"data\_raw/data\_plant\_height.csv"}\NormalTok{)}

\CommentTok{\# show the first 10 rows}
\FunctionTok{print}\NormalTok{(df\_h0)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 1,000 x 4
##     ...1 plant_id height unit 
##    <dbl>    <dbl>  <dbl> <chr>
##  1     1        1   16.9 cm   
##  2     2        2   20.9 cm   
##  3     3        3   15.8 cm   
##  4     4        4   28   cm   
##  5     5        5   21.6 cm   
##  6     6        6   15.9 cm   
##  7     7        7   22.4 cm   
##  8     8        8   23.7 cm   
##  9     9        9   22.9 cm   
## 10    10       10   18.5 cm   
## # i 990 more rows
\end{verbatim}

Using this synthetic dataset (I generated through a random value generator), we can calculate the true mean and variance (reference values). It is important to note that in this case, we use the term ``calculate'' for the mean and variance because they represent the parameters of the entire population, which are known to us in this scenario.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mu }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(df\_h0}\SpecialCharTok{$}\NormalTok{height)}
\NormalTok{sigma2 }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{((df\_h0}\SpecialCharTok{$}\NormalTok{height }\SpecialCharTok{{-}}\NormalTok{ mu)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }\SpecialCharTok{/} \FunctionTok{nrow}\NormalTok{(df\_h0)}

\FunctionTok{print}\NormalTok{(mu)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 19.9426
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(sigma2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 26.74083
\end{verbatim}

We can simulate the sampling of 10 plant individuals by randomly selecting 10 rows from \texttt{df\_h0}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_i }\OtherTok{\textless{}{-}}\NormalTok{ df\_h0 }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{sample\_n}\NormalTok{(}\AttributeTok{size =} \DecValTok{10}\NormalTok{) }\CommentTok{\# size specifies the number of rows to be selected randomly}

\FunctionTok{print}\NormalTok{(df\_i)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 10 x 4
##     ...1 plant_id height unit 
##    <dbl>    <dbl>  <dbl> <chr>
##  1   308      308   22.8 cm   
##  2   461      461   17.7 cm   
##  3   602      602   27.5 cm   
##  4   181      181   13.8 cm   
##  5   488      488   14.8 cm   
##  6   565      565   17   cm   
##  7   302      302   14.8 cm   
##  8    96       96   22.8 cm   
##  9   853      853   14.8 cm   
## 10   987      987   15.9 cm
\end{verbatim}

Since \texttt{sample\_n()} selects rows randomly, you will (very likely) get different set of 10 individuals/rows every single time. Below is another set of 10 rows (notice that \texttt{df\_i} is overwritten with the new data set):

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_i }\OtherTok{\textless{}{-}}\NormalTok{ df\_h0 }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{sample\_n}\NormalTok{(}\AttributeTok{size =} \DecValTok{10}\NormalTok{)}

\FunctionTok{print}\NormalTok{(df\_i)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 10 x 4
##     ...1 plant_id height unit 
##    <dbl>    <dbl>  <dbl> <chr>
##  1   962      962   19.9 cm   
##  2   618      618   11   cm   
##  3   614      614   13   cm   
##  4   735      735   22.1 cm   
##  5   215      215   24.9 cm   
##  6    32       32   19.5 cm   
##  7   230      230   21.3 cm   
##  8   367      367   23.4 cm   
##  9   270      270   15.3 cm   
## 10   524      524   21   cm
\end{verbatim}

Let's obtain 100 sets of 10 plant individuals (randomly selected) and \emph{estimate} the mean and variance in each. While we can perform random sampling one by one, this is cumbersome -- at least, I do not want to do it. Instead, we can leverage a technique of \texttt{for} loop:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# for reproducibility}
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{3}\NormalTok{)}

\NormalTok{mu\_i }\OtherTok{\textless{}{-}}\NormalTok{ var\_i }\OtherTok{\textless{}{-}} \ConstantTok{NULL} \CommentTok{\# create empty objects}

\CommentTok{\# repeat the work in \{\} from i = 1 to i = 100}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{100}\NormalTok{) \{}
  
\NormalTok{  df\_i }\OtherTok{\textless{}{-}}\NormalTok{ df\_h0 }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{sample\_n}\NormalTok{(}\AttributeTok{size =} \DecValTok{10}\NormalTok{) }\CommentTok{\# random samples of 10 individuals}
  
  \CommentTok{\# save mean for sample set i}
\NormalTok{  mu\_i[i] }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(df\_i}\SpecialCharTok{$}\NormalTok{height)}
  
  \CommentTok{\# save variance for sample set i}
\NormalTok{  var\_i[i] }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{((df\_i}\SpecialCharTok{$}\NormalTok{height }\SpecialCharTok{{-}} \FunctionTok{mean}\NormalTok{(df\_i}\SpecialCharTok{$}\NormalTok{height))}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }\SpecialCharTok{/} \FunctionTok{nrow}\NormalTok{(df\_i) }
  
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Take a look at \texttt{mu\_i} and \texttt{var\_i} :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(mu\_i)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   [1] 19.97 17.86 22.55 22.03 17.00 23.28 21.33 21.23 18.55 19.29 22.14 19.84
##  [13] 22.43 22.13 21.13 19.40 19.39 20.43 19.12 20.66 21.01 19.48 21.73 19.63
##  [25] 21.03 20.60 21.11 20.42 18.76 23.70 20.31 22.22 21.34 20.70 20.96 20.03
##  [37] 21.77 19.19 19.87 21.38 19.64 23.31 19.89 19.21 19.68 19.54 17.54 19.05
##  [49] 18.91 20.57 18.33 18.07 19.48 17.70 20.24 17.74 20.45 16.48 18.93 17.60
##  [61] 17.23 20.75 18.06 20.06 20.80 21.72 19.02 25.08 18.90 20.69 23.28 20.87
##  [73] 18.65 19.74 21.47 17.95 16.98 18.30 19.77 17.25 19.60 21.27 19.28 20.42
##  [85] 19.60 18.41 20.15 21.24 19.70 21.56 20.75 19.54 17.54 18.52 19.85 18.40
##  [97] 20.39 17.07 17.84 20.66
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(var\_i)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   [1] 14.1961 21.6884 28.2685 21.6341  6.5700 24.5996 23.6941 24.8681 21.6485
##  [10] 36.3689 17.8844 31.5784 21.0521 34.2341 20.6281 10.4420 20.0469 31.2781
##  [19] 32.0316 23.0964  9.8789 31.8916 28.3061 19.6861  8.2641 23.3640 26.8769
##  [28] 48.9416 27.7644 42.4220 38.4989 12.7076 15.9004  8.6740 11.7284 26.2061
##  [37] 21.7461 25.9269 28.0421  6.2616 16.5584 27.7489 17.3609 23.1349 38.6936
##  [46] 25.0984 13.5864 25.2625  7.7149 17.5341 11.4681 38.1561 12.6376 42.5480
##  [55] 31.9224 13.9824 14.9725 25.8296 33.6781  8.2440 31.4741 29.7805 26.7324
##  [64] 47.3704 26.8660 24.0536 29.5076 23.7376 14.8000 51.8449 13.3536 18.5581
##  [73] 18.9185 12.4544 36.2201 16.3225 17.9236 42.8760 18.5421 22.0205 34.1680
##  [82] 28.8841 26.6976 22.7356 35.2900 19.2229 34.3905 17.3784 23.1880 42.4264
##  [91] 18.5365 18.5424 21.5204 13.1276 17.7185 21.2940 27.1649 35.3141 43.5624
## [100] 55.1484
\end{verbatim}

In each element of \texttt{mu\_i} and \texttt{var\_i}, we have saved estimated mean (\(\hat{\mu}\); reads mu hat) and variance (\(\hat{\sigma^2}\)) of 10 plant height measures for dataset \texttt{i}. By drawing a histogram of these values, we can examine the distributions of mean and variance estimates. I use R package \texttt{patchwork} to make a better figure:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#install.packages("patchwork") \# install only once}
\FunctionTok{library}\NormalTok{(patchwork)}

\NormalTok{df\_sample }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{mu\_hat =}\NormalTok{ mu\_i, }\AttributeTok{var\_hat =}\NormalTok{ var\_i)}

\CommentTok{\# histogram for mean}
\NormalTok{g\_mu }\OtherTok{\textless{}{-}}\NormalTok{ df\_sample }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ mu\_hat)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_vline}\NormalTok{(}\AttributeTok{xintercept =}\NormalTok{ mu)}

\CommentTok{\# histogram for variance}
\NormalTok{g\_var }\OtherTok{\textless{}{-}}\NormalTok{ df\_sample }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ var\_hat)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_vline}\NormalTok{(}\AttributeTok{xintercept =}\NormalTok{ sigma2)}

\CommentTok{\# layout vertically}
\CommentTok{\# possible only if "patchwork" is loaded}
\NormalTok{g\_mu }\SpecialCharTok{/}\NormalTok{ g\_var}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{_main_files/figure-latex/mu-var-dist-1} 

}

\caption{Sample mean and biased variance.}\label{fig:mu-var-dist}
\end{figure}

While sample means are indeed symmetrically distributed around the true mean, sample variances tend to be biased and skewed to the right, often underestimating the true variance.

The bias in estimating the variance arises due to inferring the parameter from a small number of samples. However, there is good news: an unbiased estimator of variance exists. The formula for the unbiased estimator of variance is as follows:

\[
\frac{\sum_i^N (x_i - \mu)^2}{N-1}
\]

The correction in the denominator (\(N\) replaced with \(N-1\)) compensates for the bias, providing an estimate of the true variance without systematic underestimation (although this seems a simple correction, a \href{https://en.wikipedia.org/wiki/Bessel\%27s_correction}{deep math} underlies the derivation of \(N-1\)). This is the default formula in \texttt{var()} in R, a function used to estimate \emph{unbiased} variance (and \emph{unbiased} SD \texttt{sd()}). Comparison reveals how this works:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# for reproducibility}
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{3}\NormalTok{)}

\CommentTok{\# redo simulations {-}{-}{-}{-}}
\NormalTok{mu\_i }\OtherTok{\textless{}{-}}\NormalTok{ var\_i }\OtherTok{\textless{}{-}}\NormalTok{ var\_ub\_i }\OtherTok{\textless{}{-}} \ConstantTok{NULL} \CommentTok{\# create empty objects}

\CommentTok{\# repeat the work in \{\} from i = 1 to i = 100}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{100}\NormalTok{) \{}
  
\NormalTok{  df\_i }\OtherTok{\textless{}{-}}\NormalTok{ df\_h0 }\SpecialCharTok{\%\textgreater{}\%} 
    \FunctionTok{sample\_n}\NormalTok{(}\AttributeTok{size =} \DecValTok{10}\NormalTok{) }\CommentTok{\# random samples of 10 individuals}
  
  \CommentTok{\# save mean for sample set i}
\NormalTok{  mu\_i[i] }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(df\_i}\SpecialCharTok{$}\NormalTok{height)}
  
  \CommentTok{\# save variance for sample set i}
\NormalTok{  var\_i[i] }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{((df\_i}\SpecialCharTok{$}\NormalTok{height }\SpecialCharTok{{-}} \FunctionTok{mean}\NormalTok{(df\_i}\SpecialCharTok{$}\NormalTok{height))}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }\SpecialCharTok{/} \FunctionTok{nrow}\NormalTok{(df\_i) }
  
\NormalTok{  var\_ub\_i[i] }\OtherTok{\textless{}{-}} \FunctionTok{var}\NormalTok{(df\_i}\SpecialCharTok{$}\NormalTok{height)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

Add the histogram of unbiased variance:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# draw histograms {-}{-}{-}{-}}
\NormalTok{df\_sample }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{mu\_hat =}\NormalTok{ mu\_i,}
                    \AttributeTok{var\_hat =}\NormalTok{ var\_i,}
                    \AttributeTok{var\_ub\_hat =}\NormalTok{ var\_ub\_i)}

\CommentTok{\# histogram for mu}
\NormalTok{g\_mu }\OtherTok{\textless{}{-}}\NormalTok{ df\_sample }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ mu\_hat)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_vline}\NormalTok{(}\AttributeTok{xintercept =}\NormalTok{ mu)}

\CommentTok{\# histogram for variance}
\CommentTok{\# scale\_x\_continuous() adjusts scale in x{-}axis}
\NormalTok{g\_var }\OtherTok{\textless{}{-}}\NormalTok{ df\_sample }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ var\_hat)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_vline}\NormalTok{(}\AttributeTok{xintercept =}\NormalTok{ sigma2) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{limits=} \FunctionTok{c}\NormalTok{(}\FunctionTok{min}\NormalTok{(}\FunctionTok{c}\NormalTok{(var\_i, var\_ub\_i)),}
                               \FunctionTok{max}\NormalTok{(}\FunctionTok{c}\NormalTok{(var\_i, var\_ub\_i))))}

\CommentTok{\# histogram for unbiased variance}
\NormalTok{g\_var\_ub }\OtherTok{\textless{}{-}}\NormalTok{ df\_sample }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ var\_ub\_hat)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_vline}\NormalTok{(}\AttributeTok{xintercept =}\NormalTok{ sigma2) }\SpecialCharTok{+}
  \FunctionTok{scale\_x\_continuous}\NormalTok{(}\AttributeTok{limits=} \FunctionTok{c}\NormalTok{(}\FunctionTok{min}\NormalTok{(}\FunctionTok{c}\NormalTok{(var\_i, var\_ub\_i)),}
                               \FunctionTok{max}\NormalTok{(}\FunctionTok{c}\NormalTok{(var\_i, var\_ub\_i))))}

\NormalTok{g\_mu }\SpecialCharTok{/}\NormalTok{ g\_var }\SpecialCharTok{/}\NormalTok{ g\_var\_ub}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{_main_files/figure-latex/var-ub-1} 

}

\caption{Comparison of biased and unbiased variances.}\label{fig:var-ub}
\end{figure}

In summary, samples can only provide information about a part of the whole population. The complete picture of the entire population is often unknown, and \textbf{we rely on estimating key parameters from the available samples.} This concept applies to a wide range of parametric analyses in statistics, where we use sample data to make inferences about the population parameters.

Recognizing the limitations and uncertainties associated with working with samples is essential for proper statistical analysis and interpretation of results in various fields of study.

\hypertarget{laboratory-1}{%
\section{Laboratory}\label{laboratory-1}}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  We used 10 plants to estimate sample means and variances. Obtain 100 sub-datasets with 50 and 100 measures each, and draw histograms of sample means and unbiased variances (use \texttt{var()}).
\item
  Sample means and unbiased variances are unbiased if samples are randomly selected. What happens if samples are non-random? Suppose the investigator was unable to find plants less than 10 cm in height -- the following code excludes those less than 10 cm in height:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_h10 }\OtherTok{\textless{}{-}}\NormalTok{ df\_h0 }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(height }\SpecialCharTok{\textgreater{}=} \DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

  Repeat step 1 with \texttt{df\_h10} instead of \texttt{df\_h0} and compare the results.
\end{enumerate}

\hypertarget{probabilistic-view}{%
\chapter{Probabilistic View}\label{probabilistic-view}}

Chapter \ref{sampling} emphasized the concept of sampling and introduced the crucial aspect of statistics: randomness. Although the mean represents the central tendency of the data, it does not encompass all the data points. Inevitable deviations occur, and we need a way to express this ``randomness.'' The concept of probability distributions aids in fully understanding the stochastic nature of observed data.

\hypertarget{probability-distribution-of-a-continuous-variable}{%
\section{Probability Distribution of a Continuous Variable}\label{probability-distribution-of-a-continuous-variable}}

\hypertarget{probability-density-function}{%
\subsection{Probability Density Function}\label{probability-density-function}}

Let me use the plant height example in Chapter \ref{sampling}:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# load csv data on R}
\NormalTok{df\_h0 }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"data\_raw/data\_plant\_height.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

While Chapter \ref{sampling} primarily focused on exploring mean and variance, let's broaden our perspective to gain a comprehensive understanding of the entire distribution of height.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_h0 }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ height)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+} \CommentTok{\# specify binwidth}
  \FunctionTok{geom\_vline}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{xintercept =} \FunctionTok{mean}\NormalTok{(height))) }\CommentTok{\# draw vertical line at the mean}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{_main_files/figure-latex/histogram-height-1} 

}

\caption{Distribution of plant height}\label{fig:histogram-height}
\end{figure}

This distribution comprises a thousand height measurements. However, there are certain patterns to consider. The data is centered around the mean and exhibits a symmetrical distribution. This characteristic implies that the distribution can be approximated by a simple formula that relies on only a few \emph{key parameters}.

In statistics, the symmetrical bell-shaped form is commonly approximated by a Normal distribution, often denoted as ``\emph{variable} \(x\) \emph{is assumed to follow a Normal distribution.}'' We express this using the following mathematical expression:

\[
x \sim Normal(\mu, \sigma^2)
\]

Unlike an ``equation,'' we do not use the ``\(=\)'' sign because variable \(x\) is not equivalent to the Normal distribution. Rather, it represents a ``stochastic'' relationship that signifies the probability of \(x\) taking on a specific range of values.

A Normal distribution is characterized by two parameters: the mean and the variance. Once these parameters are determined, the formula that defines the Normal distribution will yield the probability density for a given range of values. This formula \(f(x)\) is known as the \textbf{probability density function (PDF)} and is displayed below:

\[
f(x) = \frac{1}{\sqrt{2 \pi} \sigma} \exp\left(-\frac{(x-\mu)^2}{2\sigma^2}\right)
\]

\hypertarget{pdf-to-frequency-distribution}{%
\subsection{PDF to frequency distribution}\label{pdf-to-frequency-distribution}}

In R, the function \texttt{dnorm()} can be used to calculate the probability density for a given value. The first argument, \texttt{x}, should be a vector of values for which you want to calculate the probability density. The second argument, \texttt{mean}, and the third argument, \texttt{sd}, correspond to the mean and standard deviation of the distribution, respectively. Note that we must provide \texttt{mean} and \texttt{sd} to calculate the probability density.

To encompass the entire range of observed heights, we can use \(\text{min}(x)\) and \(\text{max}(x)\) as the lower and upper limits, respectively.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# vector of x values}
\CommentTok{\# seq() generate min to max values with specified numbers of elements or interval}
\CommentTok{\# the following produce 100 elements}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\FunctionTok{min}\NormalTok{(df\_h0}\SpecialCharTok{$}\NormalTok{height), }\FunctionTok{max}\NormalTok{(df\_h0}\SpecialCharTok{$}\NormalTok{height), }\AttributeTok{length =} \DecValTok{100}\NormalTok{)}

\CommentTok{\# calculate probability density}
\NormalTok{mu }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(df\_h0}\SpecialCharTok{$}\NormalTok{height)}
\NormalTok{sigma }\OtherTok{\textless{}{-}} \FunctionTok{sd}\NormalTok{(df\_h0}\SpecialCharTok{$}\NormalTok{height)}
\NormalTok{pd }\OtherTok{\textless{}{-}} \FunctionTok{dnorm}\NormalTok{(x, }\AttributeTok{mean =}\NormalTok{ mu, }\AttributeTok{sd =}\NormalTok{ sigma)}

\CommentTok{\# figure}
\FunctionTok{tibble}\NormalTok{(}\AttributeTok{y =}\NormalTok{ pd, }\AttributeTok{x =}\NormalTok{ x) }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# data frame}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x, }\AttributeTok{y =}\NormalTok{ y)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+} \CommentTok{\# draw lines}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{y =} \StringTok{"Probability density"}\NormalTok{) }\CommentTok{\# re{-}label}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{_main_files/figure-latex/dnorm-1} 

}

\caption{Probability density function of a Normal distribution}\label{fig:dnorm}
\end{figure}

The shape of the curve appears quite similar to what we observed; however, the scale of the y-axis is different. This is because the y-axis represents ``probability density.'' To convert it into actual ``probability,'' we need to calculate the area under the curve. In R, we can utilize the \texttt{pnorm()} function for this purpose. It calculates the probability of a variable being less than the specified value, which is provided in the first argument \texttt{q}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# probability of x \textless{} 10}
\NormalTok{p10 }\OtherTok{\textless{}{-}} \FunctionTok{pnorm}\NormalTok{(}\AttributeTok{q =} \DecValTok{10}\NormalTok{, }\AttributeTok{mean =}\NormalTok{ mu, }\AttributeTok{sd =}\NormalTok{ sigma)}
\FunctionTok{print}\NormalTok{(p10)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.02731905
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# probability of x \textless{} 20}
\NormalTok{p20 }\OtherTok{\textless{}{-}} \FunctionTok{pnorm}\NormalTok{(}\AttributeTok{q =} \DecValTok{20}\NormalTok{, }\AttributeTok{mean =}\NormalTok{ mu, }\AttributeTok{sd =}\NormalTok{ sigma)}
\FunctionTok{print}\NormalTok{(p20)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.504426
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# probability of 10 \textless{} x \textless{} 20}
\NormalTok{p20\_10 }\OtherTok{\textless{}{-}}\NormalTok{ p20 }\SpecialCharTok{{-}}\NormalTok{ p10}
\FunctionTok{print}\NormalTok{(p20\_10)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.4771069
\end{verbatim}

To make the estimates comparable to the frequency data, you can calculate the probability for each 1 cm bin. The expected frequency can be obtained by multiplying the probability by the sample size, which in this case is 1000. This allows you to estimate the number of observations you would expect in each 1 cm bin based on the calculated probabilities.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x\_min }\OtherTok{\textless{}{-}} \FunctionTok{floor}\NormalTok{(}\FunctionTok{min}\NormalTok{(df\_h0}\SpecialCharTok{$}\NormalTok{height)) }\CommentTok{\# floor takes the integer part of the value}
\NormalTok{x\_max }\OtherTok{\textless{}{-}} \FunctionTok{ceiling}\NormalTok{(}\FunctionTok{max}\NormalTok{(df\_h0}\SpecialCharTok{$}\NormalTok{height)) }\CommentTok{\# ceiling takes the next closest integer}
\NormalTok{bin }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(x\_min, x\_max, }\AttributeTok{by =} \DecValTok{1}\NormalTok{) }\CommentTok{\# each bin has 1cm}

\NormalTok{p }\OtherTok{\textless{}{-}} \ConstantTok{NULL} \CommentTok{\# empty object for probability}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{(}\FunctionTok{length}\NormalTok{(bin) }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{)) \{}
\NormalTok{  p[i] }\OtherTok{\textless{}{-}} \FunctionTok{pnorm}\NormalTok{(bin[i}\SpecialCharTok{+}\DecValTok{1}\NormalTok{], }\AttributeTok{mean =}\NormalTok{ mu, }\AttributeTok{sd =}\NormalTok{ sigma) }\SpecialCharTok{{-}} \FunctionTok{pnorm}\NormalTok{(bin[i], }\AttributeTok{mean =}\NormalTok{ mu, }\AttributeTok{sd =}\NormalTok{ sigma)}
\NormalTok{\}}

\CommentTok{\# data frame for probability}
\CommentTok{\# bin: last element [{-}length(bin)] was removed to match length}
\CommentTok{\# expected frequency in each bin is "prob times sample size"}
\NormalTok{df\_prob }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(p, }\AttributeTok{bin =}\NormalTok{ bin[}\SpecialCharTok{{-}}\FunctionTok{length}\NormalTok{(bin)]) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{freq =}\NormalTok{ p }\SpecialCharTok{*} \FunctionTok{nrow}\NormalTok{(df\_h0))}
\end{Highlighting}
\end{Shaded}

Overlay:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_h0 }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ height)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \DecValTok{1}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{data =}\NormalTok{ df\_prob,}
             \FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ freq,}
                 \AttributeTok{x =}\NormalTok{ bin),}
             \AttributeTok{color =} \StringTok{"salmon"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{data =}\NormalTok{ df\_prob,}
            \FunctionTok{aes}\NormalTok{(}\AttributeTok{y =}\NormalTok{ freq,}
                \AttributeTok{x =}\NormalTok{ bin),}
            \AttributeTok{color =} \StringTok{"salmon"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{_main_files/figure-latex/histogram-overlaid-1} 

}

\caption{Histogram overlaid with predicted frequency (red dots and line)}\label{fig:histogram-overlaid}
\end{figure}

It is remarkable that the probability distribution, characterized by just two parameters (mean and variance), can effectively reproduce the overall shape observed in the original data set of 1000 data points. This is great news because it means that once we determine these key parameters, we can infer the general pattern of the data.

\hypertarget{probability-distribution-of-a-discrete-variable}{%
\section{Probability Distribution of a Discrete Variable}\label{probability-distribution-of-a-discrete-variable}}

\hypertarget{probability-mass-function}{%
\subsection{Probability Mass Function}\label{probability-mass-function}}

Let's shift our perspective and examine the density of plants in the garden. For this analysis, we have counted the number of plant individuals within 30 plots, with each plot covering an area of one square meter (refer to Figure \ref{fig:garden}).

\begin{figure}

{\centering \includegraphics[width=16.67in]{image/figure_garden} 

}

\caption{Garden view with sampling plots. White squares represent plots. Red dots indicate plant individuals counted.}\label{fig:garden}
\end{figure}

Download the data \href{https://github.com/aterui/biostats/blob/master/data_raw/data_garden_count.csv}{here} and load it onto R:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_count }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"data\_raw/data\_garden\_count.csv"}\NormalTok{)}
\FunctionTok{print}\NormalTok{(df\_count)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 30 x 2
##     plot count
##    <dbl> <dbl>
##  1     1     3
##  2     2     2
##  3     3     3
##  4     4     1
##  5     5     2
##  6     6     1
##  7     7     3
##  8     8     3
##  9     9     3
## 10    10     1
## # i 20 more rows
\end{verbatim}

Make a histogram:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_count }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ count)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \FloatTok{0.5}\NormalTok{, }\CommentTok{\# define binwidth}
                 \AttributeTok{center =} \DecValTok{0}\NormalTok{) }\CommentTok{\# relative position of each bin}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{_main_files/figure-latex/hist-density-1} 

}

\caption{Histogram of plant individuals per plot}\label{fig:hist-density}
\end{figure}

There are several significant differences compared to the plant height example when considering the density of plants in the garden:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  The possible values are discrete (count data) since we are counting the number of plant individuals in each plot.
\item
  The possible values are always positive, as counts cannot be negative.
\item
  The distribution appears to be non-symmetric around the sample mean.
\end{enumerate}

Given these characteristics, a Normal distribution may not be an appropriate choice for representing such a variable. Instead, it would be more suitable to use a Poisson distribution to characterize the observed distribution of the discrete variable.

\[
x \sim Poisson(\lambda)
\]

In a Poisson distribution, the mean parameter (\(\lambda\)) serves as the sole parameter\footnote{In a Poisson distribution, mean = variance}. Probability distributions that describe discrete variables are expressed using a \textbf{probability mass function} (PMF):

\[
g(x) = \frac{\lambda^x \exp(-\lambda)}{x!}
\]

Unlike a probability density function (PDF), a probability mass function (PMF) represents the probability of a discrete variable \(x\) taking a specific value. For instance, the probability of \(x=2\), denoted as \(\Pr(x=2)\), can be calculated as follows:

\[
\Pr(x=2) = g(2) = \frac{\lambda^2 \exp(-\lambda)}{2!}
\]

In a generalized form, we write:

\[
\Pr(x=k) = g(k) = \frac{\lambda^k \exp(-\lambda)}{k!}
\]

\hypertarget{pmf-to-frequency-distribution}{%
\subsection{PMF to frequency distribution}\label{pmf-to-frequency-distribution}}

In R, you can use the \texttt{dpois()} function to visualize a Poisson distribution. This function allows you to plot the probability mass function (PMF) of the Poisson distribution and gain insights into the distribution of the discrete variable.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# vector of x values}
\CommentTok{\# create a vector of 0 to 10 with an interval one}
\CommentTok{\# must be integer of \textgreater{} 0}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{10}\NormalTok{, }\AttributeTok{by =} \DecValTok{1}\NormalTok{)}

\CommentTok{\# calculate probability mass}
\NormalTok{lambda\_hat }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(df\_count}\SpecialCharTok{$}\NormalTok{count)}
\NormalTok{pm }\OtherTok{\textless{}{-}} \FunctionTok{dpois}\NormalTok{(x, }\AttributeTok{lambda =}\NormalTok{ lambda\_hat)}

\CommentTok{\# figure}
\FunctionTok{tibble}\NormalTok{(}\AttributeTok{y =}\NormalTok{ pm, }\AttributeTok{x =}\NormalTok{ x) }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# data frame}
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x, }\AttributeTok{y =}\NormalTok{ y)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{linetype =} \StringTok{"dashed"}\NormalTok{) }\SpecialCharTok{+} \CommentTok{\# draw dashed lines}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+} \CommentTok{\# draw points}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{y =} \StringTok{"Probability"}\NormalTok{,}
       \AttributeTok{x =} \StringTok{"Count"}\NormalTok{) }\CommentTok{\# re{-}label}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{_main_files/figure-latex/dpois-1} 

}

\caption{Example of a Poisson distribution}\label{fig:dpois}
\end{figure}

To convert the y-axis from probability to frequency, multiply the probabilities by the sample size (total number of observations) to obtain the expected frequency. As in the plant height example, you can plot the expected frequency on the histogram, providing a visual representation of the distribution of the discrete variable.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_prob }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x, }\AttributeTok{y =}\NormalTok{ pm) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{freq =}\NormalTok{ y }\SpecialCharTok{*} \FunctionTok{nrow}\NormalTok{(df\_count)) }\CommentTok{\# prob x sample size}

\NormalTok{df\_count }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ count)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \FloatTok{0.5}\NormalTok{,}
                 \AttributeTok{center =} \DecValTok{0}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{(}\AttributeTok{data =}\NormalTok{ df\_prob,}
            \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x,}
                \AttributeTok{y =}\NormalTok{ freq),}
            \AttributeTok{linetype =} \StringTok{"dashed"}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{data =}\NormalTok{ df\_prob,}
             \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x,}
                \AttributeTok{y =}\NormalTok{ freq))}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{_main_files/figure-latex/pois-hist-1} 

}

\caption{Observed histogram of the discrete variable overlaid with the Poisson expectation.}\label{fig:pois-hist}
\end{figure}

Cool, the Poisson distribution does an excellent job of characterizing the distribution of plant counts.

\hypertarget{why-probability-distributions}{%
\section{Why Probability Distributions?}\label{why-probability-distributions}}

As we have seen in the above examples, probability distributions provide a framework for describing the likelihood of different outcomes or events. By utilizing probability distributions, we can:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Make predictions and estimate probabilities of specific events or ranges of values.
\item
  Determine the most likely values or outcomes based on available information.
\item
  Quantify and analyze the uncertainty associated with random variables or processes.
\end{enumerate}

Probability distributions serve as fundamental tools in statistics, enabling us to model, analyze, and make informed decisions in the face of uncertainty.

\hypertarget{laboratory-2}{%
\section{Laboratory}\label{laboratory-2}}

\hypertarget{normal-distribution}{%
\subsection{Normal Distribution}\label{normal-distribution}}

The function \texttt{rnorm()} produces a random variable that follows a Normal distribution with a specified mean and SD. Using this function,

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Generate a variable with 50 observations.
\item
  Create a figure similar to Figure \ref{fig:histogram-overlaid}
\end{enumerate}

\hypertarget{poisson-distribution}{%
\subsection{Poisson Distribution}\label{poisson-distribution}}

The function \texttt{rpois()} produces a random variable that follows a Poisson distribution with a specified mean. Using this function,

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Generate a variable with 1000 observations.
\item
  Create a figure similar to Figure \ref{fig:pois-hist}
\end{enumerate}

\hypertarget{two-group-comparison}{%
\chapter{Two-Group Comparison}\label{two-group-comparison}}

Data consists of ``samples'' extracted from the population of interest, but it's important to acknowledge that these samples are not flawless replicas of the entire population. Given this imperfect information, how can we effectively investigate and discern the distinction between two populations? In this Chapter, I will introduce one of the most basic statistical tests -- ``t-test.'' The t-test takes the following steps:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Define a \textbf{test statistic} to signify the difference between groups (t-statistic).
\item
  Define a probability distribution of t-statistic under the \textbf{null hypothesis}, i.e., a scenario that we assume no difference between groups.
\item
  Estimate the probability of yielding greater or less than the observed test statistic.
\end{enumerate}

\hypertarget{explore-data-structure}{%
\section{Explore Data Structure}\label{explore-data-structure}}

Suppose that we study fish populations of the same species in two lakes (Lake \texttt{a} and \texttt{b}). These lakes are in stark contrast of productivity (Lake \texttt{b} looks more productive), and our interest is the difference in \emph{mean} body size between the two lakes. We obtained \(50\) data points of fish length from each lake (download \href{https://github.com/aterui/biostats/blob/master/data_raw/data_fish_length.csv}{here}). Save under \texttt{data\_raw/} and use \texttt{read\_csv()} to read data:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse) }\CommentTok{\# call add{-}in packages everytime you open new R session}
\NormalTok{df\_fl }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"data\_raw/data\_fish\_length.csv"}\NormalTok{)}
\FunctionTok{print}\NormalTok{(df\_fl)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 100 x 3
##    lake  length unit 
##    <chr>  <dbl> <chr>
##  1 a       10.8 cm   
##  2 a       13.6 cm   
##  3 a       10.1 cm   
##  4 a       18.6 cm   
##  5 a       14.2 cm   
##  6 a       10.1 cm   
##  7 a       14.7 cm   
##  8 a       15.6 cm   
##  9 a       15   cm   
## 10 a       11.9 cm   
## # i 90 more rows
\end{verbatim}

In this data frame, fish length data from lake \texttt{a} and \texttt{b} are recorded. Confirm this with \texttt{unique()} or \texttt{distinct()} function:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# unique returns unique values as a vector}
\FunctionTok{unique}\NormalTok{(df\_fl}\SpecialCharTok{$}\NormalTok{lake)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "a" "b"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# distinct returns unique values as a tibble}
\FunctionTok{distinct}\NormalTok{(df\_fl, lake)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 2 x 1
##   lake 
##   <chr>
## 1 a    
## 2 b
\end{verbatim}

Visualization provides a powerful tool for summarizing data effectively. By plotting individual data points overlaid with mean values and error bars, we can observe the distribution and patterns within the data, allowing us to identify trends, variations, and potential outliers:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# group mean and sd}
\NormalTok{df\_fl\_mu }\OtherTok{\textless{}{-}}\NormalTok{ df\_fl }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(lake) }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# group operation}
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{mu\_l =} \FunctionTok{mean}\NormalTok{(length), }\CommentTok{\# summarize by mean()}
            \AttributeTok{sd\_l =} \FunctionTok{sd}\NormalTok{(length)) }\CommentTok{\# summarize with sd()}

\CommentTok{\# plot}
\CommentTok{\# geom\_jitter() plot data points with scatter}
\CommentTok{\# geom\_segment() draw lines}
\CommentTok{\# geom\_point() draw points}
\NormalTok{df\_fl }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ lake,}
             \AttributeTok{y =}\NormalTok{ length)) }\SpecialCharTok{+}
  \FunctionTok{geom\_jitter}\NormalTok{(}\AttributeTok{width =} \FloatTok{0.1}\NormalTok{, }\CommentTok{\# scatter width}
              \AttributeTok{height =} \DecValTok{0}\NormalTok{, }\CommentTok{\# scatter height (no scatter with zero)}
              \AttributeTok{alpha =} \FloatTok{0.25}\NormalTok{) }\SpecialCharTok{+} \CommentTok{\# transparency of data points}
  \FunctionTok{geom\_segment}\NormalTok{(}\AttributeTok{data =}\NormalTok{ df\_fl\_mu, }\CommentTok{\# switch data frame}
               \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ lake,}
                   \AttributeTok{xend =}\NormalTok{ lake,}
                   \AttributeTok{y =}\NormalTok{ mu\_l }\SpecialCharTok{{-}}\NormalTok{ sd\_l,}
                   \AttributeTok{yend =}\NormalTok{ mu\_l }\SpecialCharTok{+}\NormalTok{ sd\_l)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{(}\AttributeTok{data =}\NormalTok{ df\_fl\_mu, }\CommentTok{\# switch data frame}
             \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ lake,}
                 \AttributeTok{y =}\NormalTok{ mu\_l),}
             \AttributeTok{size =} \DecValTok{3}\NormalTok{) }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{x =} \StringTok{"Lake"}\NormalTok{, }\CommentTok{\# x label}
       \AttributeTok{y =} \StringTok{"Fish body length"}\NormalTok{) }\CommentTok{\# y label}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{_main_files/figure-latex/mean-plot-1} 

}

\caption{Example of mean and SD plot}\label{fig:mean-plot}
\end{figure}

Hmm, it is possible that there is a noticeable disparity in body size between Lake \texttt{a} and Lake \texttt{b}. However, how can we ascertain and provide evidence for this claim?

\hypertarget{test-statistic}{%
\section{Test Statistic}\label{test-statistic}}

\hypertarget{t-statistic}{%
\subsection{t-statistic}\label{t-statistic}}

Since our focus is on examining the difference in means, it is logical to estimate the disparity between the sample means in each lake. Let me denote the sample means as \(\hat{\mu}_a\) and \(\hat{\mu}_b\) for Lake \texttt{a} and Lake \texttt{b}, respectively. We can estimate the difference between the means using the following approach:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# take another look at df\_fl\_mu}
\FunctionTok{print}\NormalTok{(df\_fl\_mu)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 2 x 3
##   lake   mu_l  sd_l
##   <chr> <dbl> <dbl>
## 1 a      13.4  2.92
## 2 b      15.4  3.39
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# pull mu\_l from tibble as vector}
\NormalTok{v\_mu }\OtherTok{\textless{}{-}}\NormalTok{ df\_fl\_mu }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pull}\NormalTok{(mu\_l)}

\CommentTok{\# lake a}
\FunctionTok{print}\NormalTok{(v\_mu[}\DecValTok{1}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 13.35
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# lake b}
\FunctionTok{print}\NormalTok{(v\_mu[}\DecValTok{2}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 15.406
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# difference}
\NormalTok{v\_mu[}\DecValTok{1}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{ v\_mu[}\DecValTok{2}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] -2.056
\end{verbatim}

The average fish body size in Lake \texttt{b} is approximately 2 cm larger than that in Lake \texttt{a}. However, it is crucial to recognize that we are still lacking vital information, specifically, the uncertainty associated with this difference. As discussed in Chapter \ref{sampling}, we must acknowledge that sample means are not flawless representations of the entire population.

Fortunately, we can utilize sample variances to address such uncertainties. The \textbf{t-statistic} is a common indicator of the difference of means that takes into consideration the uncertainty associated with sample means.

\[
t = \frac{\hat{\mu_a} - \hat{\mu_b}}{\sqrt{\hat{\sigma}^2_p \left(\frac{1}{N_a} + \frac{1}{N_b}\right)}}
\]

where \(N_a\) and \(N_b\) are sample sizes in Lake \texttt{a} and \texttt{b} (i.e., \(N_a = N_b = 50\) in this specific example), and \(\hat{\sigma}^2_p\) is the weighted mean of sample variances:

\[
\hat{\sigma}^2_p = \frac{N_a-1}{N_a + N_b - 2}\hat{\sigma}^2_a + \frac{N_b-1}{N_a + N_b - 2}\hat{\sigma}^2_b
\]

We can calculate this value in R manually:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# group mean, variance, and sample size}
\NormalTok{df\_t }\OtherTok{\textless{}{-}}\NormalTok{ df\_fl }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(lake) }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# group operation}
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{mu\_l =} \FunctionTok{mean}\NormalTok{(length), }\CommentTok{\# summarize by mean()}
            \AttributeTok{var\_l =} \FunctionTok{var}\NormalTok{(length), }\CommentTok{\# summarize with sd()}
            \AttributeTok{n =} \FunctionTok{n}\NormalTok{()) }\CommentTok{\# count number of rows per group}

\FunctionTok{print}\NormalTok{(df\_t)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 2 x 4
##   lake   mu_l var_l     n
##   <chr> <dbl> <dbl> <int>
## 1 a      13.4  8.52    50
## 2 b      15.4 11.5     50
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# pull values as a vector}
\NormalTok{v\_mu }\OtherTok{\textless{}{-}} \FunctionTok{pull}\NormalTok{(df\_t, mu\_l)}
\NormalTok{v\_var }\OtherTok{\textless{}{-}} \FunctionTok{pull}\NormalTok{(df\_t, var\_l)}
\NormalTok{v\_n }\OtherTok{\textless{}{-}} \FunctionTok{pull}\NormalTok{(df\_t, n)}

\NormalTok{var\_p }\OtherTok{\textless{}{-}}\NormalTok{ ((v\_n[}\DecValTok{1}\NormalTok{] }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{)}\SpecialCharTok{/}\NormalTok{(}\FunctionTok{sum}\NormalTok{(v\_n) }\SpecialCharTok{{-}} \DecValTok{2}\NormalTok{)) }\SpecialCharTok{*}\NormalTok{ v\_var[}\DecValTok{1}\NormalTok{] }\SpecialCharTok{+}
\NormalTok{  ((v\_n[}\DecValTok{2}\NormalTok{] }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{)}\SpecialCharTok{/}\NormalTok{(}\FunctionTok{sum}\NormalTok{(v\_n) }\SpecialCharTok{{-}} \DecValTok{2}\NormalTok{)) }\SpecialCharTok{*}\NormalTok{ v\_var[}\DecValTok{2}\NormalTok{]}

\NormalTok{t\_value }\OtherTok{\textless{}{-}}\NormalTok{ (v\_mu[}\DecValTok{1}\NormalTok{] }\SpecialCharTok{{-}}\NormalTok{ v\_mu[}\DecValTok{2}\NormalTok{]) }\SpecialCharTok{/} \FunctionTok{sqrt}\NormalTok{(var\_p }\SpecialCharTok{*}\NormalTok{ ((}\DecValTok{1} \SpecialCharTok{/}\NormalTok{ v\_n[}\DecValTok{1}\NormalTok{]) }\SpecialCharTok{+}\NormalTok{ (}\DecValTok{1} \SpecialCharTok{/}\NormalTok{ v\_n[}\DecValTok{2}\NormalTok{])))}

\FunctionTok{print}\NormalTok{(t\_value)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] -3.247322
\end{verbatim}

The difference in sample means were -2.06; therefore, t-statistic further emphasizes the distinction between the study lakes. This occurrence can be attributed to the t-statistic formula.

In the denominator, we observe the inclusion of \(\hat{\sigma}^2_p\) (estimated pooled variance), as well as the inverses of sample sizes \(N_a\) and \(N_b\). Consequently, as \(\hat{\sigma}^2_p\) decreases and/or the sample sizes increase, the t-statistic increases. This is a reasonable outcome since a decrease in variance and/or an increase in sample size enhance the certainty of the mean difference.

\hypertarget{null-hypothesis}{%
\subsection{Null Hypothesis}\label{null-hypothesis}}

The observed t-statistic serves a dual purpose in accounting for both the disparity of means and the accompanying uncertainty. However, the significance of this t-statistic remains unclear.

To address this, the concept of the \textbf{Null Hypothesis} is utilized to substantiate the observed t-statistic. The Null Hypothesis, no difference between groups or \(\mu_a = \mu_b\), allows us to draw the probability distribution of the test-statistic. Once we know the probability distribution, we can \textbf{\emph{estimate the probability of observing the given t-statistic by random chance}} if there were no difference in mean body size between the lakes.

Let's begin by assuming that there is no difference in the mean body size of fish populations between the lakes, meaning the true difference in means is zero (\(\mu_a - \mu_b = 0\); without hats in this formula!). Under this assumption, we can define the probability distribution of t-statistics, which represents how t-statistics are distributed across a range of possible values.

This probability distribution is known as the Student's t-distribution and is characterized by three parameters: the mean, the variance, and the degrees of freedom (d.f.). Considering that we are evaluating the difference in body size as the test statistic, the mean (of the difference) is assumed to be zero. The variance is estimated using \(\hat{\sigma}^2_p\), and the degrees of freedom are determined by \(N_a + N_b - 2\) (where d.f. can be considered as a measure related to the sample size\footnote{Discussing the concept of degrees of freedom in depth would require a more comprehensive explanation, so I will refer to it here as a quantity relevant to the sample size.}).

R has a function to draw the Student's t-distribution; let's try that out:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# produce 500 values from {-}5 to 5 with equal interval}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{5}\NormalTok{, }\DecValTok{5}\NormalTok{, }\AttributeTok{length =} \DecValTok{500}\NormalTok{)}

\CommentTok{\# probability density of t{-}statistics with df = sum(v\_n) {-} 2}
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{dt}\NormalTok{(x, }\AttributeTok{df =} \FunctionTok{sum}\NormalTok{(v\_n) }\SpecialCharTok{{-}} \DecValTok{2}\NormalTok{)}

\CommentTok{\# draw figure}
\FunctionTok{tibble}\NormalTok{(x, y) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x,}
             \AttributeTok{y =}\NormalTok{ y)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{y =} \StringTok{"Probability density"}\NormalTok{,}
       \AttributeTok{x =} \StringTok{"t{-}statistic"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{_main_files/figure-latex/student-t-1} 

}

\caption{Distribution of t-statistics under null hypothesis. The probability density in a distribution determines the likelihood of observing a particular t-statistic. Higher probability density indicates a greater likelihood of the t-statistic occurring.}\label{fig:student-t}
\end{figure}

The probability density in a distribution (Figure \ref{fig:student-t}) determines the likelihood of observing a particular t-statistic. Higher probability density indicates a greater likelihood of the t-statistic occurring. Compare the observed t-statistic against this null distribution:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# draw entire range}
\FunctionTok{tibble}\NormalTok{(x, y) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x,}
             \AttributeTok{y =}\NormalTok{ y)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_vline}\NormalTok{(}\AttributeTok{xintercept =}\NormalTok{ t\_value,}
             \AttributeTok{color =} \StringTok{"salmon"}\NormalTok{) }\SpecialCharTok{+} \CommentTok{\# t\_value is the observed t\_value}
  \FunctionTok{geom\_vline}\NormalTok{(}\AttributeTok{xintercept =} \FunctionTok{abs}\NormalTok{(t\_value),}
             \AttributeTok{color =} \StringTok{"salmon"}\NormalTok{) }\SpecialCharTok{+} \CommentTok{\# t\_value is the observed t\_value}
  \FunctionTok{labs}\NormalTok{(}\AttributeTok{y =} \StringTok{"Probability density"}\NormalTok{,}
       \AttributeTok{x =} \StringTok{"t{-}statistic"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{_main_files/figure-latex/student-t-obs-1} 

}

\caption{Observed t-statistic in comparison to the null distrubution}\label{fig:student-t-obs}
\end{figure}

In a probability distribution, the area under the curve corresponds to the probability. Notably, \textbf{the area under the curve that falls below or above the observed t-statistic (indicated by vertical red lines) is very small (Figure} \ref{fig:student-t-obs}\textbf{)}, meaning that the observed difference in body size is very unlikely to occur under the null hypothesis (no difference in true means).

The function \texttt{pt()} allows us to calculate the area under the curve:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# calculate area under the curve from {-}infinity to t\_value}
\NormalTok{pr\_below }\OtherTok{\textless{}{-}} \FunctionTok{pt}\NormalTok{(}\AttributeTok{q =}\NormalTok{ t\_value, }\AttributeTok{df =} \FunctionTok{sum}\NormalTok{(v\_n) }\SpecialCharTok{{-}} \DecValTok{2}\NormalTok{)}

\CommentTok{\# calculate area under the curve from abs(t\_value) to infinity}
\NormalTok{pr\_above }\OtherTok{\textless{}{-}} \DecValTok{1} \SpecialCharTok{{-}} \FunctionTok{pt}\NormalTok{(}\AttributeTok{q =} \FunctionTok{abs}\NormalTok{(t\_value), }\AttributeTok{df =} \FunctionTok{sum}\NormalTok{(v\_n) }\SpecialCharTok{{-}} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

The \textbf{p-value,} i.e., \emph{the probability of observing t-statistics} less than ( \texttt{pr\_below}) or greater than (\texttt{pr\_above}) the observed t-statistic under the null hypothesis, can be estimated as the sum of \texttt{pr\_below} and \texttt{pr\_above}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# p\_value}
\NormalTok{p\_value }\OtherTok{\textless{}{-}}\NormalTok{ pr\_below }\SpecialCharTok{+}\NormalTok{ pr\_above}
\FunctionTok{print}\NormalTok{(p\_value)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.001595529
\end{verbatim}

\hypertarget{interpretation}{%
\subsection{Interpretation}\label{interpretation}}

The above exercise is called \textbf{t-test} -- perhaps, the most well-known hypothesis testing. To explain the interpretation of the results, let me use the following notations. \(t_{obs}\), the observed t-statistic; \(t_0\), possible t-statistics under the null hypothesis; \(\Pr(\cdot)\), the probability of ``\(\cdot\)'' occurs -- for example, \(\Pr(x > 2)\) means that the probability of \(x\) exceeding \(2\).

We first calculated the observed t-statistic \(t_{obs}\) using the data of fish body size, which was -3.25. Then, we calculated p-value, i.e., \(\Pr(t_0 < t_{obs}) + \Pr(t_0 > t_{obs})\) under the null hypothesis of \(\mu_a = \mu_b\). We found p-value was very low, meaning that the observed t-statistic is very unlikely to occur if \(\mu_a = \mu_b\) is the truth. Therefore, it is logical to conclude that the \textbf{Alternative Hypothesis} \(\mu_a \ne \mu_b\) is very likely.

The same logic is used in many statistical analyses -- define the null hypothesis, and estimate the probability of observing a given value under the null hypothesis. It is tricky, but I find this genius: we can substantiate the observation(s) objectively that are otherwise a subjective claim!

However, it is crucial to recognize that, \textbf{even if we found the observed t-statistic that results in very high p-value (i.e., very common under the null hypothesis), finding such a result does NOT support the null hypothesis -- we just can't reject it.}

\hypertarget{t-test-in-r}{%
\section{t-test in R}\label{t-test-in-r}}

\hypertarget{t-test-with-equal-variance}{%
\subsection{t-test with equal variance}\label{t-test-with-equal-variance}}

In R, this t-test can be performed with \texttt{t.test()}. Let me examine if the function gives us identical results:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}}\NormalTok{ df\_fl }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(lake }\SpecialCharTok{==} \StringTok{"a"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%}  \CommentTok{\# subset lake a}
  \FunctionTok{pull}\NormalTok{(length)}

\NormalTok{y }\OtherTok{\textless{}{-}}\NormalTok{ df\_fl }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{filter}\NormalTok{(lake }\SpecialCharTok{==} \StringTok{"b"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# subset lake b}
  \FunctionTok{pull}\NormalTok{(length)}

\FunctionTok{t.test}\NormalTok{(x, y, }\AttributeTok{var.equal =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Two Sample t-test
## 
## data:  x and y
## t = -3.2473, df = 98, p-value = 0.001596
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -3.3124399 -0.7995601
## sample estimates:
## mean of x mean of y 
##    13.350    15.406
\end{verbatim}

The reported t-statistic \texttt{t\ =\ -3.2473}, the p-value \texttt{p-value\ =\ 0.001596}, and the degrees of freedom all agreed (\texttt{df\ =\ 98}) with what we have estimated manually. Importantly, this t-test assumes relative similarity of variance between groups.

\hypertarget{t-test-with-unequal-variance}{%
\subsection{t-test with unequal variance}\label{t-test-with-unequal-variance}}

The relative similarity of variance between groups could be an unrealistic assumption. Luckily, there is a variant of t-test ``Welch's t-test,'' in which we assume unequal variance between groups. The implementation is easy -- set \texttt{var.equal\ =\ FALSE} in \texttt{t.test()}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{t.test}\NormalTok{(x, y, }\AttributeTok{var.equal =} \ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Welch Two Sample t-test
## 
## data:  x and y
## t = -3.2473, df = 95.846, p-value = 0.001606
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -3.3127929 -0.7992071
## sample estimates:
## mean of x mean of y 
##    13.350    15.406
\end{verbatim}

In Welch's t-test, t-statistics are defined differently to account for unequal variance between groups\footnote{When \(\hat{\sigma}^2_a \approx \hat{\sigma}_b^2\), the t-statistic for Welch's t-test is reduced to the original t-statistic.}:

\[
t = \frac{\hat{\mu_a} - \hat{\mu_b}}{\sqrt{\left(\frac{\hat{\sigma}^2_a}{N_a} + \frac{\hat{\sigma}^2_b}{N_b}\right)}}
\]

This t-statistic is known to follow the Student's t-distribution with the degrees of freedom:

\[
d.f. = \frac{\frac{\hat{\sigma}^2_a}{N_a} + \frac{\hat{\sigma}^2_b}{N_b}}{\frac{(\hat{\sigma}^2_a / N_a)^2}{N_a - 1} + \frac{(\hat{\sigma}^2_b/N_b)^2}{N_b-1}}
\]

Therefore, the reported values of t-statistic and d.f. are different from what we estimated. The Welch's t-test covers the cases for equal variances; therefore, by default, we use the Welch's test.

\hypertarget{laboratory-3}{%
\section{Laboratory}\label{laboratory-3}}

\hypertarget{multiple-group-comparison}{%
\chapter{Multiple-Group Comparison}\label{multiple-group-comparison}}

The t-test is used to compare two groups, but when there are more than two groups, ANOVA (Analysis of Variance) is employed. ANOVA allows for simultaneous comparison of means among multiple groups to determine if there are statistically significant differences. ANOVA uses the following steps:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Partition the total variability into \textbf{between-group} and \textbf{within-group} components.
\item
  Define a \textbf{test statistic} as a ratio of between-group variability to within-group variability (F statistic).
\item
  Define a probability distribution of F-statistic under the null hypothesis.
\item
  Estimate the probability of yielding greater the observed test statistic.
\end{enumerate}

If appropriate, post-hoc tests can be conducted to identify specific differing groups.

\hypertarget{partition-the-variability}{%
\section{Partition the Variability}\label{partition-the-variability}}

The first step is to determine what aspect to examine. In the case of a t-test, we focus on the difference in sample means between groups. One might initially consider conducting t-tests for all possible combinations. However, this approach leads to a problem known as the \href{https://en.wikipedia.org/wiki/Multiple_comparisons_problem\#:~:text=In\%20statistics\%2C\%20the\%20multiple\%20comparisons,based\%20on\%20the\%20observed\%20values.}{multiple comparisons problem}. Hence, this is not a viable option. Therefore, we need to explore the data from a different perspective.

To facilitate learning, let's once again utilize the lake fish data, but this time we have three lakes in our analysis:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_anova }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"data\_raw/data\_fish\_length\_anova.csv"}\NormalTok{)}
\FunctionTok{distinct}\NormalTok{(df\_anova, lake)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 3 x 1
##   lake 
##   <chr>
## 1 a    
## 2 b    
## 3 c
\end{verbatim}

Visualization can be helpful in understanding how the data is distributed. While mean \(\pm\) SD is perfectly fine here, let me use a violin plot to show a different way of visualization.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# geom\_violin() {-} function for violin plots}
\CommentTok{\# geom\_jitter() {-} jittered points}

\NormalTok{df\_anova }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ lake,}
             \AttributeTok{y =}\NormalTok{ length)) }\SpecialCharTok{+}
  \FunctionTok{geom\_violin}\NormalTok{(}\AttributeTok{draw\_quantiles =} \FloatTok{0.5}\NormalTok{, }\CommentTok{\# draw median horizontal line}
              \AttributeTok{alpha =} \FloatTok{0.2}\NormalTok{) }\SpecialCharTok{+} \CommentTok{\# transparency}
  \FunctionTok{geom\_jitter}\NormalTok{(}\AttributeTok{alpha =} \FloatTok{0.2}\NormalTok{) }\CommentTok{\# transparency}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{_main_files/figure-latex/violin-1} 

}

\caption{Violin plot for fish length in three lakes.}\label{fig:violin}
\end{figure}

It appears that Lake \texttt{b} exhibits a larger average body size compared to the other lakes. One approach to quantifying this difference between groups is by examining the ratio of between-group variability to within-group variability. \textbf{If we observe a greater between-group variability relative to within-group variability, it suggests that the differences among the groups are substantial.} In other words, much of the observed variation is explained by the group structure (lake).

Let me denote between-group and within-group variability as \(S_b\) and \(S_w\), respectively, which are defined as follows:

\[
\begin{aligned}
S_b &= \sum_g \sum_i (\hat{\mu}_{g(i)} - \hat{\mu})^2\\
S_w &= \sum_g \sum_i (x_{i} - \hat{\mu}_{g(i)})^2
\end{aligned}
\]

The double summation \(\sum_g \sum_i\) might scare you, but no worries. We can decompose this equation into two steps.

\hypertarget{between-group-variability}{%
\subsection{Between-group variability}\label{between-group-variability}}

Let me first consider \(S_b = \sum_g \sum_i (\hat{\mu}_{g(i)} - \hat{\mu})^2\). In this equation, \(\hat{\mu}\) is the overall mean of the fish length and \(\hat{\mu}_{g(i)}\) is the group-mean in a given lake (\(g = \{a, b, c\}\)). Let's perform this estimation in R:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# estimate overall mean}
\NormalTok{mu }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(df\_anova}\SpecialCharTok{$}\NormalTok{length)}

\CommentTok{\# estimate group means and sample size each}
\NormalTok{df\_g }\OtherTok{\textless{}{-}}\NormalTok{ df\_anova }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(lake) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{mu\_g =} \FunctionTok{mean}\NormalTok{(length), }\CommentTok{\# mean for each group}
            \AttributeTok{dev\_g =}\NormalTok{ (mu\_g }\SpecialCharTok{{-}}\NormalTok{ mu)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{, }\CommentTok{\# squared deviation for each group}
            \AttributeTok{n =} \FunctionTok{n}\NormalTok{()) }\CommentTok{\# sample size for each group}

\FunctionTok{print}\NormalTok{(df\_g)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 3 x 4
##   lake   mu_g   dev_g     n
##   <chr> <dbl>   <dbl> <int>
## 1 a      13.4 1.12       50
## 2 b      15.4 0.997      50
## 3 c      14.5 0.00344    50
\end{verbatim}

In the column \texttt{dev\_g}, we estimated \((\hat{\mu}_{g(i)} - \hat{\mu})^2\). We must sum over \(i\) (fish individual) to get the variability in each lake (\(\sum_i (\hat{\mu}_{g(i)} - \hat{\mu})^2\)). Since \(\hat{\mu}_{g(i)}\) is constant in each lake, we can simply multiply \texttt{dev\_g} with sample size \texttt{n} in each lake:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_g }\OtherTok{\textless{}{-}}\NormalTok{ df\_g }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{ss =}\NormalTok{ dev\_g }\SpecialCharTok{*}\NormalTok{ n)}

\FunctionTok{print}\NormalTok{(df\_g)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 3 x 5
##   lake   mu_g   dev_g     n     ss
##   <chr> <dbl>   <dbl> <int>  <dbl>
## 1 a      13.4 1.12       50 55.9  
## 2 b      15.4 0.997      50 49.9  
## 3 c      14.5 0.00344    50  0.172
\end{verbatim}

Sum over \(g\) (lake) to get \(S_b\).

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{s\_b }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(df\_g}\SpecialCharTok{$}\NormalTok{ss)}
\FunctionTok{print}\NormalTok{(s\_b)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 105.9365
\end{verbatim}

\hypertarget{within-group-variability}{%
\subsection{Within-group variability}\label{within-group-variability}}

We can follow the same steps to estimate the within-group variability \(S_w = \sum_g \sum_i (x_{i} - \hat{\mu}_{g(i)})^2\). Let's estimate \((x_{i} - \hat{\mu}_{g(i)})^2\) first:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_i }\OtherTok{\textless{}{-}}\NormalTok{ df\_anova }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(lake) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{mu\_g =} \FunctionTok{mean}\NormalTok{(length)) }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# use mutate() to retain individual rows}
  \FunctionTok{ungroup}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{dev\_i =}\NormalTok{ (length }\SpecialCharTok{{-}}\NormalTok{ mu\_g)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{) }\CommentTok{\# deviation from group mean for each fish}
\end{Highlighting}
\end{Shaded}

You can take a look at group-level data with the following code; the column \texttt{mu\_g} contains group-specific means of fish length, and \texttt{dev\_i} contains \((x_{g(i)} - \hat{\mu}_{g(i)})^2\):

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# filter() \& slice(): show first 3 rows each group}
\FunctionTok{print}\NormalTok{(df\_i }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{(lake }\SpecialCharTok{==} \StringTok{"a"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{slice}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{))}

\FunctionTok{print}\NormalTok{(df\_i }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{(lake }\SpecialCharTok{==} \StringTok{"b"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{slice}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{))}

\FunctionTok{print}\NormalTok{(df\_i }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{filter}\NormalTok{(lake }\SpecialCharTok{==} \StringTok{"c"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{slice}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{3}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

Sum over \(i\) in each lake \(g\) (\(\sum_i (x_{g(i)} - \hat{\mu}_{g(i)})^2\)):

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_i\_g }\OtherTok{\textless{}{-}}\NormalTok{ df\_i }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(lake) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{ss =} \FunctionTok{sum}\NormalTok{(dev\_i))}

\FunctionTok{print}\NormalTok{(df\_i\_g)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 3 x 2
##   lake     ss
##   <chr> <dbl>
## 1 a      417.
## 2 b      565.
## 3 c      486.
\end{verbatim}

Then sum over \(g\) to get \(S_w\):

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{s\_w }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(df\_i\_g}\SpecialCharTok{$}\NormalTok{ss)}
\FunctionTok{print}\NormalTok{(s\_w)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1467.645
\end{verbatim}

\hypertarget{variability-to-variance}{%
\subsection{Variability to Variance}\label{variability-to-variance}}

I referred to \(S_b\) and \(S_w\) as ``variability,'' which essentially represents the summation of squared deviations. To convert them into variances, we can divide them by appropriate numbers. In Chapter \ref{sampling}, I mentioned that the denominator for variance is the sample size minus one. The same principle applies here, but with caution.

For the between-group variability, denoted as \(S_b\), the realized sample size is the number of groups, \(N_g\), which in this case is three (representing the number of lakes). Therefore, we divide by three minus one to obtain an unbiased estimate of the between-group variance, denoted as \(\hat{\sigma}_b^2"\):

\[
\hat{\sigma}^2_b = \frac{S_b}{N_g-1}
\]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# n\_distinct() count the number of unique elements}
\NormalTok{n\_g }\OtherTok{\textless{}{-}} \FunctionTok{n\_distinct}\NormalTok{(df\_anova}\SpecialCharTok{$}\NormalTok{lake)}
\NormalTok{s2\_b }\OtherTok{\textless{}{-}}\NormalTok{ s\_b }\SpecialCharTok{/}\NormalTok{ (n\_g }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{)}
\FunctionTok{print}\NormalTok{(s2\_b)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 52.96827
\end{verbatim}

Meanwhile, we need to be careful when estimating the within-group variance. Since the within-group variance is measured at the individual level, the number of data used is equal to the number of fish individuals. Yet, we subtract the number of groups -- while the rationale behind this is beyond the scope, we are essentially accounting for the fact that some of the degrees of freedom are ``used up'' in estimating the group means. As such, we estimate the within-group variance \(\hat{\sigma}^2_w\) as follows:

\[
\hat{\sigma}^2_w = \frac{S_w}{N-N_g}
\]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{s2\_w }\OtherTok{\textless{}{-}}\NormalTok{ s\_w }\SpecialCharTok{/}\NormalTok{ (}\FunctionTok{nrow}\NormalTok{(df\_anova) }\SpecialCharTok{{-}}\NormalTok{ n\_g)}
\FunctionTok{print}\NormalTok{(s2\_w)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 9.983982
\end{verbatim}

\hypertarget{test-statistic-1}{%
\section{Test Statistic}\label{test-statistic-1}}

\hypertarget{f-statistic}{%
\subsection{F-statistic}\label{f-statistic}}

In ANOVA, we use F-statistic -- the ratio of between-group variability to within-group variability. The above exercise was essentially performed to yield this test statistic:

\[
F = \frac{\text{between-group variance}}{\text{within-group variance}} = \frac{\hat{\sigma}^2_b}{\hat{\sigma}^2_w}
\]

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{f\_value }\OtherTok{\textless{}{-}}\NormalTok{ s2\_b }\SpecialCharTok{/}\NormalTok{ s2\_w}
\FunctionTok{print}\NormalTok{(f\_value)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 5.305325
\end{verbatim}

The F-statistic in our data was calculated to be 5.31. This indicates that the between-group variance is approximately five times higher than the within-group variance. While this difference appears significant, it is important to determine whether it is statistically substantial. To make such a claim, we can use the Null Hypothesis as a reference.

\hypertarget{null-hypothesis-1}{%
\subsection{Null Hypothesis}\label{null-hypothesis-1}}

The F-statistic follows an F-distribution when there is no difference in means among the groups. Therefore, the null hypothesis we are considering in our example is that the means of all groups are equal, represented as \(\mu_a = \mu_b = \mu_c\). It's worth noting that the alternative hypotheses can take different forms, such as \(\mu_a \ne \mu_b = \mu_c\), \(\mu_a = \mu_b \ne \mu_c\), or \(\mu_a \ne \mu_b \ne \mu_c\). ANOVA, however, is unable to distinguish between these alternative hypotheses.

The degrees of freedom in an F-distribution are determined by two parameters: \(N_g - 1\) and \(N - N_g\). To visualize the distribution, you can utilize the\texttt{df()} function. Similar to the t-test, we can plot the F-distribution and draw a vertical line to represent the observed F-statistic. This approach allows us to assess the position of the observed F-statistic within the distribution and determine the associated p-value.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{10}\NormalTok{, }\AttributeTok{by =} \FloatTok{0.1}\NormalTok{)}
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{df}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x, }\AttributeTok{df1 =}\NormalTok{ n\_g }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{, }\AttributeTok{df2 =} \FunctionTok{nrow}\NormalTok{(df\_anova) }\SpecialCharTok{{-}}\NormalTok{ n\_g)}

\FunctionTok{tibble}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x, }\AttributeTok{y =}\NormalTok{ y) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x,}
             \AttributeTok{y =}\NormalTok{ y)) }\SpecialCharTok{+} 
  \FunctionTok{geom\_line}\NormalTok{() }\SpecialCharTok{+} \CommentTok{\# F distribution}
  \FunctionTok{geom\_vline}\NormalTok{(}\AttributeTok{xintercept =}\NormalTok{ f\_value,}
             \AttributeTok{color =} \StringTok{"salmon"}\NormalTok{) }\CommentTok{\# observed F{-}statistic}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{_main_files/figure-latex/f-dist-1} 

}

\caption{F-distribution. The vertical red line denotes the observed F-statistic.}\label{fig:f-dist}
\end{figure}

Unlike t-statistics, F-statistics can take only positive values (because F-statistics are the ratio of positive values). The p-value here is \(\Pr(F_0 > F)\), where \(F_0\) is the possible F-statistics under the null hypothesis. Let's estimate this probability using \texttt{pf()}:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# pf() estimate the probability of less than q}
\CommentTok{\# Pr(F0 \textgreater{} F) is 1 {-} Pr(F0 \textless{} F)}
\NormalTok{p\_value }\OtherTok{\textless{}{-}} \DecValTok{1} \SpecialCharTok{{-}} \FunctionTok{pf}\NormalTok{(}\AttributeTok{q =}\NormalTok{ f\_value, }\AttributeTok{df1 =}\NormalTok{ n\_g }\SpecialCharTok{{-}} \DecValTok{1}\NormalTok{, }\AttributeTok{df2 =} \FunctionTok{nrow}\NormalTok{(df\_anova) }\SpecialCharTok{{-}}\NormalTok{ n\_g)}
\FunctionTok{print}\NormalTok{(p\_value)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.00596054
\end{verbatim}

\hypertarget{anova-in-r}{%
\section{ANOVA in R}\label{anova-in-r}}

Like the t-test, R provides functions to perform ANOVA easily. In this case, we will utilize the \texttt{aov()} function. The first argument of this function is the ``formula,'' which is used to describe the structure of the model. In our scenario, we aim to explain the fish body length by grouping them according to lakes. In the formula expression, we represent this relationship as \texttt{length\ \textasciitilde{}\ lake}, using the tilde symbol (\textasciitilde) to indicate the stochastic nature of the relationship.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# first argument is formula}
\CommentTok{\# second argument is data frame for reference}
\CommentTok{\# do not forget specify data = XXX! aov() refer to columns in the data frame}
\NormalTok{m }\OtherTok{\textless{}{-}} \FunctionTok{aov}\NormalTok{(}\AttributeTok{formula =}\NormalTok{ length }\SpecialCharTok{\textasciitilde{}}\NormalTok{ lake,}
         \AttributeTok{data =}\NormalTok{ df\_anova)}

\FunctionTok{print}\NormalTok{(m)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Call:
##    aov(formula = length ~ lake, data = df_anova)
## 
## Terms:
##                      lake Residuals
## Sum of Squares   105.9365 1467.6454
## Deg. of Freedom         2       147
## 
## Residual standard error: 3.159744
## Estimated effects may be unbalanced
\end{verbatim}

The function returns \texttt{Sum\ of\ Squares} and \texttt{Deg.\ of\ Freedom} -- these value matches what we have calculated. To get deeper insights, wrap the object with \texttt{summary()}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(m)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##              Df Sum Sq Mean Sq F value  Pr(>F)   
## lake          2  105.9   52.97   5.305 0.00596 **
## Residuals   147 1467.6    9.98                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

The F-statistic and p-value are identical to our manual estimate.

\hypertarget{post-hoc-tests}{%
\section{Post-hoc Tests}\label{post-hoc-tests}}

When conducting an ANOVA and finding a significant difference among group means, a post-hoc test is often performed to determine which specific groups differ significantly from each other. Post-hoc tests help to identify pairwise comparisons that contribute to the observed overall difference.

There are several post-hoc tests available for ANOVA, including:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Tukey's Honestly Significant Difference (HSD): This test compares all possible pairs of group means and provides adjusted p-values to control for the family-wise error rate. It is a commonly used and reliable post-hoc test.
\item
  Bonferroni correction: This method adjusts the significance level for each individual comparison to control the overall Type I error rate. The adjusted p-value is obtained by dividing the desired significance level (e.g., 0.05) by the number of comparisons.
\item
  Scheffe's test: This test controls the family-wise error rate by considering all possible pairwise comparisons. It is more conservative than Tukey's HSD, but it is suitable for cases where specific comparisons are of particular interest.
\item
  Dunnett's test: This test is useful when comparing multiple groups against a control group. It controls the overall error rate by conducting multiple t-tests between the control group and each of the other groups.
\end{enumerate}

The choice of post-hoc test depends on the specific research question, assumptions, and desired control of the Type I error rate. It is important to select an appropriate test and interpret the results accordingly to draw valid conclusions about group differences in an ANOVA analysis.

\hypertarget{laboratory-4}{%
\section{Laboratory}\label{laboratory-4}}

\hypertarget{regression}{%
\chapter{Regression}\label{regression}}

Our previous examples focused on cases that involved a distinct group structure. However, it is not always the case that such a structure exists. Instead, we might examine the relationship between continuous variables. In this chapter, I will introduce a technique called linear regression.

\hypertarget{explore-data-structure-1}{%
\section{Explore Data Structure}\label{explore-data-structure-1}}

For this exercise, we will use algae biomass data from streams. Download the data \href{https://github.com/aterui/biostats/blob/master/data_raw/data_algae.csv}{here} and locate it in \texttt{data\_raw/}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\NormalTok{df\_algae }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"data\_raw/data\_algae.csv"}\NormalTok{)}
\FunctionTok{print}\NormalTok{(df\_algae)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 50 x 4
##    biomass unit_biomass conductivity unit_cond
##      <dbl> <chr>               <dbl> <chr>    
##  1   19.8  mg_per_m2            30.2 ms       
##  2   24.4  mg_per_m2            40.4 ms       
##  3   27.4  mg_per_m2            59.4 ms       
##  4   48.2  mg_per_m2            91.3 ms       
##  5   19.2  mg_per_m2            24.2 ms       
##  6   57.0  mg_per_m2            90.4 ms       
##  7   51.9  mg_per_m2            94.7 ms       
##  8   40.8  mg_per_m2            67.8 ms       
##  9   37.1  mg_per_m2            64.8 ms       
## 10    3.55 mg_per_m2            10.9 ms       
## # i 40 more rows
\end{verbatim}

This dataset comprises data collected from 50 sampling sites. The variable \texttt{biomass} represents the standing biomass, indicating the dry mass of algae at the time of collection. On the other hand, \texttt{conductivity} serves as a proxy for water quality, with higher values usually indicating a higher nutrient content in the water. Let me now proceed to draw a scatter plot that will help visualize the relationship between these two variables.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df\_algae }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ conductivity,}
             \AttributeTok{y =}\NormalTok{ biomass)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{_main_files/figure-latex/scatter-1} 

}

\caption{The relationship between algae biomass and conductivity.}\label{fig:scatter}
\end{figure}

It seems that there is a noticeable positive correlation where increased conductivity results in higher algal biomass. Nevertheless, how can we accurately represent this relationship with a line?

\hypertarget{drawing-the-fittest-line}{%
\section{Drawing the ``fittest'' line}\label{drawing-the-fittest-line}}

\hypertarget{linear-formula}{%
\subsection{Linear formula}\label{linear-formula}}

The first step is to represent the relationship as a formula; let me ASSUME that the relationship can be described by the following linear formula:

\[
y_i = \alpha + \beta x_i
\]

In this formula, the algal biomass, denoted as \(y_i\), at site \(i\), is expressed as a function of conductivity, represented by \(x_i\). The variable being explained (\(y_i\)) is referred to as a \textbf{response (or dependent) variable}, while the variable used to predict the response variable (\(x_i\)) is referred to as \textbf{an explanatory (or independent) variable.} However, there are two additional constants, namely \(\alpha\) and \(\beta\). \(\alpha\) is commonly known as the \textbf{intercept}, while \(\beta\) is referred to as the \textbf{slope} or \textbf{coefficient}. The intercept represents the value of \(y\) when \(x\) is equal to zero, while the slope indicates the change in \(y\) associated with a unit increase in \(x\) (refer to Figure \ref{fig:intercept-slope}).

\begin{figure}

{\centering \includegraphics[width=14.58in]{image/figure_lm} 

}

\caption{Intercept and slope.}\label{fig:intercept-slope}
\end{figure}

However, this formula, or ``model,'' is incomplete. We must add the error term \(\varepsilon_i\) (\textbf{residual}) to consider the uncertainty associated with the observation process.

\[
y_i = \alpha + \beta x_i + \varepsilon_i\\
\varepsilon_i \sim \text{Normal}(0, \sigma^2)
\]

Notice that \(y_i\), \(x_i\), and \(\varepsilon_i\) have subscripts, while \(\alpha\) and \(\beta\) do not. This means that \(y_i\), \(x_i\), and \(\varepsilon_i\) vary by data point \(i\), and \(\alpha\) and \(\beta\) are constants. Although \(\alpha + \beta x_i\) cannot reproduce \(y_i\) perfectly, we ``fill'' the gaps with the error term \(\varepsilon_i\), which is assumed to follow a Normal distribution.

In R, finding the best \(\alpha\) and \(\beta\) -- i.e., the parameters in this model -- is very easy. Function \texttt{lm()} does everything for you. Let me apply this function to the example data set:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# lm() takes a formula as the first argument}
\CommentTok{\# don\textquotesingle{}t forget to supply your data}
\NormalTok{m }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(biomass }\SpecialCharTok{\textasciitilde{}}\NormalTok{ conductivity,}
        \AttributeTok{data =}\NormalTok{ df\_algae)}

\FunctionTok{summary}\NormalTok{(m)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = biomass ~ conductivity, data = df_algae)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.5578 -2.8729 -0.7307  2.5479 11.4700 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(>|t|)    
## (Intercept)   5.29647    1.57178    3.37  0.00149 ** 
## conductivity  0.50355    0.02568   19.61  < 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 4.649 on 48 degrees of freedom
## Multiple R-squared:  0.889,  Adjusted R-squared:  0.8867 
## F-statistic: 384.5 on 1 and 48 DF,  p-value: < 2.2e-16
\end{verbatim}

In \texttt{Coefficients:}, it says \texttt{(Intercept)} is 5.3 and \texttt{conductivity} is 0.5. These values corresponds to \(\alpha\) and \(\beta\). Meanwhile, \texttt{Residual\ standard\ error:} indicates the SD of the error term \(\sigma\). Thus, substituting these values into the formula yields:

\[
y_i = 5.30 + 0.50 x_i + \varepsilon_i\\
\varepsilon_i \sim \text{Normal}(0, 4.6^2)
\]

We can draw this ``fittest'' line on the figure:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# coef() extracts estimated coefficients}
\CommentTok{\# e.g., coef(m)[1] is (Intercept)}

\NormalTok{alpha }\OtherTok{\textless{}{-}} \FunctionTok{coef}\NormalTok{(m)[}\DecValTok{1}\NormalTok{]}
\NormalTok{beta }\OtherTok{\textless{}{-}} \FunctionTok{coef}\NormalTok{(m)[}\DecValTok{2}\NormalTok{]}

\NormalTok{df\_algae }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ conductivity,}
             \AttributeTok{y =}\NormalTok{ biomass)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_abline}\NormalTok{(}\AttributeTok{intercept =}\NormalTok{ alpha,}
              \AttributeTok{slope =}\NormalTok{ beta) }\CommentTok{\# draw the line}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{_main_files/figure-latex/fittest-line-1} 

}

\caption{Drawing the fitted model prediction.}\label{fig:fittest-line}
\end{figure}

However, how did \texttt{lm()} find \(\alpha\) and \(\beta\)?

\hypertarget{minimizing-the-errors}{%
\subsection{Minimizing the errors}\label{minimizing-the-errors}}

Notice that the error term is the difference between \(y_i\) and \(\alpha + \beta x_i\):

\[
\varepsilon_i = y_i - (\alpha + \beta x_i)
\]In other words, this term represents the portion of the observation \(y_i\) that cannot be explained by the conductivity \(x_i\). Therefore, a logical approach would be to find values for \(\alpha\) and \(\beta\) that minimize this unexplained portion across all data points \(i\).

\textbf{Least squares methods} are a widely employed statistical approach to achieve this objective. These methods aim to minimize the sum of squared errors, denoted as \(\sum_i \varepsilon_i^2\), across all data points. As the deviation from the expected value of \(\alpha + \beta x_i\) increases, this quantity also increases. Consequently, determining parameter values (\(\alpha\) and \(\beta\)) that minimize this sum of squared errors yields the best-fitting formula (see Section \ref{least-squares} for further details).

\hypertarget{least-squares}{%
\subsection{Least Squares}\label{least-squares}}

Introducing a matrix representation is indeed a helpful way to explain the least square method. Here, I represent the vector of observed values \(y_i\) as \(Y\) (\(Y = \{y_1, y_2,...,y_n\}^T\)), the vector of parameters as \(\Theta\) (\(\Theta = \{\alpha, \beta\}^T\)), and the matrix composed of \(1\)s and \(x_i\) values as \(X\). The matrix \(X\) can be written as:

\[
X =
\begin{pmatrix} 
  1 & x_1\\ 
  1 & x_2\\
  1 & x_3\\
  \vdots & \vdots\\
  1 & x_n
\end{pmatrix}
\]

Using matrix notation, we can express the error vector \(\pmb{\varepsilon}\) as:

\[
\pmb{\varepsilon} = Y - X\Theta
\]

The column of \(1\)s is required to represent the intercept; \(X\Theta\) reads:

\[
X\Theta =
\begin{pmatrix} 
  1 & x_1\\ 
  1 & x_2\\
  1 & x_3\\
  \vdots & \vdots\\
  1 & x_n
\end{pmatrix}
\begin{pmatrix} 
  \alpha\\ 
  \beta
\end{pmatrix}
=
\begin{pmatrix} 
  \alpha + \beta x_1\\ 
  \alpha + \beta x_2\\
  \alpha + \beta x_3\\
  \vdots\\
  \alpha + \beta x_n
\end{pmatrix}
\]

Minimizing the squared magnitude of \(\pmb{\varepsilon}\) (solve the partial derivative of \(||\pmb{\varepsilon}||^2\) about \(\Theta\)) leads to the solution (for detailed derivation, refer to \href{https://en.wikipedia.org/wiki/Least_squares}{Wikipedia}):

\[
\hat{\Theta} = (X^TX)^{-1}X^{T}Y
\]

Let me see if this reproduces the result of \texttt{lm()}:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# create matrix X}
\NormalTok{v\_x }\OtherTok{\textless{}{-}}\NormalTok{ df\_algae }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{pull}\NormalTok{(conductivity)}
\NormalTok{X }\OtherTok{\textless{}{-}} \FunctionTok{cbind}\NormalTok{(}\DecValTok{1}\NormalTok{, v\_x)}

\CommentTok{\# create a vector of y}
\NormalTok{Y }\OtherTok{\textless{}{-}}\NormalTok{ df\_algae }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{pull}\NormalTok{(biomass)}

\CommentTok{\# \%*\%: matrix multiplication}
\CommentTok{\# t(): transpose a matrix}
\CommentTok{\# solve(): computes the inverse matrix}
\NormalTok{theta }\OtherTok{\textless{}{-}} \FunctionTok{solve}\NormalTok{(}\FunctionTok{t}\NormalTok{(X) }\SpecialCharTok{\%*\%}\NormalTok{ X) }\SpecialCharTok{\%*\%} \FunctionTok{t}\NormalTok{(X) }\SpecialCharTok{\%*\%}\NormalTok{ Y}
\FunctionTok{print}\NormalTok{(theta)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##          [,1]
##     5.2964689
## v_x 0.5035548
\end{verbatim}

\texttt{lm()} output for a reference:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{m }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(biomass }\SpecialCharTok{\textasciitilde{}}\NormalTok{ conductivity,}
        \AttributeTok{data =}\NormalTok{ df\_algae)}

\FunctionTok{coef}\NormalTok{(m)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  (Intercept) conductivity 
##    5.2964689    0.5035548
\end{verbatim}

\hypertarget{standard-errors-and-t-values}{%
\subsection{Standard Errors and t-values}\label{standard-errors-and-t-values}}

Ensuring the reliability of the estimated point estimates for \(\alpha\) and \(\beta\) is crucial. In the \texttt{summary(m)} output, two statistical quantities, namely the \texttt{Std.\ Error} and \texttt{t-value}, play a significant role in assessing the uncertainty associated with these estimates.

The standard error (\texttt{Std.\ Error}) represents the estimated standard deviation of the parameter estimates (\(\hat{\theta}\) is either \(\hat{\alpha}\) or \(\hat{\beta}\)). A smaller value of the standard error indicates a higher degree of statistical reliability in the estimate. On the other hand, the \texttt{t-value} is a concept we have covered in Chapter \ref{two-group-comparison}. This value is defined as:

\[
t = \frac{\hat{\theta} - \theta_0}{SE(\hat{\theta})}
\]

The t-statistic is akin to the t-test; however, in the context of regression analysis, we do not have another group to compare with (i.e., \(\theta_0\)). Typically, in regression analysis, we use zero as the reference (\(\theta_0 = 0\)). Therefore, higher t-values in \texttt{lm()} indicate a greater deviation from zero. Consequently, the \textbf{Null Hypothesis in regression analysis is} \(\beta = 0\). This hypothesis is sensible in our specific example since we are interested in quantifying the effect of conductivity. If \(\beta = 0\), it implies that conductivity has no effect on algal biomass. Since \(\theta_0 = 0\), the following code reproduces the reported t-values:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# extract coefficients}
\NormalTok{theta }\OtherTok{\textless{}{-}} \FunctionTok{coef}\NormalTok{(m)}

\CommentTok{\# extract standard errors}
\NormalTok{se }\OtherTok{\textless{}{-}} \FunctionTok{sqrt}\NormalTok{(}\FunctionTok{diag}\NormalTok{(}\FunctionTok{vcov}\NormalTok{(m)))}

\CommentTok{\# t{-}value}
\NormalTok{t\_value }\OtherTok{\textless{}{-}}\NormalTok{ theta }\SpecialCharTok{/}\NormalTok{ se}
\FunctionTok{print}\NormalTok{(t\_value)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  (Intercept) conductivity 
##     3.369732    19.609446
\end{verbatim}

After defining the Null Hypothesis and t-values, we can compute the probability of observing the estimated parameters under the Null Hypothesis. Similar to the t-test, \texttt{lm()} utilizes a Student's t-distribution for this purpose. However, the difference lies in how we estimate the degrees of freedom. In our case, we have 50 data points but need to subtract the number of parameters, which are \(\alpha\) and \(\beta\). Therefore, the degrees of freedom would be \(50 - 2 = 48\). This value is employed when calculating the p-value:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# for intercept}
\CommentTok{\# (1 {-} pt(t\_value[1], df = 48)) calculates pr(t \textgreater{} t\_value[1])}
\CommentTok{\# pt({-}t\_value[1], df = 48) calculates pr(t \textless{} {-}t\_value[1])}
\NormalTok{p\_alpha }\OtherTok{\textless{}{-}}\NormalTok{ (}\DecValTok{1} \SpecialCharTok{{-}} \FunctionTok{pt}\NormalTok{(t\_value[}\DecValTok{1}\NormalTok{], }\AttributeTok{df =} \DecValTok{48}\NormalTok{)) }\SpecialCharTok{+} \FunctionTok{pt}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{t\_value[}\DecValTok{1}\NormalTok{], }\AttributeTok{df =} \DecValTok{48}\NormalTok{)}

\CommentTok{\# for slope}
\NormalTok{p\_beta }\OtherTok{\textless{}{-}}\NormalTok{ (}\DecValTok{1} \SpecialCharTok{{-}} \FunctionTok{pt}\NormalTok{(t\_value[}\DecValTok{2}\NormalTok{], }\AttributeTok{df =} \DecValTok{48}\NormalTok{)) }\SpecialCharTok{+} \FunctionTok{pt}\NormalTok{(}\SpecialCharTok{{-}}\NormalTok{t\_value[}\DecValTok{2}\NormalTok{], }\AttributeTok{df =} \DecValTok{48}\NormalTok{)}

\FunctionTok{print}\NormalTok{(p\_alpha)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## (Intercept) 
## 0.001492023
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(p\_beta)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## conductivity 
## 7.377061e-25
\end{verbatim}

\hypertarget{unexplained-variation}{%
\section{Unexplained Variation}\label{unexplained-variation}}

\hypertarget{retrieve-errors}{%
\subsection{Retrieve Errors}\label{retrieve-errors}}

The function \texttt{lm()} provides estimates for \(\alpha\) and \(\beta\), but it does not directly provide the values of \(\varepsilon_i\). To gain a deeper understanding of the statistical model, it is necessary to examine the residuals \(\varepsilon_i\). By using the \texttt{resid()} function, you can obtain the values of \(\varepsilon_i\). This allows you to explore and extract insights from the developed statistical model.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# eps {-} stands for epsilon}
\NormalTok{eps }\OtherTok{\textless{}{-}} \FunctionTok{resid}\NormalTok{(m)}
\FunctionTok{head}\NormalTok{(eps)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##          1          2          3          4          5          6 
## -0.6838937 -1.2149034 -7.8576927 -3.0109473  1.7076481  6.1773586
\end{verbatim}

Each element retains the order of data point in the original data frame, so \texttt{eps{[}1{]}} (\(\varepsilon_1\)) should be identical to \(y_1 - (\alpha + \beta x_1)\). Let me confirm:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# pull vector data}
\NormalTok{v\_x }\OtherTok{\textless{}{-}}\NormalTok{ df\_algae }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{pull}\NormalTok{(conductivity)}
\NormalTok{v\_y }\OtherTok{\textless{}{-}}\NormalTok{ df\_algae }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{pull}\NormalTok{(biomass)}

\CommentTok{\# theta[1] = alpha}
\CommentTok{\# theta[2] = beta}
\NormalTok{error }\OtherTok{\textless{}{-}}\NormalTok{ v\_y }\SpecialCharTok{{-}}\NormalTok{ (theta[}\DecValTok{1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ theta[}\DecValTok{2}\NormalTok{] }\SpecialCharTok{*}\NormalTok{ v\_x)}

\CommentTok{\# cbind() combines vectors column{-}wise}
\CommentTok{\# head() retrieves the first 6 rows}
\FunctionTok{head}\NormalTok{(}\FunctionTok{cbind}\NormalTok{(eps, error))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##          eps      error
## 1 -0.6838937 -0.6838937
## 2 -1.2149034 -1.2149034
## 3 -7.8576927 -7.8576927
## 4 -3.0109473 -3.0109473
## 5  1.7076481  1.7076481
## 6  6.1773586  6.1773586
\end{verbatim}

To ensure that the two columns are indeed identical, a visual check may be prone to overlooking small differences. To perform a more precise comparison, you can use the \texttt{all()} function to check if the data aligns (here, evaluated at the five decimal points using \texttt{round()}). By comparing the two columns in this manner, you can confirm whether they are identical or not.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# round values at 5 decimal}
\NormalTok{eps }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(eps, }\DecValTok{5}\NormalTok{)}
\NormalTok{error }\OtherTok{\textless{}{-}} \FunctionTok{round}\NormalTok{(error, }\DecValTok{5}\NormalTok{)}

\CommentTok{\# eps == error return "TRUE" or "FALSE"}
\CommentTok{\# all() returns TRUE if all elements meet eps == error}
\FunctionTok{all}\NormalTok{(eps }\SpecialCharTok{==}\NormalTok{ error)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] TRUE
\end{verbatim}

\hypertarget{visualize-errors}{%
\subsection{Visualize Errors}\label{visualize-errors}}

To visualize the errors or residuals, which represent the distance from the best-fitted line to each data point, you can make use of the \texttt{geom\_segment()} function:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# add error column}
\NormalTok{df\_algae }\OtherTok{\textless{}{-}}\NormalTok{ df\_algae }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{eps =}\NormalTok{ eps)}

\NormalTok{df\_algae }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ conductivity,}
             \AttributeTok{y =}\NormalTok{ biomass)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{geom\_abline}\NormalTok{(}\AttributeTok{intercept =}\NormalTok{ alpha,}
              \AttributeTok{slope =}\NormalTok{ beta) }\SpecialCharTok{+} 
  \FunctionTok{geom\_segment}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ conductivity, }\CommentTok{\# start{-}coord x}
                   \AttributeTok{xend =}\NormalTok{ conductivity, }\CommentTok{\# end{-}coord x}
                   \AttributeTok{y =}\NormalTok{ biomass, }\CommentTok{\# start{-}coord y}
                   \AttributeTok{yend =}\NormalTok{ biomass }\SpecialCharTok{{-}}\NormalTok{ eps), }\CommentTok{\# end{-}coord y}
               \AttributeTok{linetype =} \StringTok{"dashed"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{figure}

{\centering \includegraphics{_main_files/figure-latex/geom-errors-1} 

}

\caption{Vertical segments indicate errors.}\label{fig:geom-errors}
\end{figure}

\hypertarget{coefficient-of-determination}{%
\subsection{Coefficient of Determination}\label{coefficient-of-determination}}

One crucial motivation for developing a regression model, or any statistical model, is to assess the extent to which the explanatory variable (\(x_i\)) explains the variation in the response variable (\(y_i\)). By fitting a regression model, we can quantify the amount of variability in the response variable that can be attributed to the explanatory variable. This assessment provides valuable insights into the strength and significance of the relationship between the variables under consideration.

The \textbf{coefficient of determination}, denoted as R, is a statistical measure that assesses the proportion of the variance in the response variable that can be explained by the explanatory variable(s) in a regression model. It provides an indication of how well the regression model fits the observed data. The formula for R is:

\[
\text{R}^2 = 1 - \frac{SS}{SS_0}
\]

where \(SS\) is the summed squares of residuals (\(\sum_i \varepsilon_i^2\)), and \(SS_0\) is the summed squares of the response variable (\(SS_0 = \sum_i(y_i - \hat{\mu}_y)^2\)). The term \(\frac{SS}{SS_0}\) represents the proportion of variability ``unexplained'' -- therefore, \(1 - \frac{SS}{SS_0}\) gives the proportion of variability ``explained.'' R is a value between 0 and 1. An R value of 0 indicates that the explanatory variable(s) cannot explain any of the variability in the response variable, while an R value of 1 indicates that the explanatory variable(s) can fully explain the variability in the response variable.

While R\textsuperscript{2} is provided as a default output of \texttt{lm()}, let's confirm if the above equation reproduces the reported value:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# residual variance}
\NormalTok{ss }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(}\FunctionTok{resid}\NormalTok{(m)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}

\CommentTok{\# null variance}
\NormalTok{ss\_0 }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{((v\_y }\SpecialCharTok{{-}} \FunctionTok{mean}\NormalTok{(v\_y))}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}

\CommentTok{\# coefficient of determination}
\NormalTok{r2 }\OtherTok{\textless{}{-}} \DecValTok{1} \SpecialCharTok{{-}}\NormalTok{ ss }\SpecialCharTok{/}\NormalTok{ ss\_0}

\FunctionTok{print}\NormalTok{(r2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.8890251
\end{verbatim}

Compare it with \texttt{lm()} output:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(m)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## lm(formula = biomass ~ conductivity, data = df_algae)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.5578 -2.8729 -0.7307  2.5479 11.4700 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(>|t|)    
## (Intercept)   5.29647    1.57178    3.37  0.00149 ** 
## conductivity  0.50355    0.02568   19.61  < 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 4.649 on 48 degrees of freedom
## Multiple R-squared:  0.889,  Adjusted R-squared:  0.8867 
## F-statistic: 384.5 on 1 and 48 DF,  p-value: < 2.2e-16
\end{verbatim}

\texttt{Multiple\ R-squared:} corresponds to the calculated coefficient of determination.

\hypertarget{laboratory-5}{%
\section{Laboratory}\label{laboratory-5}}

\hypertarget{appendix-project-management}{%
\chapter{Appendix: Project Management}\label{appendix-project-management}}

\hypertarget{r-project}{%
\section{R Project}\label{r-project}}

Throughout this book, I will use the `R Project' as the core workspace unit. It serves as a centralized location where all relevant materials, such as R scripts (\texttt{.R}) and data files, are consolidated. There are various ways to organize your project, but I prefer creating a single `R Project' for a set of scripts and data that contribute to a specific publication (see example \href{https://github.com/aterui/public-proj_stream-diversity}{here}). To set up an `R Project,' you'll need to have both \emph{RStudio} and the base \emph{R} software installed. While \emph{R} can be used independently, I highly recommend using it in conjunction with \emph{RStudio} due to the latter's numerous features that facilitate data analysis. You can download \emph{R} and \emph{RStudio} from the following websites:

\begin{itemize}
\tightlist
\item
  \href{https://www.r-project.org/}{R} (you can choose any CRAN mirror for downloading)
\item
  RStudio
\end{itemize}

Upon launching \emph{RStudio}, you will encounter the interface depicted in Figure \ref{fig:ui}. Initially, the interface comprises three primary panels: the \texttt{Console}, \texttt{Environment}, and \texttt{Files}. The \texttt{Console} is where you write code and execute calculations, data manipulation, and analysis. The \texttt{Environment} panel lists the saved objects, while the \texttt{Files} panel displays files in a designated location on your computer.

\begin{figure}

{\centering \includegraphics[width=9.47in]{image/r_image01} 

}

\caption{RStudio interface.}\label{fig:ui}
\end{figure}

After pasting the script into the console, you will notice that the variable \texttt{x} appears in the environment panel.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\texttt{x} is an object that stores information. In this particular case, we have stored a sequence of \texttt{1} and \texttt{2} in the object \texttt{x}. Once you have stored information in \texttt{x}, you can access it by simply typing \texttt{x}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 2
\end{verbatim}

Excellent! While it is possible to work with your data using this approach, it is important to highlight that \textbf{it is generally regarded as a poor practice}. As your project evolves, you will accumulate a substantial amount of material, such as writing more than 2000 lines of code for a single project. Consequently, it becomes essential to implement effective code management strategies. How do you presently handle code management?

\hypertarget{script-editor}{%
\subsection{Script Editor}\label{script-editor}}

It is highly recommended to manage your scripts in the \texttt{Editor} instead. The \texttt{Editor} is where you draft and fine-tune your code before executing it in the \texttt{Console}. To create space for the \texttt{Editor}, press \texttt{Ctrl\ +\ Shift\ +\ N}. A new panel will appear in the top left corner. Let's type the following script in the \texttt{Editor}. Please note that the key combination \texttt{Ctrl\ +\ Shift\ +\ N} assumes a Windows or Linux operating system. If you're using a Mac, you can use \texttt{Command\ +\ Shift\ +\ N} instead.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Then, hit \texttt{Ctr\ +\ S} to save the \texttt{Editor} file. \emph{RStudio} will prompt you to enter the file name of the \texttt{Editor}\footnote{In \emph{R}, an editor file has an extension of \texttt{.R}.}.

\hypertarget{file-name}{%
\subsection{File Name}\label{file-name}}

It is also crucial to establish consistent naming \textbf{rules} for your files. As your project progresses, the number of files within each sub-directory may increase significantly. Without clear and consistent naming rules for your files, navigating through the project can become challenging, not only for yourself but also for others involved. To alleviate this issue, consider implementing the following recommendations for file naming:

\begin{itemize}
\tightlist
\item
  \textbf{NO SPACE.} Use underscore.

  \begin{itemize}
  \tightlist
  \item
    Do: \texttt{script\_week1.R}
  \item
    Don't: \texttt{script\ week1.R}
  \end{itemize}
\item
  \textbf{NO UPPERCASE.} Use lowercase for file names.

  \begin{itemize}
  \tightlist
  \item
    Do: \texttt{script\_week1.R}
  \item
    Don't: \texttt{Script\_week1.R}
  \end{itemize}
\item
  \textbf{BE CONSISTENT.} Apply consistent naming rules within a project.

  \begin{itemize}
  \tightlist
  \item
    Do: R scripts for figures always start with a common prefix, e.g., \texttt{figure\_XXX.R} \texttt{figure\_YYY.R}(\texttt{XXX} and \texttt{YYY} specifies further details).
  \item
    Don't: R scripts for figures start with random text, e.g., \texttt{XXX\_fig.R} , \texttt{Figure\_Y2.R} , \texttt{plotB.R}.
  \end{itemize}
\end{itemize}

\hypertarget{structure-your-project}{%
\subsection{Structure Your Project}\label{structure-your-project}}

If you fail to save or haphazardly store your code files on your computer, the risk of losing essential items becomes inevitable sooner or later. To mitigate this risk, I highly recommend gathering all the relevant materials within a single \texttt{R\ Project}. To create a new \texttt{R\ Project}, follow the procedure outlined below:

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  Go to \texttt{File\ \textgreater{}\ New\ Project} on the top menu
\item
  Select \texttt{New\ Directory}
\item
  Select \texttt{New\ Project}
\end{enumerate}

A new window will appear, prompting you to name a directory and select a location on your computer. To choose a location for the directory, click on the `Browse' button. When organizing your project directories on your computer, I highly recommend creating a dedicated space. For instance, on my computer, I have a folder named \texttt{/github} where I store all my \texttt{R\ Project} directories.

The internal structure of an \texttt{R\ Project} is crucial for effective navigation and ensures clarity for both yourself and others when it is published. An \texttt{R\ Project} typically consists of various file types, such as \texttt{.R}, \texttt{.csv}, \texttt{.rds}, \texttt{.Rmd}, and others. Without an organized arrangement of these files, there is a high probability of encountering significant coding errors. Therefore, I place great importance on maintaining a well-structured project. In Table \ref{tab:str}, I present my recommended subdirectory structure.

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.1690}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.8310}}@{}}
\caption{\label{tab:str} Suggested internal structure of \texttt{R\ Project}}\tabularnewline
\toprule()
\begin{minipage}[b]{\linewidth}\raggedright
Name
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Content
\end{minipage} \\
\midrule()
\endfirsthead
\toprule()
\begin{minipage}[b]{\linewidth}\raggedright
Name
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Content
\end{minipage} \\
\midrule()
\endhead
\texttt{README.md} & Markdown file explaining contents in the \texttt{R\ Project}. Can be derived from \texttt{README.Rmd}. \\
\texttt{/code} & Sub-directory for R scripts (\texttt{.R}). \\
\texttt{/data\_raw} & Sub-directory for raw data before data manipulation (\texttt{.csv} or other formats). Files in this sub-directory MUST NOT be modified unless there are changes to raw data entries. \\
\texttt{/data\_fmt} & Sub-directory for formatted data (\texttt{.csv}, \texttt{.rds}, or other formats). \\
\texttt{/output} & Sub-directory for result outputs (\texttt{.csv}, \texttt{.rds}, or other formats). This may include statistical estimates from linear regression models etc. \\
\texttt{/rmd} & (Optional) Sub-directory for Rmarkdown files (\texttt{.Rmd}). Rmarkdown allows seamless integration of R scripts and text. \\
\bottomrule()
\end{longtable}

\hypertarget{robust-coding}{%
\section{Robust coding}\label{robust-coding}}

While it is not mandatory, I highly recommend using \emph{RStudio} in conjunction with \emph{Git} and \emph{GitHub}. Coding is inherently prone to errors, and even the most skilled programmers make mistakes---without exception. However, the crucial difference between beginner and advanced programmers lies in their ability to develop robust coding practices accompanied by a self-error-detection system. \emph{Git} plays a vital role in this process. Throughout this book, I will occasionally delve into the importance of \emph{Git} and its usage.

\hypertarget{appendix-git-github}{%
\chapter{Appendix: Git \& GitHub}\label{appendix-git-github}}

\hypertarget{git-github}{%
\section{Git \& GitHub}\label{git-github}}

In this section, I will explain how to integrate Git and GitHub into R Studio. While R Studio is already an excellent tool, it becomes even more powerful when combined with Git and GitHub. Git is a free and open-source distributed version control system that tracks changes in your code as you work on your project, ensuring you are aware of any modifications made to your script (and other) files. Tracking changes is crucial to avoid unintended errors in your code and helps prevent the creation of redundant files. Although Git is primarily a local system, it has an online counterpart called GitHub.

To set up this system, you'll need to follow a few steps. The first step is to install Git on your computer:

\begin{itemize}
\item
  For \textbf{Windows}: Install Git from \href{https://gitforwindows.org/}{here}. During the installation process, you'll be prompted about ``Adjusting your PATH environment.'' Choose ``Git from the command line and also from 3rd-party software'' if it's not already selected.
\item
  For \textbf{Mac}: Follow the instructions provided \href{https://happygitwithr.com/install-git.html}{here}.
\end{itemize}

Once Git is installed, open R Studio and navigate to \texttt{Create\ Project} \textgreater{} \texttt{New\ Directory} \textgreater{} \texttt{New\ Project}. If you see the checkbox labeled ``Create a git repository,'' make sure to select it before creating your new project (refer to Figure \ref{fig:gitcheck}). This action will display the Git pane on the upper right panel of R Studio, indicating that Git integration is enabled.

\begin{figure}

{\centering \includegraphics[width=8.24in]{image/git_image01} 

}

\caption{After installing Git, you should see `Create a git repository`.}\label{fig:gitcheck}
\end{figure}

If you are unable to find the options mentioned above, follow these steps:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Click on \texttt{Tools} in the menu bar of R Studio.
\item
  Select \texttt{Terminal} and then choose \texttt{New\ Terminal}.
\item
  In the terminal window, type \texttt{where\ git} and press Enter. This command will display the location of the Git executable on your computer.
\item
  Next, go back to \texttt{Tools} in the menu bar and select \texttt{Global\ Options}.
\item
  In the options window, navigate to \texttt{Git/SVN}.
\item
  Look for the field labeled \emph{Git executable} and specify the location of the Git executable that you obtained from the terminal.
\end{enumerate}

After setting up Git, you can proceed to create an account on \href{https://github.com/}{GitHub}. It's a free platform, and when choosing a username, consider using lowercase letters and including your name to make it easier for others to find you.

While R Studio seamlessly integrates with Git and GitHub, using a Git client can provide additional visual aids. There are various options for Git clients (see choices \href{https://happygitwithr.com/git-client.html}{here}), but for this exercise, we will use GitHub Desktop. Install GitHub Desktop on your computer from \href{https://desktop.github.com/}{here}.

\hypertarget{commit-push}{%
\section{Commit \& Push}\label{commit-push}}

\hypertarget{register-your-git-repo}{%
\subsection{Register Your Git repo}\label{register-your-git-repo}}

To open the \texttt{R\ Project} you've just created as a git repository, follow these steps:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Open R Studio.
\item
  Click on \texttt{File} in the menu bar.
\item
  Select \texttt{Open\ Project}.
\item
  Browse to the directory where you created the \texttt{R\ Project} and select the corresponding \texttt{.Rproj} file.
\item
  R Studio will open the project, and you will see the project name in the top-right corner of the window.
\end{enumerate}

To create a sample \texttt{.R} file named \texttt{sample.R} within the project, you can use the shortcut \texttt{Ctrl\ +\ Shift\ +\ N} or follow these steps:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Click on \texttt{File} in the menu bar.
\item
  Select \texttt{New\ File}.
\item
  Choose \texttt{R\ Script}.
\item
  A new script editor will open, where you can write your R code.
\item
  Write your code in the editor and save it as \texttt{sample.R} by clicking on \texttt{File} and selecting \texttt{Save} or using the shortcut \texttt{Ctrl\ +\ S}.
\end{enumerate}

Remember to save the file after writing your code.

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# produce 100 random numbers that follows a normal distribution}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{100}\NormalTok{, }\AttributeTok{mean =} \DecValTok{0}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{)}

\DocumentationTok{\#\# estimate mean}
\FunctionTok{mean}\NormalTok{(x)}

\DocumentationTok{\#\# estimate SD}
\FunctionTok{sd}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

To open the GitHub Desktop app, locate the application on your computer and launch it. Once opened, you will see a GUI similar to the one depicted in Figure \ref{fig:gitdesktop1}.

\begin{figure}

{\centering \includegraphics[width=61.11in]{image/git_image02} 

}

\caption{GUI for GitHub Desktop}\label{fig:gitdesktop1}
\end{figure}

Click on the ``Current Repository'' button located at the top left corner of the GitHub Desktop app interface. Then, select ``Add'' followed by ``Add existing repository'' from the dropdown menu, as shown in Figure \ref{fig:gitdesktop2}.

\begin{figure}

{\centering \includegraphics[width=61.11in]{image/git_image03} 

}

\caption{Add dropdown on the top left}\label{fig:gitdesktop2}
\end{figure}

\hypertarget{commit}{%
\subsection{Commit}\label{commit}}

GitHub Desktop will prompt you to enter a local path to your Git repository. Browse and select the directory where your \texttt{R\ Project} is located. Once you have selected the directory, the local Git repository will appear in the list of repositories on the left side bar of GitHub Desktop, as shown in Figure \ref{fig:gitdesktop2}.

Now that your repository is added to GitHub Desktop, you are ready to start committing your files to Git. Committing is the process of recording the changes made to your files in Git. To proceed with committing, click on your Git repository in GitHub Desktop. You will see the following options and information displayed:

\begin{itemize}
\tightlist
\item
  The list of changed files: This section shows the files that have been modified since the last commit.
\item
  A summary of the changes: This section provides an overview of the changes made to the selected files.
\item
  Commit message: This is where you can enter a descriptive message explaining the changes made in the commit.
\end{itemize}

By providing a meaningful commit message, you can keep track of the changes made to your files and easily understand the purpose of each commit.

\begin{figure}

{\centering \includegraphics[width=61.11in]{image/git_image04} 

}

\caption{You will see `Create sample.R` or `summary (required)` on the bottom left}\label{fig:gitdesktop3}
\end{figure}

At this stage, your file (\texttt{.R} or any other file) is saved in your local directory but has not been recorded in Git as a change history. To commit the changes, follow these steps:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  First, select the file(s) you want to commit. You can do this by checking the checkboxes next to the files listed in the ``Changes'' section of the GitHub Desktop app.
\item
  Once you have selected the files, go to the bottom left of the GitHub Desktop app window. You will see a small box that says \texttt{summary\ (required)} or \texttt{Create\ sample.R}.
\item
  In this box, enter a descriptive title that explains what you did in this commit. It is important to provide a meaningful summary, as you cannot proceed with the commit unless you enter this information. For example, for this exercise, you can enter \texttt{Initial\ commit} as the commit title. For subsequent commits, it is recommended to provide more informative commit messages that accurately describe the changes made. You can refer to online resources for recommendations on how to write effective commit titles and descriptions.
\item
  After entering the commit title, click on the button that says \texttt{Commit\ to\ master}. This action will record the changes made to the selected files in Git.
\end{enumerate}

Now, the changes to the selected files have been successfully recorded in Git as a commit. It's important to commit regularly and provide meaningful commit messages so that you can track changes and understand the evolution of your project when needed.

\hypertarget{push}{%
\subsection{Push}\label{push}}

It's important to note that your changes are currently recorded in your local computer's Git repository but have not been published to your online GitHub repository. To send the local changes to the online GitHub repository, you need to use the ``Push'' operation through GitHub Desktop.

After you make a commit in GitHub Desktop, you will be prompted with a dialog box asking if you want to push the commit to an online repository, as shown in Figure \ref{fig:gitdesktop4}. If this is your first push, there won't be a corresponding repository on GitHub linked to your local repository. In this case, GitHub Desktop will ask if you want to publish it on GitHub. Please note that ``publishing'' here means making the repository available on GitHub, but it will remain private unless you explicitly choose to make it public.

If you are comfortable with the changes you made and want to send them to the online repository, click the ``Push'' button in GitHub Desktop. This action will push your commits to the remote repository on GitHub, effectively synchronizing your local repository with the online repository.

\begin{figure}

{\centering \includegraphics[width=61.11in]{image/git_image05} 

}

\caption{To Push your code, hit the highlighted menu button}\label{fig:gitdesktop4}
\end{figure}

\hypertarget{edit}{%
\subsection{Edit}\label{edit}}

We have created a file named \texttt{sample.R} as per the previous instructions. Now, let's make a minor change to the content of the \texttt{sample.R} file. Open the \texttt{sample.R} file in your preferred text editor or in R Studio, and make a modification to the code. For example, you can update the code from:

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# produce 100 random numbers that follows a normal distribution}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{100}\NormalTok{, }\AttributeTok{mean =} \DecValTok{0}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{)}

\DocumentationTok{\#\# estimate mean}
\FunctionTok{mean}\NormalTok{(x)}

\DocumentationTok{\#\# estimate SD}
\FunctionTok{sd}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

to:

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# produce 100 random numbers that follows a normal distribution}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{100}\NormalTok{, }\AttributeTok{mean =} \DecValTok{0}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{)}

\DocumentationTok{\#\# estimate mean}
\FunctionTok{median}\NormalTok{(x)}

\DocumentationTok{\#\# estimate SD}
\FunctionTok{var}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

Save the changes to the \texttt{sample.R} file. Now, let's go back to GitHub Desktop and see how we can handle this change.

After making the change to the \texttt{sample.R} file, open GitHub Desktop again. You will notice that GitHub Desktop automatically detects the difference between the new and old versions of the file. It highlights the specific parts of the script that have been edited, which can be extremely helpful when reviewing and comparing changes in your code.

This feature provided by GitHub Desktop makes it easier to track modifications and understand the specific updates made to your files. It helps streamline the coding process by providing a clear visual representation of the differences between different versions of your code.

\begin{figure}

{\centering \includegraphics[width=61.11in]{image/git_image06} 

}

\caption{Git detects edits to your codes}\label{fig:gitdesktop5}
\end{figure}

\hypertarget{appendix-data-structure}{%
\chapter{Appendix: Data Structure}\label{appendix-data-structure}}

\hypertarget{overview}{%
\section{Overview}\label{overview}}

R has 6 basic \textbf{data types}.

\begin{itemize}
\tightlist
\item
  character: \texttt{"aquatic"}, \texttt{"ecology"} (no order)
\item
  factor: similar to character, but has \emph{levels} (alphabetically ordered by default)
\item
  numeric: \texttt{20.0} , \texttt{15.5}
\item
  integer: \texttt{3}, \texttt{7}
\item
  logical: \texttt{TRUE} , \texttt{FALSE}
\item
  complex: \texttt{1+2i} (complex numbers with real and imaginary parts)
\end{itemize}

These elements form one of the following \textbf{data structures}.

\begin{itemize}
\tightlist
\item
  \textbf{vector}: a series of elements. A single data type is allowed in a single vector
\item
  \textbf{matrix}: elements organized into rows and columns. A single data type is allowed in a single matrix
\item
  \textbf{data frame}: looks similar to a matrix, but allows different data types in different columns
\end{itemize}

\hypertarget{vector}{%
\section{Vector}\label{vector}}

\hypertarget{create-vector}{%
\subsection{Create Vector}\label{create-vector}}

Below are examples of atomic character vectors, numeric vectors, integer vectors, etc. There are many ways to create vector data. The following examples use \texttt{c()}, \texttt{:}, \texttt{seq()}, \texttt{rep()}:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#ex.1a manually create a vector using c()}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{8}\NormalTok{)}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 3 4 8
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#ex.1b character}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"a"}\NormalTok{, }\StringTok{"b"}\NormalTok{, }\StringTok{"c"}\NormalTok{)}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "a" "b" "c"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#ex.1c logical}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\ConstantTok{TRUE}\NormalTok{, }\ConstantTok{FALSE}\NormalTok{, }\ConstantTok{FALSE}\NormalTok{)}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  TRUE FALSE FALSE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#ex.2 sequence of numbers}
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 2 3 4 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#ex.3a replicate same numbers or characters}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{2}\NormalTok{, }\DecValTok{5}\NormalTok{) }\CommentTok{\# replicate 2 five times}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2 2 2 2 2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#ex.3b replicate same numbers or characters}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\StringTok{"a"}\NormalTok{, }\DecValTok{5}\NormalTok{) }\CommentTok{\# replicate "a" five times}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "a" "a" "a" "a" "a"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#ex.4a use seq() function}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{5}\NormalTok{, }\AttributeTok{by =} \DecValTok{1}\NormalTok{)}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 2 3 4 5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#ex.4b use seq() function}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{seq}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{5}\NormalTok{, }\AttributeTok{by =} \FloatTok{0.1}\NormalTok{)}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  [1] 1.0 1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9 2.0 2.1 2.2 2.3 2.4 2.5 2.6 2.7 2.8
## [20] 2.9 3.0 3.1 3.2 3.3 3.4 3.5 3.6 3.7 3.8 3.9 4.0 4.1 4.2 4.3 4.4 4.5 4.6 4.7
## [39] 4.8 4.9 5.0
\end{verbatim}

\hypertarget{check-features}{%
\subsection{Check Features}\label{check-features}}

R provides many functions to examine features of vectors and other objects, for example:

\begin{itemize}
\tightlist
\item
  \texttt{class()} - return high-level data structure of the object
\item
  \texttt{typeof()} - return low-level data structure of the object
\item
  \texttt{attributes()} - metadata of the object
\item
  \texttt{length()} - number of elements in the object
\item
  \texttt{sum()} - sum of object's elements
\item
  \texttt{mean()} - mean of object's elements
\end{itemize}

\textbf{Numeric Vector}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FloatTok{1.2}\NormalTok{, }\FloatTok{3.1}\NormalTok{, }\FloatTok{4.0}\NormalTok{, }\FloatTok{8.2}\NormalTok{)}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1.2 3.1 4.0 8.2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{class}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "numeric"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{typeof}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "double"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{length}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sum}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 16.5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{mean}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 4.125
\end{verbatim}

\textbf{Character Vector}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"a"}\NormalTok{, }\StringTok{"b"}\NormalTok{, }\StringTok{"c"}\NormalTok{)}
\FunctionTok{class}\NormalTok{(y)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "character"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{length}\NormalTok{(y)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3
\end{verbatim}

\hypertarget{access}{%
\subsection{Access}\label{access}}

\textbf{Element ID}\\
Use brackets \texttt{{[}{]}} when accessing specific elements in an object. For example, if you want to access element \#2 in the vector \texttt{x}, you may specify as \texttt{x{[}2{]}}:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{5}\NormalTok{)}
\NormalTok{x[}\DecValTok{2}\NormalTok{] }\CommentTok{\# access element \#2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x[}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{)] }\CommentTok{\# access elements \#2 and 4}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2 2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x[}\DecValTok{2}\SpecialCharTok{:}\DecValTok{4}\NormalTok{] }\CommentTok{\# access elements \#2{-}4}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2 3 2
\end{verbatim}

\textbf{Equation}\\
R provides many ways to access elements that suffice specific conditions. You can use mathematical symbols to specify what you need, for example:

\begin{itemize}
\tightlist
\item
  \texttt{==} equal
\item
  \texttt{\textgreater{}} larger than
\item
  \texttt{\textgreater{}=} equal \& larger than
\item
  \texttt{\textless{}} smaller than
\item
  \texttt{\textless{}=} equal \& smaller than
\item
  \texttt{which()} a function that returns element \# that suffices the specified condition
\end{itemize}

The following examples return a logical vector indicating whether each element in x suffices the specified condition:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# creating a vector}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{5}\NormalTok{)}

\CommentTok{\# ex.1a equal}
\NormalTok{x }\SpecialCharTok{==} \DecValTok{2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  TRUE  TRUE FALSE  TRUE FALSE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ex.1b larger than}
\NormalTok{x }\SpecialCharTok{\textgreater{}} \DecValTok{2} 
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] FALSE FALSE  TRUE FALSE  TRUE
\end{verbatim}

You can access elements that suffice the specified condition using brackets, for example:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ex.2a equal}
\NormalTok{x[x }\SpecialCharTok{==} \DecValTok{2}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2 2 2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ex.2b larger than}
\NormalTok{x[x }\SpecialCharTok{\textgreater{}} \DecValTok{2}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3 5
\end{verbatim}

Using \texttt{which()}, you can see which elements (i.e., \#) matches what you need:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ex.3a equal}
\FunctionTok{which}\NormalTok{(x }\SpecialCharTok{==} \DecValTok{2}\NormalTok{) }\CommentTok{\# returns which elements are equal to 2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1 2 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# ex.3b larger than}
\FunctionTok{which}\NormalTok{(x }\SpecialCharTok{\textgreater{}} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3 5
\end{verbatim}

\hypertarget{matrix}{%
\section{Matrix}\label{matrix}}

\hypertarget{create-matrix}{%
\subsection{Create Matrix}\label{create-matrix}}

Matrix is a set of elements (\emph{single data type}) that are organized into rows and columns:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#ex.1 cbind: combine objects by column}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{cbind}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{), }\FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{))}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2]
## [1,]    1    4
## [2,]    2    5
## [3,]    3    6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#ex.2 rbind: combine objects by row}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{), }\FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{))}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]    4    5    6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#ex.3 matrix: specify elements and the number of rows (nrow) and columns (ncol)}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{9}\NormalTok{, }\AttributeTok{nrow =} \DecValTok{3}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{3}\NormalTok{)}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9
\end{verbatim}

\hypertarget{check-features-1}{%
\subsection{Check Features}\label{check-features-1}}

R provides many functions to examine features of matrix data, for example:

\begin{itemize}
\tightlist
\item
  \texttt{dim()} number of rows and columns
\item
  \texttt{rowSums()} row sums
\item
  \texttt{colSums()} column sums
\end{itemize}

\textbf{Integer Matrix}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{9}\NormalTok{, }\AttributeTok{nrow =} \DecValTok{3}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{3}\NormalTok{)}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{class}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "matrix" "array"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{typeof}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "integer"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dim}\NormalTok{(x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3 3
\end{verbatim}

\textbf{Character Matrix}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"a"}\NormalTok{,}\StringTok{"b"}\NormalTok{, }\StringTok{"c"}\NormalTok{, }\StringTok{"d"}\NormalTok{, }\StringTok{"e"}\NormalTok{, }\StringTok{"f"}\NormalTok{), }\AttributeTok{nrow =} \DecValTok{3}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{2}\NormalTok{)}
\NormalTok{y}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2]
## [1,] "a"  "d" 
## [2,] "b"  "e" 
## [3,] "c"  "f"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{class}\NormalTok{(y)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "matrix" "array"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{typeof}\NormalTok{(y)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "character"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{dim}\NormalTok{(y)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3 2
\end{verbatim}

\hypertarget{access-1}{%
\subsection{Access}\label{access-1}}

When accessing matrix elements, you need to pick row(s) and/or column(s), for example:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{9}\NormalTok{, }\AttributeTok{nrow =} \DecValTok{3}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{3}\NormalTok{)}
\NormalTok{x}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x[}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{] }\CommentTok{\# access an element in row \#2 and colum \#3}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 8
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x[}\DecValTok{2}\NormalTok{,] }\CommentTok{\# access elements in row \#2}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2 5 8
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x[}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{),] }\CommentTok{\# access elements in rows \#2 and 3}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2] [,3]
## [1,]    2    5    8
## [2,]    3    6    9
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x[,}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{)] }\CommentTok{\# access elements in columns \#2 and 3}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      [,1] [,2]
## [1,]    4    7
## [2,]    5    8
## [3,]    6    9
\end{verbatim}

You can assess each element with mathematical expressions just like vectors:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\SpecialCharTok{==} \DecValTok{2} \CommentTok{\# equal}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       [,1]  [,2]  [,3]
## [1,] FALSE FALSE FALSE
## [2,]  TRUE FALSE FALSE
## [3,] FALSE FALSE FALSE
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\SpecialCharTok{\textgreater{}} \DecValTok{2} \CommentTok{\# larger than}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       [,1] [,2] [,3]
## [1,] FALSE TRUE TRUE
## [2,] FALSE TRUE TRUE
## [3,]  TRUE TRUE TRUE
\end{verbatim}

However, care must be taken when accessing elements, as it will be automatically converted to vector data:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x[x }\SpecialCharTok{==} \DecValTok{2}\NormalTok{] }\CommentTok{\# equal}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x[x }\SpecialCharTok{\textgreater{}} \DecValTok{2}\NormalTok{] }\CommentTok{\# larger than}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3 4 5 6 7 8 9
\end{verbatim}

\texttt{which()} needs an additional argument to return both row and column \#:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{which}\NormalTok{(x }\SpecialCharTok{==} \DecValTok{2}\NormalTok{, }\AttributeTok{arr.ind =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      row col
## [1,]   2   1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{which}\NormalTok{(x }\SpecialCharTok{\textgreater{}} \DecValTok{2}\NormalTok{, }\AttributeTok{arr.ind =} \ConstantTok{TRUE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      row col
## [1,]   3   1
## [2,]   1   2
## [3,]   2   2
## [4,]   3   2
## [5,]   1   3
## [6,]   2   3
## [7,]   3   3
\end{verbatim}

\hypertarget{data-frame}{%
\section{Data Frame}\label{data-frame}}

A data frame is a collection of elements organized into rows and columns, but it differs from a matrix in several ways.

\begin{itemize}
\tightlist
\item
  It allows for the inclusion of \emph{multiple data types} in different columns.
\item
  Each column in a data frame has a \emph{name} associated with it.
\item
  You can access columns in a data frame by their respective names using the \texttt{\$} operator.
\end{itemize}

The data frame is the most commonly used data structure when manipulating ecological data. When loading a dataset from a spreadsheet (which we will discuss later), it is automatically recognized as a data frame. Let's consider an example:

\textbf{Creating a data frame}\\
In the following example, the variables \texttt{x} and \texttt{y} are organized into a single data frame named \texttt{df0}. The variables are renamed as part of the process of creating the data frame.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Create data frame}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Pristine"}\NormalTok{, }\StringTok{"Pristine"}\NormalTok{, }\StringTok{"Disturbed"}\NormalTok{, }\StringTok{"Disturbed"}\NormalTok{, }\StringTok{"Pristine"}\NormalTok{) }\CommentTok{\# Lake type}
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\FloatTok{1.2}\NormalTok{, }\FloatTok{2.2}\NormalTok{, }\FloatTok{10.9}\NormalTok{, }\FloatTok{50.0}\NormalTok{, }\FloatTok{3.0}\NormalTok{) }\CommentTok{\# TSS: total suspended solids (mg/L)}
\NormalTok{df0 }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{LakeType =}\NormalTok{ x, }\AttributeTok{TSS =}\NormalTok{ y) }\CommentTok{\# x is named as "LakeType" while y is named as "TSS"}
\NormalTok{df0}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    LakeType  TSS
## 1  Pristine  1.2
## 2  Pristine  2.2
## 3 Disturbed 10.9
## 4 Disturbed 50.0
## 5  Pristine  3.0
\end{verbatim}

\textbf{Call column names}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{colnames}\NormalTok{(df0) }\CommentTok{\# call column names}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "LakeType" "TSS"
\end{verbatim}

\textbf{Access by columns}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df0}\SpecialCharTok{$}\NormalTok{LakeType }\CommentTok{\# access LakeType}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Pristine"  "Pristine"  "Disturbed" "Disturbed" "Pristine"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df0}\SpecialCharTok{$}\NormalTok{TSS }\CommentTok{\# access TSS}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  1.2  2.2 10.9 50.0  3.0
\end{verbatim}

You can access elements like a matrix as well:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df0[,}\DecValTok{1}\NormalTok{] }\CommentTok{\# access column \#1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] "Pristine"  "Pristine"  "Disturbed" "Disturbed" "Pristine"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df0[}\DecValTok{1}\NormalTok{,] }\CommentTok{\# access row \#1}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   LakeType TSS
## 1 Pristine 1.2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df0[}\FunctionTok{c}\NormalTok{(}\DecValTok{2}\NormalTok{,}\DecValTok{4}\NormalTok{),] }\CommentTok{\# access row \#2 and 4}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    LakeType  TSS
## 2  Pristine  2.2
## 4 Disturbed 50.0
\end{verbatim}

\hypertarget{exercise}{%
\section{Exercise}\label{exercise}}

\hypertarget{vector-1}{%
\subsection{Vector}\label{vector-1}}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  Create three numeric vectors with length 3, 6 and 20, respectively. Each vector must be created using different functions in R.
\item
  Create three character vectors with length 3, 6 and 20, respectively. Each vector must be created using different functions in R.
\item
  Copy the following script to your R script and perform the following analysis:
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Identify element IDs of \texttt{x} that are greater than \texttt{2.0}
\item
  Identify element values of \texttt{x} that are greater than \texttt{2.0}
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{1}\NormalTok{)}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{100}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{matrix-1}{%
\subsection{Matrix}\label{matrix-1}}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  Create a numeric matrix with 4 rows and 4 columns. Each column must contain identical elements.
\item
  Create a numeric matrix with 4 rows and 4 columns. Each row must contain identical elements.
\item
  Create a character matrix with 4 rows and 4 columns. Each column must contain identical elements.
\item
  Create a character matrix with 4 rows and 4 columns. Each row must contain identical elements.
\item
  Copy the following script to your R script and perform the following analysis:
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Identify element IDs of \texttt{x} that are greater than \texttt{2.0} (\textbf{specify row and column IDs})
\item
  Identify element values of \texttt{x} that are greater than \texttt{2.0} and calculate the mean.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{1}\NormalTok{)}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{rnorm}\NormalTok{(}\DecValTok{100}\NormalTok{), }\AttributeTok{nrow =} \DecValTok{10}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{data-frame-1}{%
\subsection{Data Frame}\label{data-frame-1}}

\begin{enumerate}
\def\labelenumi{\alph{enumi}.}
\tightlist
\item
  Create a data frame of 3 variables with 10 elements (name variables as \texttt{x}, \texttt{y} and \texttt{z}. \texttt{x} must be \texttt{character} while \texttt{y} and \texttt{z} must be \texttt{numeric}.
\item
  Check the data structure (higher-level) of \texttt{x}, \texttt{y} and \texttt{z}
\item
  Copy the following script to your R script and perform the following analysis:
\end{enumerate}

\begin{itemize}
\tightlist
\item
  Calculate the means of \texttt{temperature} and \texttt{abundance} for states \texttt{VA} and \texttt{NC} separately.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{1}\NormalTok{)}
\NormalTok{x }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{100}\NormalTok{, }\AttributeTok{mean =} \DecValTok{10}\NormalTok{, }\AttributeTok{sd =} \DecValTok{3}\NormalTok{)}
\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{rpois}\NormalTok{(}\DecValTok{100}\NormalTok{, }\AttributeTok{lambda =} \DecValTok{10}\NormalTok{)}
\NormalTok{z }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\StringTok{"VA"}\NormalTok{, }\StringTok{"NC"}\NormalTok{), }\DecValTok{50}\NormalTok{)}
\NormalTok{df0 }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{temperature =}\NormalTok{ x, }\AttributeTok{abundance =}\NormalTok{ y, }\AttributeTok{state =}\NormalTok{ z)}
\end{Highlighting}
\end{Shaded}

\hypertarget{appendix-tidyverse}{%
\chapter{Appendix: Tidyverse}\label{appendix-tidyverse}}

\hypertarget{overview-1}{%
\section{Overview}\label{overview-1}}

R packages are collections of functions that extend the functionality of the R programming language. They provide a convenient way for users to access and utilize specialized tools for data analysis, visualization, statistical modeling, and more. Among them, \texttt{tidyverse} provides very useful functions for data manipulation and visualization.

\texttt{tidyverse::} bundles R packages designed to make data manipulation, exploration, and visualization more efficient and intuitive. Developed by Hadley Wickham and other contributors, the Tidyverse packages share a common philosophy and syntax, emphasizing a consistent and tidy data format. The core packages, such as \texttt{dplyr::}, \texttt{tidyr::}, and \texttt{ggplot2::}, provide powerful tools for data wrangling, reshaping, and creating visualizations.

In this Chapter, we will use \texttt{iris} data, which is available by default in R. While the default data structure \texttt{iris} is prepared in \texttt{data.frame()}, I convert this data format to \texttt{tibble()} in this exercise.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\NormalTok{iris }\OtherTok{\textless{}{-}} \FunctionTok{as\_tibble}\NormalTok{(iris)}
\end{Highlighting}
\end{Shaded}

I cover the basics for those who are not familiar with \texttt{tidyverse::}, but there is plenty of documentation available for the tidyverse package.

\begin{itemize}
\tightlist
\item
  \href{https://www.tidyverse.org/}{Tidyverse website}
\item
  \href{https://dplyr.tidyverse.org/}{dplyr}
\item
  \href{https://tidyr.tidyverse.org/}{tidyr}
\item
  \href{https://r-graph-gallery.com/ggplot2-package.html}{ggplot2}
\item
  \href{https://www.data-to-viz.com/}{from Data to Viz}
\end{itemize}

\hypertarget{data-manipulation}{%
\section{Data Manipulation}\label{data-manipulation}}

\hypertarget{data-format}{%
\subsection{Data Format}\label{data-format}}

\texttt{dplyr::} and \texttt{tidyr::} (and others) offer useful functions for data manipulation. Key manipulations include: row/column manipulations, group operation, reshape, and more.

\hypertarget{row-manipulation}{%
\subsection{Row Manipulation}\label{row-manipulation}}

\texttt{filter()}: select/remove rows

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# single match "=="}
\FunctionTok{filter}\NormalTok{(iris, Species }\SpecialCharTok{==} \StringTok{"virginica"}\NormalTok{)}

\CommentTok{\# multiple match "\%in\%"}
\FunctionTok{filter}\NormalTok{(iris, Species }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"virginica"}\NormalTok{, }\StringTok{"versicolor"}\NormalTok{))}

\CommentTok{\# except "!="}
\FunctionTok{filter}\NormalTok{(iris, Species }\SpecialCharTok{!=} \StringTok{"virginica"}\NormalTok{)}

\CommentTok{\# except multiple "!(x \%in\% c("a", "b"))}
\FunctionTok{filter}\NormalTok{(iris, }\SpecialCharTok{!}\NormalTok{(Species }\SpecialCharTok{\%in\%} \FunctionTok{c}\NormalTok{(}\StringTok{"virginica"}\NormalTok{, }\StringTok{"versicolor"}\NormalTok{)))}

\CommentTok{\# greater than "\textgreater{}"}
\FunctionTok{filter}\NormalTok{(iris, Sepal.Length }\SpecialCharTok{\textgreater{}} \DecValTok{5}\NormalTok{)}

\CommentTok{\# equal \& greater than "\textgreater{}="}
\FunctionTok{filter}\NormalTok{(iris, Sepal.Length }\SpecialCharTok{\textgreater{}=} \DecValTok{5}\NormalTok{)}

\CommentTok{\# less than "\textless{}"}
\FunctionTok{filter}\NormalTok{(iris, Sepal.Length }\SpecialCharTok{\textless{}} \DecValTok{5}\NormalTok{)}

\CommentTok{\# equal \& less than "\textless{}="}
\FunctionTok{filter}\NormalTok{(iris, Sepal.Length }\SpecialCharTok{\textless{}=} \DecValTok{5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\texttt{arrange()} : arrange the order of rows

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# arrange in an ascending order}
\FunctionTok{arrange}\NormalTok{(iris, Sepal.Length)}

\CommentTok{\# arrange in an descending order}
\FunctionTok{arrange}\NormalTok{(iris, }\FunctionTok{desc}\NormalTok{(Sepal.Length))}
\end{Highlighting}
\end{Shaded}

\hypertarget{column-manipulation}{%
\subsection{Column Manipulation}\label{column-manipulation}}

\texttt{select()}: select/remove column(s)

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# select one column}
\FunctionTok{select}\NormalTok{(iris, Sepal.Length)}

\CommentTok{\# select multiple columns}
\FunctionTok{select}\NormalTok{(iris, }\FunctionTok{c}\NormalTok{(Sepal.Length, Sepal.Width))}

\CommentTok{\# remove one column}
\FunctionTok{select}\NormalTok{(iris, }\SpecialCharTok{{-}}\NormalTok{Sepal.Length)}

\CommentTok{\# remove multiple columns}
\FunctionTok{select}\NormalTok{(iris, }\SpecialCharTok{{-}}\FunctionTok{c}\NormalTok{(Sepal.Length, Sepal.Width))}

\CommentTok{\# select/remove multiple columns with a start rule}
\CommentTok{\# starts\_with("x")}
\FunctionTok{select}\NormalTok{(iris, }\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"Sepal"}\NormalTok{))}
\FunctionTok{select}\NormalTok{(iris, }\SpecialCharTok{{-}}\FunctionTok{starts\_with}\NormalTok{(}\StringTok{"Sepal"}\NormalTok{))}

\CommentTok{\# select/remove multiple columns with an end rule}
\CommentTok{\# ends\_with("x")}
\FunctionTok{select}\NormalTok{(iris, }\FunctionTok{ends\_with}\NormalTok{(}\StringTok{"Width"}\NormalTok{))}
\FunctionTok{select}\NormalTok{(iris, }\SpecialCharTok{{-}}\FunctionTok{ends\_with}\NormalTok{(}\StringTok{"Width"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\texttt{mutate()}: add column(s)

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# add a new column}
\NormalTok{x }\OtherTok{\textless{}{-}} \DecValTok{1}\SpecialCharTok{:}\DecValTok{150}
\FunctionTok{mutate}\NormalTok{(iris, }\AttributeTok{x =}\NormalTok{ x)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 150 x 6
##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species     x
##           <dbl>       <dbl>        <dbl>       <dbl> <fct>   <int>
##  1          5.1         3.5          1.4         0.2 setosa      1
##  2          4.9         3            1.4         0.2 setosa      2
##  3          4.7         3.2          1.3         0.2 setosa      3
##  4          4.6         3.1          1.5         0.2 setosa      4
##  5          5           3.6          1.4         0.2 setosa      5
##  6          5.4         3.9          1.7         0.4 setosa      6
##  7          4.6         3.4          1.4         0.3 setosa      7
##  8          5           3.4          1.5         0.2 setosa      8
##  9          4.4         2.9          1.4         0.2 setosa      9
## 10          4.9         3.1          1.5         0.1 setosa     10
## # i 140 more rows
\end{verbatim}

\hypertarget{piping}{%
\subsection{Piping}\label{piping}}

\texttt{\%\textgreater{}\%} (pipe) allows sequential operations of multiple functions (shortcut: \texttt{Ctr\ +\ Shift\ +\ M}). The pipe passes the object to the following function as the first argument.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# the following codes produce the same data frame}
\CommentTok{\# apply functions separately}
\NormalTok{df\_vir }\OtherTok{\textless{}{-}} \FunctionTok{filter}\NormalTok{(iris, Species }\SpecialCharTok{==} \StringTok{"virginica"}\NormalTok{)}
\NormalTok{df\_vir\_sl }\OtherTok{\textless{}{-}} \FunctionTok{select}\NormalTok{(df\_vir, Sepal.Length)}
\FunctionTok{print}\NormalTok{(df\_vir\_sl)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 50 x 1
##    Sepal.Length
##           <dbl>
##  1          6.3
##  2          5.8
##  3          7.1
##  4          6.3
##  5          6.5
##  6          7.6
##  7          4.9
##  8          7.3
##  9          6.7
## 10          7.2
## # i 40 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# piping}
\NormalTok{iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{filter}\NormalTok{(Species }\SpecialCharTok{==} \StringTok{"virginica"}\NormalTok{) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{select}\NormalTok{(Sepal.Length)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 50 x 1
##    Sepal.Length
##           <dbl>
##  1          6.3
##  2          5.8
##  3          7.1
##  4          6.3
##  5          6.5
##  6          7.6
##  7          4.9
##  8          7.3
##  9          6.7
## 10          7.2
## # i 40 more rows
\end{verbatim}

\hypertarget{reshape}{%
\subsection{Reshape}\label{reshape}}

\texttt{pivot\_wider()} : reshape a data frame to a wide format

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{iris\_w }\OtherTok{\textless{}{-}}\NormalTok{ iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{id =} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{50}\NormalTok{, }\DecValTok{3}\NormalTok{)) }\SpecialCharTok{\%\textgreater{}\%} \CommentTok{\# add an ID column}
  \FunctionTok{select}\NormalTok{(id, Sepal.Length, Species) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pivot\_wider}\NormalTok{(}\AttributeTok{id\_cols =} \StringTok{"id"}\NormalTok{, }\CommentTok{\# unique row ID based on}
              \AttributeTok{values\_from =} \StringTok{"Sepal.Length"}\NormalTok{, }\CommentTok{\# values in each cell from}
              \AttributeTok{names\_from =} \StringTok{"Species"}\NormalTok{) }\CommentTok{\# new column names from}

\FunctionTok{print}\NormalTok{(iris\_w)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 50 x 4
##       id setosa versicolor virginica
##    <int>  <dbl>      <dbl>     <dbl>
##  1     1    5.1        7         6.3
##  2     2    4.9        6.4       5.8
##  3     3    4.7        6.9       7.1
##  4     4    4.6        5.5       6.3
##  5     5    5          6.5       6.5
##  6     6    5.4        5.7       7.6
##  7     7    4.6        6.3       4.9
##  8     8    5          4.9       7.3
##  9     9    4.4        6.6       6.7
## 10    10    4.9        5.2       7.2
## # i 40 more rows
\end{verbatim}

\texttt{pivot\_longer()}: reshape a data frame to a long format

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{iris\_l }\OtherTok{\textless{}{-}}\NormalTok{ iris\_w }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{pivot\_longer}\NormalTok{(}\AttributeTok{cols =} \FunctionTok{c}\NormalTok{(}\StringTok{"setosa"}\NormalTok{,}
                        \StringTok{"versicolor"}\NormalTok{,}
                        \StringTok{"virginica"}\NormalTok{), }\CommentTok{\# columns with values to be reshaped}
               \AttributeTok{names\_to =} \StringTok{"Species"}\NormalTok{, }\CommentTok{\# column IDs move to "Species"}
               \AttributeTok{values\_to =} \StringTok{"Sepal.Length"}\NormalTok{) }\CommentTok{\# column values move to "Sepal.Length"}

\FunctionTok{print}\NormalTok{(iris\_l)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 150 x 3
##       id Species    Sepal.Length
##    <int> <chr>             <dbl>
##  1     1 setosa              5.1
##  2     1 versicolor          7  
##  3     1 virginica           6.3
##  4     2 setosa              4.9
##  5     2 versicolor          6.4
##  6     2 virginica           5.8
##  7     3 setosa              4.7
##  8     3 versicolor          6.9
##  9     3 virginica           7.1
## 10     4 setosa              4.6
## # i 140 more rows
\end{verbatim}

\hypertarget{group-operation}{%
\subsection{Group Operation}\label{group-operation}}

\texttt{group\_by()} \& \texttt{summarize()}: group-by-group operation. \texttt{summarize()} does not retain individual rows.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# grouping by "Species", then take means "Speal.Length" for each species}
\NormalTok{iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(Species) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{mu\_sl =} \FunctionTok{mean}\NormalTok{(Sepal.Length))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 3 x 2
##   Species    mu_sl
##   <fct>      <dbl>
## 1 setosa      5.01
## 2 versicolor  5.94
## 3 virginica   6.59
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# grouping by "Species", then take means \& SD "Speal.Length" for each species}
\NormalTok{iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(Species) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{summarize}\NormalTok{(}\AttributeTok{mu\_sl =} \FunctionTok{mean}\NormalTok{(Sepal.Length),}
            \AttributeTok{sd\_sl =} \FunctionTok{sd}\NormalTok{(Sepal.Length))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 3 x 3
##   Species    mu_sl sd_sl
##   <fct>      <dbl> <dbl>
## 1 setosa      5.01 0.352
## 2 versicolor  5.94 0.516
## 3 virginica   6.59 0.636
\end{verbatim}

\texttt{group\_by()} \& \texttt{mutate()}: group-by-group operation. \texttt{mutate()} retains individual rows along with summary columns. Do not forget \texttt{ungroup()} to avoid errors in following operations.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# grouping by "Species", then take means "Speal.Length" for each species}
\NormalTok{iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{group\_by}\NormalTok{(Species) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{mutate}\NormalTok{(}\AttributeTok{mu\_sl =} \FunctionTok{mean}\NormalTok{(Sepal.Length)) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ungroup}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 150 x 6
##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species mu_sl
##           <dbl>       <dbl>        <dbl>       <dbl> <fct>   <dbl>
##  1          5.1         3.5          1.4         0.2 setosa   5.01
##  2          4.9         3            1.4         0.2 setosa   5.01
##  3          4.7         3.2          1.3         0.2 setosa   5.01
##  4          4.6         3.1          1.5         0.2 setosa   5.01
##  5          5           3.6          1.4         0.2 setosa   5.01
##  6          5.4         3.9          1.7         0.4 setosa   5.01
##  7          4.6         3.4          1.4         0.3 setosa   5.01
##  8          5           3.4          1.5         0.2 setosa   5.01
##  9          4.4         2.9          1.4         0.2 setosa   5.01
## 10          4.9         3.1          1.5         0.1 setosa   5.01
## # i 140 more rows
\end{verbatim}

\hypertarget{join}{%
\subsection{Join}\label{join}}

\texttt{left\_join()}: merge data frames based on column(s)

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# matching by a single column}
\DocumentationTok{\#\# left join by "Species": one to one}
\NormalTok{df1 }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{Species =} \FunctionTok{c}\NormalTok{(}\StringTok{"A"}\NormalTok{, }\StringTok{"B"}\NormalTok{, }\StringTok{"C"}\NormalTok{),}
              \AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{))}

\NormalTok{df2 }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{Species =} \FunctionTok{c}\NormalTok{(}\StringTok{"A"}\NormalTok{, }\StringTok{"B"}\NormalTok{, }\StringTok{"C"}\NormalTok{),}
              \AttributeTok{y =} \FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{))}

\FunctionTok{left\_join}\NormalTok{(}\AttributeTok{x =}\NormalTok{ df1,}
          \AttributeTok{y =}\NormalTok{ df2,}
          \AttributeTok{by =} \StringTok{"Species"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 3 x 3
##   Species     x     y
##   <chr>   <dbl> <dbl>
## 1 A           1     4
## 2 B           2     5
## 3 C           3     6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# matching by a single column}
\DocumentationTok{\#\# left join by "Species": one to many}
\NormalTok{df3 }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{Species =} \FunctionTok{c}\NormalTok{(}\StringTok{"A"}\NormalTok{, }\StringTok{"A"}\NormalTok{, }\StringTok{"B"}\NormalTok{, }\StringTok{"C"}\NormalTok{),}
              \AttributeTok{y =} \FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{7}\NormalTok{))}

\FunctionTok{left\_join}\NormalTok{(}\AttributeTok{x =}\NormalTok{ df1,}
          \AttributeTok{y =}\NormalTok{ df3,}
          \AttributeTok{by =} \StringTok{"Species"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 4 x 3
##   Species     x     y
##   <chr>   <dbl> <dbl>
## 1 A           1     4
## 2 A           1     5
## 3 B           2     6
## 4 C           3     7
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# matching by a single column}
\DocumentationTok{\#\# left join by "Species": one to missing}
\NormalTok{df4 }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{Species =} \FunctionTok{c}\NormalTok{(}\StringTok{"A"}\NormalTok{, }\StringTok{"A"}\NormalTok{, }\StringTok{"C"}\NormalTok{),}
              \AttributeTok{y =} \FunctionTok{c}\NormalTok{(}\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{7}\NormalTok{))}

\FunctionTok{left\_join}\NormalTok{(}\AttributeTok{x =}\NormalTok{ df1,}
          \AttributeTok{y =}\NormalTok{ df4,}
          \AttributeTok{by =} \StringTok{"Species"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 4 x 3
##   Species     x     y
##   <chr>   <dbl> <dbl>
## 1 A           1     4
## 2 A           1     5
## 3 B           2    NA
## 4 C           3     7
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# matching by multiple columns}
\DocumentationTok{\#\# one to one}
\NormalTok{df5 }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{Species =} \FunctionTok{c}\NormalTok{(}\StringTok{"A"}\NormalTok{, }\StringTok{"B"}\NormalTok{, }\StringTok{"C"}\NormalTok{),}
              \AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{),}
              \AttributeTok{z =} \FunctionTok{c}\NormalTok{(}\StringTok{"cool"}\NormalTok{, }\StringTok{"awesome"}\NormalTok{, }\StringTok{"magical"}\NormalTok{))}

\FunctionTok{left\_join}\NormalTok{(}\AttributeTok{x =}\NormalTok{ df1,}
          \AttributeTok{y =}\NormalTok{ df5,}
          \AttributeTok{by =} \FunctionTok{c}\NormalTok{(}\StringTok{"Species"}\NormalTok{, }\StringTok{"x"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 3 x 3
##   Species     x z      
##   <chr>   <dbl> <chr>  
## 1 A           1 cool   
## 2 B           2 awesome
## 3 C           3 magical
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# matching by multiple columns}
\DocumentationTok{\#\# one to many}
\NormalTok{df6 }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{Species =} \FunctionTok{c}\NormalTok{(}\StringTok{"A"}\NormalTok{, }\StringTok{"A"}\NormalTok{, }\StringTok{"B"}\NormalTok{, }\StringTok{"C"}\NormalTok{),}
              \AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{),}
              \AttributeTok{z =} \FunctionTok{c}\NormalTok{(}\StringTok{"cool"}\NormalTok{, }\StringTok{"cool"}\NormalTok{, }\StringTok{"awesome"}\NormalTok{, }\StringTok{"magical"}\NormalTok{))}

\FunctionTok{left\_join}\NormalTok{(}\AttributeTok{x =}\NormalTok{ df1,}
          \AttributeTok{y =}\NormalTok{ df6,}
          \AttributeTok{by =} \FunctionTok{c}\NormalTok{(}\StringTok{"Species"}\NormalTok{, }\StringTok{"x"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 4 x 3
##   Species     x z      
##   <chr>   <dbl> <chr>  
## 1 A           1 cool   
## 2 A           1 cool   
## 3 B           2 awesome
## 4 C           3 magical
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# matching by multiple columns}
\DocumentationTok{\#\# one to missing}
\NormalTok{df6 }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{Species =} \FunctionTok{c}\NormalTok{(}\StringTok{"A"}\NormalTok{, }\StringTok{"B"}\NormalTok{, }\StringTok{"C"}\NormalTok{),}
              \AttributeTok{x =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{4}\NormalTok{),}
              \AttributeTok{z =} \FunctionTok{c}\NormalTok{(}\StringTok{"cool"}\NormalTok{, }\StringTok{"awesome"}\NormalTok{, }\StringTok{"magical"}\NormalTok{))}

\FunctionTok{left\_join}\NormalTok{(}\AttributeTok{x =}\NormalTok{ df1,}
          \AttributeTok{y =}\NormalTok{ df6,}
          \AttributeTok{by =} \FunctionTok{c}\NormalTok{(}\StringTok{"Species"}\NormalTok{, }\StringTok{"x"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 3 x 3
##   Species     x z      
##   <chr>   <dbl> <chr>  
## 1 A           1 cool   
## 2 B           2 awesome
## 3 C           3 <NA>
\end{verbatim}

\hypertarget{visualization}{%
\section{Visualization}\label{visualization}}

\texttt{ggplot2::} offers a range of convenient functions for data visualization. The foundational function, \texttt{ggplot()}, provides the initial framework for adding supplementary layers using the \texttt{+} operator. In ggplot(), we define variables plotted on x- and y-axis through \texttt{aes()}. For example:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# without pipe}
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ iris,}
       \AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Sepal.Length,}
                     \AttributeTok{y =}\NormalTok{ Sepal.Width)) }\SpecialCharTok{+}
  \CommentTok{\# additional layers...}

\CommentTok{\# with pipe}
\NormalTok{iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\AttributeTok{mapping =} \FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Sepal.Length,}
                       \AttributeTok{y =}\NormalTok{ Sepal.Width)) }\SpecialCharTok{+}
  \CommentTok{\# additional layers...  }
\end{Highlighting}
\end{Shaded}

Please note that \texttt{aes()} refers to columns in the data frame. Variables names that do not exist in the data frame cannot be used.

\hypertarget{point}{%
\subsection{Point}\label{point}}

\texttt{geom\_point()} : Add a point layer

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# basic plot}
\NormalTok{iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Sepal.Length,}
             \AttributeTok{y =}\NormalTok{ Sepal.Width)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{_main_files/figure-latex/unnamed-chunk-83-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# change color by "Species" column}
\NormalTok{iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Sepal.Length,}
             \AttributeTok{y =}\NormalTok{ Sepal.Width,}
             \AttributeTok{color =}\NormalTok{ Species)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{_main_files/figure-latex/unnamed-chunk-83-2} \end{center}

\hypertarget{line}{%
\subsection{Line}\label{line}}

\texttt{geom\_line()} : Add a line layer

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# sample data}
\NormalTok{df0 }\OtherTok{\textless{}{-}} \FunctionTok{tibble}\NormalTok{(}\AttributeTok{x =} \FunctionTok{rep}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{50}\NormalTok{, }\DecValTok{3}\NormalTok{),}
              \AttributeTok{y =}\NormalTok{ x }\SpecialCharTok{*} \DecValTok{2}\NormalTok{)}

\CommentTok{\# basic plot}
\NormalTok{df0 }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ x,}
             \AttributeTok{y =}\NormalTok{ y)) }\SpecialCharTok{+}
  \FunctionTok{geom\_line}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{_main_files/figure-latex/unnamed-chunk-84-1} \end{center}

\hypertarget{histogram}{%
\subsection{Histogram}\label{histogram}}

\texttt{geom\_histogram()} : add a histogram layer

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# basic plot; bins = 30 by default}
\NormalTok{iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Sepal.Length)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{_main_files/figure-latex/unnamed-chunk-85-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# change bin width}
\NormalTok{iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Sepal.Length)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{binwidth =} \FloatTok{0.5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{_main_files/figure-latex/unnamed-chunk-85-2} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# change bin number}
\NormalTok{iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Sepal.Length)) }\SpecialCharTok{+}
  \FunctionTok{geom\_histogram}\NormalTok{(}\AttributeTok{bins =} \DecValTok{50}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{_main_files/figure-latex/unnamed-chunk-85-3} \end{center}

\hypertarget{boxplot}{%
\subsection{Boxplot}\label{boxplot}}

\texttt{geom\_boxplot()} : add a boxplot layer

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# basic plot}
\NormalTok{iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Species,}
             \AttributeTok{y =}\NormalTok{ Sepal.Length)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{_main_files/figure-latex/unnamed-chunk-86-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# change fill by "Species"}
\NormalTok{iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Species,}
             \AttributeTok{y =}\NormalTok{ Sepal.Length,}
             \AttributeTok{fill =}\NormalTok{ Species)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{_main_files/figure-latex/unnamed-chunk-86-2} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# change fill by "Species", but consistent color}
\NormalTok{iris }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{ggplot}\NormalTok{(}\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ Species,}
             \AttributeTok{y =}\NormalTok{ Sepal.Length,}
             \AttributeTok{fill =}\NormalTok{ Species)) }\SpecialCharTok{+}
  \FunctionTok{geom\_boxplot}\NormalTok{(}\AttributeTok{color =} \StringTok{"darkgrey"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{_main_files/figure-latex/unnamed-chunk-86-3} \end{center}

\hypertarget{appendix-base-plot}{%
\chapter{Appendix: Base Plot}\label{appendix-base-plot}}

\hypertarget{overview-2}{%
\section{Overview}\label{overview-2}}

R offers a variety of functions that aid in visualizing data. The \texttt{graphics} package in R provides a set of functions for basic graphics (\href{https://www.rdocumentation.org/packages/graphics/versions/3.6.2}{list of functions}). To demonstrate the functionality of these \texttt{graphics} functions, I will utilize the built-in \texttt{iris} dataset in R.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(iris)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 6 x 5
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
##          <dbl>       <dbl>        <dbl>       <dbl> <fct>  
## 1          5.1         3.5          1.4         0.2 setosa 
## 2          4.9         3            1.4         0.2 setosa 
## 3          4.7         3.2          1.3         0.2 setosa 
## 4          4.6         3.1          1.5         0.2 setosa 
## 5          5           3.6          1.4         0.2 setosa 
## 6          5.4         3.9          1.7         0.4 setosa
\end{verbatim}

\hypertarget{plot}{%
\section{Plot}\label{plot}}

When creating a plot, you typically need to specify the \textbf{formula} to define the relationship between variables. For instance, if you wish to visualize the association between \texttt{x} and \texttt{y} (with \texttt{y} on the vertical axis and \texttt{x} on the horizontal axis), the formula would be \texttt{y\ \textasciitilde{}\ x} (where the left side of the formula represents the vertical axis). In the \texttt{iris} dataset, you have access to the following columns: \texttt{Sepal.Length}, \texttt{Sepal.Width}, \texttt{Petal.Length}, \texttt{Petal.Width}, and \texttt{Species}. In the subsequent example, we will plot the relationship between \texttt{Sepal.Length} and \texttt{Sepal.Width}:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(Sepal.Length }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Sepal.Width, }\AttributeTok{data =}\NormalTok{ iris)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{_main_files/figure-latex/unnamed-chunk-88-1} \end{center}

The \texttt{data\ =} argument informs the function about the dataset from which the variables (\texttt{Sepal.Length} and \texttt{Sepal.Width}) should be extracted.

\hypertarget{symbol}{%
\subsection{Symbol}\label{symbol}}

\texttt{pch} argument. Choose from \texttt{1} to \texttt{25} (google \textbf{r plot pch} for details)

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(Sepal.Length }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Sepal.Width, }\AttributeTok{data =}\NormalTok{ iris,}
     \AttributeTok{pch =} \DecValTok{19}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{_main_files/figure-latex/unnamed-chunk-89-1} \end{center}

\hypertarget{symbol-size}{%
\subsection{Symbol size}\label{symbol-size}}

\texttt{cex} argument. \texttt{cex\ =\ 1} is the default value. \texttt{cex\ =\ 2} is as twice large as default value.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(Sepal.Length }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Sepal.Width, }\AttributeTok{data =}\NormalTok{ iris,}
     \AttributeTok{pch =} \DecValTok{19}\NormalTok{, }\AttributeTok{cex =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{_main_files/figure-latex/unnamed-chunk-90-1} \end{center}

\hypertarget{symbol-color-border}{%
\subsection{Symbol color (border)}\label{symbol-color-border}}

\texttt{col} argument (quote \texttt{"color\ name"} when specifying). Google \textbf{r color name} for color options.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(Sepal.Length }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Sepal.Width, }\AttributeTok{data =}\NormalTok{ iris,}
     \AttributeTok{pch =} \DecValTok{21}\NormalTok{, }\AttributeTok{cex =} \DecValTok{2}\NormalTok{, }\AttributeTok{col =} \StringTok{"gray"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{_main_files/figure-latex/unnamed-chunk-91-1} \end{center}

\hypertarget{symbol-color-fill}{%
\subsection{Symbol color (fill)}\label{symbol-color-fill}}

\texttt{bg} argument (quote \texttt{"color\ name"} when specifying). Available for a subset of symbol options (some symbols have pre-defined filled color).

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(Sepal.Length }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Sepal.Width, }\AttributeTok{data =}\NormalTok{ iris,}
     \AttributeTok{pch =} \DecValTok{21}\NormalTok{, }\AttributeTok{cex =} \DecValTok{2}\NormalTok{, }\AttributeTok{bg =} \StringTok{"lightgray"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{_main_files/figure-latex/unnamed-chunk-92-1} \end{center}

\hypertarget{label}{%
\subsection{Label}\label{label}}

\texttt{ylab} or \texttt{xlab} arguments. Provide \texttt{"quoted\ text"}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(Sepal.Length }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Sepal.Width, }\AttributeTok{data =}\NormalTok{ iris,}
     \AttributeTok{pch =} \DecValTok{21}\NormalTok{, }\AttributeTok{cex =} \DecValTok{2}\NormalTok{, }\AttributeTok{bg =} \StringTok{"lightgray"}\NormalTok{,}
     \AttributeTok{xlab =} \StringTok{"Sepal width (cm)"}\NormalTok{, }\AttributeTok{ylab =} \StringTok{"Sepal length (cm)"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{_main_files/figure-latex/unnamed-chunk-93-1} \end{center}

\hypertarget{axis}{%
\subsection{Axis}\label{axis}}

Delete axes with \texttt{axes\ =\ F} and re-draw with \texttt{box()} and \texttt{axis()} functions.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(Sepal.Length }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Sepal.Width, }\AttributeTok{data =}\NormalTok{ iris,}
     \AttributeTok{pch =} \DecValTok{21}\NormalTok{, }\AttributeTok{cex =} \DecValTok{2}\NormalTok{, }\AttributeTok{bg =} \StringTok{"lightgray"}\NormalTok{,}
     \AttributeTok{xlab =} \StringTok{"Sepal width (cm)"}\NormalTok{, }\AttributeTok{ylab =} \StringTok{"Sepal length (cm)"}\NormalTok{,}
     \AttributeTok{axes =}\NormalTok{ F)}
\FunctionTok{box}\NormalTok{(}\AttributeTok{bty =} \StringTok{"l"}\NormalTok{) }\CommentTok{\# L{-}shaped border lines}
\FunctionTok{axis}\NormalTok{(}\DecValTok{1}\NormalTok{) }\CommentTok{\# 1: draw x{-}axis}
\FunctionTok{axis}\NormalTok{(}\DecValTok{2}\NormalTok{, }\AttributeTok{las =} \DecValTok{2}\NormalTok{) }\CommentTok{\# 2: draw y{-}axis, las = 2: make axis lables horizontal}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{_main_files/figure-latex/unnamed-chunk-94-1} \end{center}

\hypertarget{boxplot-1}{%
\section{Boxplot}\label{boxplot-1}}

\texttt{boxplot()} is used when the x-axis is factor-type data (by default, \texttt{plot()} will produce a boxplot when x-axis is a factor variable). In the \texttt{iris} dataset, the column \texttt{Species} is a factor variable. Compare \texttt{Sepal.Length} among species using \texttt{boxplot()}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{boxplot}\NormalTok{(Sepal.Length }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Species, }\AttributeTok{data =}\NormalTok{ iris)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{_main_files/figure-latex/unnamed-chunk-95-1} \end{center}

You can customize as in \texttt{plot()}, but slighlty different.

\hypertarget{box-color}{%
\subsection{Box color}\label{box-color}}

\texttt{col} argument.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{boxplot}\NormalTok{(Sepal.Length }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Species, }\AttributeTok{data =}\NormalTok{ iris,}
        \AttributeTok{col =} \StringTok{"lightgray"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{_main_files/figure-latex/unnamed-chunk-96-1} \end{center}

\hypertarget{border-color}{%
\subsection{Border color}\label{border-color}}

\texttt{border} argument.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{boxplot}\NormalTok{(Sepal.Length }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Species, }\AttributeTok{data =}\NormalTok{ iris,}
        \AttributeTok{col =} \StringTok{"lightgray"}\NormalTok{, }\AttributeTok{border =} \StringTok{"grey48"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{_main_files/figure-latex/unnamed-chunk-97-1} \end{center}

\hypertarget{box-width}{%
\subsection{Box width}\label{box-width}}

\texttt{boxwex} argument.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{boxplot}\NormalTok{(Sepal.Length }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Species, }\AttributeTok{data =}\NormalTok{ iris,}
        \AttributeTok{col =} \StringTok{"lightgray"}\NormalTok{, }\AttributeTok{border =} \StringTok{"grey48"}\NormalTok{,}
        \AttributeTok{boxwex =} \FloatTok{0.4}\NormalTok{ )}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{_main_files/figure-latex/unnamed-chunk-98-1} \end{center}

\hypertarget{axis-1}{%
\subsection{Axis}\label{axis-1}}

Delete axes with \texttt{axes\ =\ F} and re-draw with \texttt{box()} and \texttt{axis()} functions.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{boxplot}\NormalTok{(Sepal.Length }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Species, }\AttributeTok{data =}\NormalTok{ iris,}
        \AttributeTok{col =} \StringTok{"lightgray"}\NormalTok{, }\AttributeTok{border =} \StringTok{"grey48"}\NormalTok{,}
        \AttributeTok{boxwex =} \FloatTok{0.4}\NormalTok{, }\AttributeTok{ylab =} \StringTok{"Sepal length (cm)"}\NormalTok{,}
        \AttributeTok{axes =}\NormalTok{ F)}
\FunctionTok{box}\NormalTok{(}\AttributeTok{bty =} \StringTok{"l"}\NormalTok{)}
\FunctionTok{axis}\NormalTok{(}\DecValTok{1}\NormalTok{, }\AttributeTok{at =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{, }\DecValTok{3}\NormalTok{), }\AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Setosa"}\NormalTok{, }\StringTok{"Versicolor"}\NormalTok{, }\StringTok{"Virginica"}\NormalTok{) )}
\FunctionTok{axis}\NormalTok{(}\DecValTok{2}\NormalTok{, }\AttributeTok{las =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics{_main_files/figure-latex/unnamed-chunk-99-1} \end{center}

\end{document}
