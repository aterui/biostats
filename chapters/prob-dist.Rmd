## Probability distribution

### Choose right one

Mean and variance are unknown constants[^02-sampling-2] -- these are what we refer to as **parameters**. Parameters are the focus of statistical inference because it allows the speculations for the *overall* structure of the population under investigation.

[^02-sampling-2]: At least for frequentist analysis.

To clarify this argument, let's think more about a **mean** -- more precisely speaking, an expected value of a *random* variable. A mean is a value around which data points are concentrated. This suggests that **the probability of observing data points close to this value is very high**. This is the reason why we use a mean as a "representative" summary statistic (e.g., mean height, mean weight, etc...), although many of us may use it without recognizing it. Then, what **variance** does for us? As you move away from the mean, the probability of observing that value will decrease. Variance tells you how *sharply* the probability decreases as a value deviates from the mean (smaller variance means sharper decline). Thus, these two parameters shape the distribution of probability across a range of possible values -- this is what we refer to as **a probability distribution**. Figure \@ref(fig:prob-dist) is the probability distribution drawn based on the parameters we estimated in the fish data. The distribution has the peak at the mean value (`r df_count %>% pull(count) %>% mean() %>% round(2)`) with curvy declines towards both tails. The y-axis is labeled as "probability density" to allow for the continuous expression of probability for continuous values on the x-axis[^02-sampling-3].

[^02-sampling-3]: You can define a probability for a range (e.g., $1 < x < 2$); otherwise, it must be probability "density" because you cannot define a probability for $x = 1.1$ due to the continuous nature of the variable $x$ (we don't know whether $x=1.1$ to be $x = 1.101~\text{or}~1.102~\text{or}....$)

```{r prob-dist, fig.cap="Example of probability distribution"}

x <- seq(-5, 10, length = 100)

df0 <- expand.grid(x = x,
                   mu = mean(df_count$count),
                   var = var(df_count$count)) %>% 
  tibble() %>% 
  mutate(y = dnorm(x, mu, sqrt(var)),
         color = paste0("mean = ", round(mu, 2), "; variance = ", round(var)))

df0 %>% 
  ggplot(aes(x = x,
             y = y,
             color = color)) +
  geom_line() +
  geom_vline(xintercept = mu,
             color = grey(0.6),
             linetype = "dashed") +
  labs(y = "Probability density",
       x = "Fish count",
       color = "Parameter") +
  theme_bw() +
  theme(panel.grid = element_blank(),
        legend.position = "top")
```

However, some of you might notice weird things in Figure \@ref(fig:prob-dist). First, the positive probability density extends below the "zero" fish count, which should not happen in nature (we cannot observe negative counts). Second, the fish count is treated as if it is a continuous variable, even though fish counts are always discrete values (there is no way to count 1.1 individuals for an individual survey plot, for example). When comparing this probability distribution with the fish count histogram, they do not look similar at all (Figure \@ref(fig:freq-data)))...even though they should look very similar if the probability distribution represents the data properly.

```{r freq-data, fig.cap="Frequency distribution of fish count data"}

df_count %>% 
  ggplot(aes(x = count)) +
  geom_histogram(binwidth = 0.1,
                 center = 0) +
  theme_bw() +
  scale_x_continuous(breaks = seq(0, 10, by = 1)) +
  labs(y = "Frequency",
       x = "Fish count")
```

> **Exercise:** Produce a histogram of fish count

Why does this happen? -- this is because this particular kind of probability distribution is inappropriate to express count data. The above example is drawn from a **Normal distribution**, whose outcome (values drawn from this distribution) ranges from $-\infty$ to $\infty$. To properly represent our fish count data, we must choose a probability distribution that can express discrete values of $\ge 0$ ($0, 1, 2, 3,...$). One possible choice for the fish count data is a **Poisson distribution**, whose outcome is confined to zero and positive discrete values. Unlike a Normal distribution, a Poisson distribution assumes $\mu = \sigma^2$; thus, knowing either $\mu$ or $\sigma^2$ is sufficient to draw a distribution (we use $\mu$ because it's easier) if the Poisson distribution is appropriate to represent the data. When a Poisson distribution is used, the probability distribution differs from that of a Normal distribution. Note that the y-axis is "probability" because the Poisson distribution allows only discrete values.

```{r poisson, fig.cap="Poisson distribution with the mean fish count"}

df_poisson <- tibble(x = 0:10,
                     prob = dpois(x, lambda = mean(df_count$count)),
                     freq = prob * nrow(df_count))

df_poisson %>% 
  ggplot(aes(y = prob,
             x = x)) +
  geom_line(color = grey(0.8)) +
  geom_point(color = grey(0.6),
             size = 4) +
  theme_bw() +
  labs(y = "Probability",
       x = "Fish count")
```

To overlay this "probability" distribution on the "frequency" distribution for comparison, we need to calculate a product of the number of samples (in this case, the number of plots = 10) and the probability of fish count $Y$ taking value $k$, $\text{Pr}(Y=k)$ -- this multiplication results in the "expected" frequency of a value in the data. Figure \@ref(fig:overlay-poisson) shows the comparison -- this seems better than the Normal distribution. Yet, there are some deviations from the expectation (e.g., the frequency of fish count $Y=1$).

```{r overlay-poisson, fig.cap="Comparison of observed and expected frequencies of fish count"}

df_count %>% 
  ggplot(aes(x = count)) +
  geom_histogram(binwidth = 0.1,
                 center = 0) +
  geom_line(data = df_poisson,
             aes(x = x,
                 y = freq),
            color = grey(0.8)) +
  geom_point(data = df_poisson,
             aes(x = x,
                 y = freq),
             color = grey(0.6),
             size = 4) +
  scale_x_continuous(breaks = seq(0, 10, by = 1)) +
  theme_bw() +
  labs(y = "Frequency",
       x = "Fish count")
```

The deviation is due largely to the small sample size -- we have only 10 plots. In theory, we can obtain more accurate parameter estimates as the sample size increases. To see this effect, let's increase the sample size to 100 plots -- Figure \@ref(fig:full-count) shows the updated histogram and the expected distribution with the new mean estimate ($\mu =$ `r mean(df_count_full$count) %>% round(2)`). This greatly improved the matching between the expected and observed distributions.

```{r full-count, fig.cap="Histogram obtained from 100 plots"}

df_poisson_full <- tibble(x = 0:10,
                          prob_full = dpois(x,
                                            lambda = mean(df_count_full$count)),
                          freq_full = prob_full * nrow(df_count_full))

df_count_full %>% 
  ggplot(aes(x = count)) +
  geom_histogram(binwidth = 0.1,
                 center = 0) +
  geom_line(data = df_poisson_full,
            aes(x = x,
                y = freq_full),
            color = grey(0.8)) +
  geom_point(data = df_poisson_full,
             aes(x = x,
                 y = freq_full),
             color = grey(0.6),
             size = 4) +
  scale_x_continuous(breaks = seq(0, 10, by = 1)) +
  theme_bw() +
  labs(y = "Frequency",
       x = "Fish count")
```

### How to choose appropriate one?

We chose a Poisson distribution to express fish counts based on the characteristics of the variable. I used a comparison of a Normal and a Poisson distribution, but there are many more choices when expressing random variables. In ecology, several probability distributions are more frequently used than others, and the following dendrogram describes how we choose an acceptable distribution among them. Answer the questions and find your node.

```{r dendrogram, fig.cap="Brief guide for how to choose an appropriate probability distribution."}

g_dendro
```

Once you find your node[^02-sampling-4]:

[^02-sampling-4]: Although this covers common distributions in ecology, following this dendrogram does not guarantee that your choice is appropriate.

| Node | Possible distribution | Possible values       | Example in ecological data                                                                                                          |
|-------------|-------------|-------------|-----------------------------------|
| 1    | Beta-binomial         | $0$ to $N$            | Number of fertilized eggs out of $N$ eggs examined. Useful when $N$ is large (tend to be over-dispersed with binomial distribution) |
| 2    | Binomial              | $0$ to $N$            | Number of fertilized eggs out of $N$ eggs examined.                                                                                 |
| 3    | Negative-binomial     | $\ge 0$               | Number of individuals captured. Useful when variance is very large relative to mean (over-dispersed with a Poisson distribution).   |
| 4    | Poisson               | $\ge 0$               | Species richness.                                                                                                                   |
| 5    | Beta                  | $0$ to $1$            | Survival probability.                                                                                                               |
| 5    | Log-Normal            | $>0$                  | Biomass.                                                                                                                            |
| 6    | Normal                | $-\infty$ to $\infty$ | Temperature.                                                                                                                        |
